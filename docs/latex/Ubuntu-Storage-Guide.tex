%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjornstrup]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Storage Fundamentals:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}


\usepackage{graphicx}
\usepackage{hyperref}


\title{Storage Systems and Data Management Guide for Ubuntu 22.04}
\date{Jul 14, 2025}
\release{1.0}
\author{Rameshkumar T S}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
Welcome to the comprehensive Storage Systems and Data Management Guide! This documentation covers everything you need to know about storage technologies, disk management, file systems, and data organization on Ubuntu 22.04 LTS.

\sphinxstepscope


\chapter{Storage Overview}
\label{\detokenize{storage-overview:storage-overview}}\label{\detokenize{storage-overview::doc}}

\section{Introduction to Storage Systems}
\label{\detokenize{storage-overview:introduction-to-storage-systems}}
\sphinxAtStartPar
Storage systems are fundamental components of any computing environment. They provide persistent data storage, enabling programs and users to save, retrieve, and manage information efficiently.


\subsection{What is Storage?}
\label{\detokenize{storage-overview:what-is-storage}}
\sphinxAtStartPar
Storage refers to the various technologies and devices used to hold digital data persistently. Unlike volatile memory (RAM), storage retains data even when power is removed from the system.


\subsection{Types of Storage}
\label{\detokenize{storage-overview:types-of-storage}}

\subsubsection{Primary Storage Categories}
\label{\detokenize{storage-overview:primary-storage-categories}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Primary Storage}: Direct access storage (RAM, Cache)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Secondary Storage}: Persistent storage (Hard drives, SSDs)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Tertiary Storage}: Archival storage (Tape drives, Optical storage)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Network Storage}: Remote storage accessed over networks

\end{enumerate}


\subsection{Storage Hierarchy}
\label{\detokenize{storage-overview:storage-hierarchy}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
CPU Registers (fastest, smallest)
↓
Cache Memory (L1, L2, L3)
↓
Main Memory (RAM)
↓
Secondary Storage (SSD, HDD)
↓
Network Storage (NAS, SAN)
↓
Archival Storage (slowest, largest)
\end{sphinxVerbatim}


\subsection{Ubuntu 22.04 Storage Commands}
\label{\detokenize{storage-overview:ubuntu-22-04-storage-commands}}

\subsubsection{Basic Storage Information Commands}
\label{\detokenize{storage-overview:basic-storage-information-commands}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check disk usage}
df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Display detailed disk usage}
du\PYG{+w}{ }\PYGZhy{}sh\PYG{+w}{ }/home/*

\PYG{c+c1}{\PYGZsh{} List block devices}
lsblk

\PYG{c+c1}{\PYGZsh{} Show partition table}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l

\PYG{c+c1}{\PYGZsh{} Display mounted filesystems}
mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZca{}/dev\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Check filesystem usage}
sudo\PYG{+w}{ }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYGZhy{}\PYGZhy{}max\PYGZhy{}depth\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }/
\end{sphinxVerbatim}


\subsubsection{Storage Performance Monitoring}
\label{\detokenize{storage-overview:storage-performance-monitoring}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Monitor I/O statistics}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Watch disk activity}
sudo\PYG{+w}{ }iotop

\PYG{c+c1}{\PYGZsh{} Check disk performance}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}Tt\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Monitor filesystem usage in real\PYGZhy{}time}
watch\PYG{+w}{ }df\PYG{+w}{ }\PYGZhy{}h
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{storage-overview:frequently-asked-questions}}

\subsubsection{Q: What’s the difference between storage and memory?}
\label{\detokenize{storage-overview:q-what-s-the-difference-between-storage-and-memory}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Memory (RAM) is volatile and provides temporary storage for currently running programs. Storage is non\sphinxhyphen{}volatile and provides permanent data storage that persists when the system is powered off.


\subsubsection{Q: How do I check available storage space on Ubuntu 22.04?}
\label{\detokenize{storage-overview:q-how-do-i-check-available-storage-space-on-ubuntu-22-04}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use the following commands:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Human\PYGZhy{}readable format}
df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Show inodes usage}
df\PYG{+w}{ }\PYGZhy{}i

\PYG{c+c1}{\PYGZsh{} Specific filesystem}
df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }/home
\end{sphinxVerbatim}


\subsubsection{Q: What storage types are best for different use cases?}
\label{\detokenize{storage-overview:q-what-storage-types-are-best-for-different-use-cases}}
\sphinxAtStartPar
\sphinxstylestrong{A:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{SSDs}: Best for operating systems, applications, and frequently accessed data

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{HDDs}: Ideal for bulk storage, backups, and archival data

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NVMe SSDs}: Perfect for high\sphinxhyphen{}performance applications and databases

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Network Storage}: Suitable for shared data and centralized management

\end{itemize}


\subsubsection{Q: How can I optimize storage performance on Ubuntu?}
\label{\detokenize{storage-overview:q-how-can-i-optimize-storage-performance-on-ubuntu}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Several optimization techniques:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable TRIM for SSDs}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Optimize filesystem for SSDs}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }/dev/sda1

\PYG{c+c1}{\PYGZsh{} Mount with noatime option (in /etc/fstab)}
\PYG{c+c1}{\PYGZsh{} /dev/sda1 / ext4 defaults,noatime 0 1}

\PYG{c+c1}{\PYGZsh{} Use appropriate I/O scheduler}
\PYG{n+nb}{echo}\PYG{+w}{ }noop\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{storage-overview:coding-examples}}

\subsubsection{Python Storage Monitoring Script}
\label{\detokenize{storage-overview:python-storage-monitoring-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Storage monitoring script for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{shutil}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}disk\PYGZus{}usage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get disk usage information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{usage} \PYG{o}{=} \PYG{n}{shutil}\PYG{o}{.}\PYG{n}{disk\PYGZus{}usage}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{total} \PYG{o}{=} \PYG{n}{usage}\PYG{o}{.}\PYG{n}{total}
    \PYG{n}{used} \PYG{o}{=} \PYG{n}{usage}\PYG{o}{.}\PYG{n}{used}
    \PYG{n}{free} \PYG{o}{=} \PYG{n}{usage}\PYG{o}{.}\PYG{n}{free}

    \PYG{k}{return} \PYG{p}{\PYGZob{}}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{total} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{used\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{used} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{free\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{free} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{usage\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{used} \PYG{o}{/} \PYG{n}{total}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{p}{\PYGZcb{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}mounted\PYGZus{}filesystems}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get list of mounted filesystems\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{filesystems} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{line}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
            \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{:}
                \PYG{n}{filesystems}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]} \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{4} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{unknown}\PYG{l+s+s1}{\PYGZsq{}}
                \PYG{p}{\PYGZcb{}}\PYG{p}{)}

    \PYG{k}{return} \PYG{n}{filesystems}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{monitor\PYGZus{}io}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Monitor I/O statistics\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iostat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                              \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}
    \PYG{k}{except} \PYG{n+ne}{FileNotFoundError}\PYG{p}{:}
        \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{iostat not available. Install with: sudo apt install sysstat}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=== Storage System Monitor ===}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk Usage: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{get\PYGZus{}disk\PYGZus{}usage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Mounted Filesystems: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{get\PYGZus{}mounted\PYGZus{}filesystems}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{I/O Statistics:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{monitor\PYGZus{}io}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Bash Storage Management Script}
\label{\detokenize{storage-overview:bash-storage-management-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} storage\PYGZus{}manager.sh \PYGZhy{} Storage management utility for Ubuntu 22.04}

\PYG{c+c1}{\PYGZsh{} Colors for output}
\PYG{n+nv}{RED}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;31m\PYGZsq{}}
\PYG{n+nv}{GREEN}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;32m\PYGZsq{}}
\PYG{n+nv}{YELLOW}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[1;33m\PYGZsq{}}
\PYG{n+nv}{NC}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0m\PYGZsq{}}\PYG{+w}{ }\PYG{c+c1}{\PYGZsh{} No Color}

\PYG{c+c1}{\PYGZsh{} Function to display disk usage}
show\PYGZus{}disk\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Disk Usage Information ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZca{}/dev\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Function to show largest directories}
show\PYGZus{}large\PYGZus{}dirs\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Largest Directories ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }sudo\PYG{+w}{ }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }/home\PYG{+w}{ }/var\PYG{+w}{ }/usr\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}10
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Function to check storage health}
check\PYGZus{}storage\PYGZus{}health\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Storage Health Check ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check for devices}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Checking }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SMART not available for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Function to clean temporary files}
clean\PYGZus{}temp\PYGZus{}files\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Cleaning Temporary Files ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean apt cache}
\PYG{+w}{    }sudo\PYG{+w}{ }apt\PYG{+w}{ }autoclean
\PYG{+w}{    }sudo\PYG{+w}{ }apt\PYG{+w}{ }autoremove

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean user temp files}
\PYG{+w}{    }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYGZti{}/.cache/thumbnails/*
\PYG{+w}{    }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }/tmp/*

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean system logs (keep last 3 days)}
\PYG{+w}{    }sudo\PYG{+w}{ }journalctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}vacuum\PYGZhy{}time\PYG{o}{=}3d

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Cleanup completed!}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main menu}
\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{menu}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}usage\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }show\PYGZus{}disk\PYGZus{}usage
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}large\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }show\PYGZus{}large\PYGZus{}dirs
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}health\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}storage\PYGZus{}health
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}clean\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }clean\PYGZus{}temp\PYGZus{}files
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}menu\PYGZdq{}}\PYG{p}{|}*\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Storage Manager for Ubuntu 22.04\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [option]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Options:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  usage  \PYGZhy{} Show disk usage\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  large  \PYGZhy{} Show largest directories\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  health \PYGZhy{} Check storage health\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  clean  \PYGZhy{} Clean temporary files\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{k}{esac}
\end{sphinxVerbatim}


\subsection{Best Practices}
\label{\detokenize{storage-overview:best-practices}}

\subsubsection{Storage Planning}
\label{\detokenize{storage-overview:storage-planning}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Capacity Planning}: Always plan for 20\sphinxhyphen{}30\% free space

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance Requirements}: Choose storage type based on IOPS needs

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Redundancy}: Implement appropriate backup and RAID strategies

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring}: Set up alerts for storage usage thresholds

\end{enumerate}


\subsubsection{Ubuntu 22.04 Specific Recommendations}
\label{\detokenize{storage-overview:ubuntu-22-04-specific-recommendations}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install useful storage tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }htop\PYG{+w}{ }iotop\PYG{+w}{ }smartmontools\PYG{+w}{ }sysstat\PYG{+w}{ }tree\PYG{+w}{ }ncdu

\PYG{c+c1}{\PYGZsh{} Set up automatic TRIM for SSDs}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Configure log rotation}
sudo\PYG{+w}{ }vim\PYG{+w}{ }/etc/logrotate.conf

\PYG{c+c1}{\PYGZsh{} Monitor storage usage with cron}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 */6 * * * /usr/bin/df \PYGZhy{}h | mail \PYGZhy{}s \PYGZsq{}Storage Report\PYGZsq{} admin@example.com\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}


\subsubsection{Security Considerations}
\label{\detokenize{storage-overview:security-considerations}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Encryption}: Use LUKS for full disk encryption

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Access Controls}: Implement proper file permissions

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Backup Security}: Encrypt backups and test restoration

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Network Storage}: Use secure protocols (SSH, VPN)

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up LUKS encryption}
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksFormat\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksOpen\PYG{+w}{ }/dev/sdb\PYG{+w}{ }encrypted\PYGZus{}drive

\PYG{c+c1}{\PYGZsh{} Create filesystem on encrypted device}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/mapper/encrypted\PYGZus{}drive

\PYG{c+c1}{\PYGZsh{} Mount encrypted filesystem}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/encrypted
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/mapper/encrypted\PYGZus{}drive\PYG{+w}{ }/mnt/encrypted
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Disk Management}
\label{\detokenize{disk-management:disk-management}}\label{\detokenize{disk-management::doc}}

\section{Understanding Disk Management}
\label{\detokenize{disk-management:understanding-disk-management}}
\sphinxAtStartPar
Disk management involves the organization, partitioning, formatting, and maintenance of storage devices. In Ubuntu 22.04, disk management is crucial for optimal system performance and data organization.


\subsection{Disk Management Fundamentals}
\label{\detokenize{disk-management:disk-management-fundamentals}}

\subsubsection{What is Disk Management?}
\label{\detokenize{disk-management:what-is-disk-management}}
\sphinxAtStartPar
Disk management encompasses:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Partitioning}: Dividing physical disks into logical sections

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Formatting}: Preparing partitions with file systems

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Mounting}: Making partitions accessible to the operating system

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring}: Tracking disk health and performance

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Maintenance}: Optimizing and repairing disk issues

\end{itemize}


\subsection{Disk Types and Interfaces}
\label{\detokenize{disk-management:disk-types-and-interfaces}}

\subsubsection{Physical Disk Types}
\label{\detokenize{disk-management:physical-disk-types}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hard Disk Drives (HDD)}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Mechanical storage with spinning platters

\item {} 
\sphinxAtStartPar
Lower cost per GB

\item {} 
\sphinxAtStartPar
Higher latency, slower access times

\item {} 
\sphinxAtStartPar
Good for bulk storage and archival

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Solid State Drives (SSD)}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Flash memory\sphinxhyphen{}based storage

\item {} 
\sphinxAtStartPar
Faster access times, lower latency

\item {} 
\sphinxAtStartPar
Higher cost per GB

\item {} 
\sphinxAtStartPar
Ideal for operating systems and applications

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{NVMe SSDs}
\begin{itemize}
\item {} 
\sphinxAtStartPar
PCIe\sphinxhyphen{}based interface

\item {} 
\sphinxAtStartPar
Highest performance storage

\item {} 
\sphinxAtStartPar
Direct CPU communication

\item {} 
\sphinxAtStartPar
Best for high\sphinxhyphen{}performance applications

\end{itemize}

\end{enumerate}


\subsubsection{Interface Types}
\label{\detokenize{disk-management:interface-types}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
SATA (Serial ATA)
├── SATA I: 1.5 Gbps
├── SATA II: 3.0 Gbps
└── SATA III: 6.0 Gbps

NVMe (Non\PYGZhy{}Volatile Memory Express)
├── PCIe 3.0: Up to 32 Gbps
└── PCIe 4.0: Up to 64 Gbps
\end{sphinxVerbatim}


\subsection{Ubuntu 22.04 Disk Management Commands}
\label{\detokenize{disk-management:ubuntu-22-04-disk-management-commands}}

\subsubsection{Essential Disk Commands}
\label{\detokenize{disk-management:essential-disk-commands}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} List all block devices}
lsblk

\PYG{c+c1}{\PYGZsh{} Display partition tables}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l

\PYG{c+c1}{\PYGZsh{} Show disk usage by filesystem}
df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Display directory sizes}
du\PYG{+w}{ }\PYGZhy{}sh\PYG{+w}{ }/home/*

\PYG{c+c1}{\PYGZsh{} List mounted filesystems}
mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }column\PYG{+w}{ }\PYGZhy{}t

\PYG{c+c1}{\PYGZsh{} Show disk I/O statistics}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}
\end{sphinxVerbatim}


\subsubsection{Advanced Disk Information}
\label{\detokenize{disk-management:advanced-disk-information}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Detailed disk information}
sudo\PYG{+w}{ }lshw\PYG{+w}{ }\PYGZhy{}class\PYG{+w}{ }disk

\PYG{c+c1}{\PYGZsh{} SMART disk health information}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Disk geometry information}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}g\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Check bad blocks}
sudo\PYG{+w}{ }badblocks\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Display partition UUID}
sudo\PYG{+w}{ }blkid
\end{sphinxVerbatim}


\subsection{Partitioning with fdisk}
\label{\detokenize{disk-management:partitioning-with-fdisk}}

\subsubsection{Creating Partitions}
\label{\detokenize{disk-management:creating-partitions}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Start fdisk for a specific disk}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Within fdisk:}
\PYG{c+c1}{\PYGZsh{} n \PYGZhy{} Create new partition}
\PYG{c+c1}{\PYGZsh{} d \PYGZhy{} Delete partition}
\PYG{c+c1}{\PYGZsh{} p \PYGZhy{} Print partition table}
\PYG{c+c1}{\PYGZsh{} w \PYGZhy{} Write changes and exit}
\PYG{c+c1}{\PYGZsh{} q \PYGZhy{} Quit without saving}

\PYG{c+c1}{\PYGZsh{} Example: Create a new primary partition}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sdb\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} EOF}
\PYG{l+s}{n}
\PYG{l+s}{p}
\PYG{l+s}{1}


\PYG{l+s}{w}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\subsubsection{Partitioning with parted}
\label{\detokenize{disk-management:partitioning-with-parted}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create GPT partition table}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mklabel\PYG{+w}{ }gpt

\PYG{c+c1}{\PYGZsh{} Create partition}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }\PYG{l+m}{0}\PYGZpc{}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} Set partition flags}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }boot\PYG{+w}{ }on

\PYG{c+c1}{\PYGZsh{} Display partition information}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }print
\end{sphinxVerbatim}


\subsection{Filesystem Creation and Management}
\label{\detokenize{disk-management:filesystem-creation-and-management}}

\subsubsection{Creating Filesystems}
\label{\detokenize{disk-management:creating-filesystems}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create ext4 filesystem}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Create XFS filesystem}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Create Btrfs filesystem}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Create FAT32 filesystem}
sudo\PYG{+w}{ }mkfs.fat\PYG{+w}{ }\PYGZhy{}F32\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsubsection{Filesystem Checking and Repair}
\label{\detokenize{disk-management:filesystem-checking-and-repair}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check ext4 filesystem}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Force check even if clean}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Check and repair filesystem}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Check XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}check\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsection{Mounting and Unmounting}
\label{\detokenize{disk-management:mounting-and-unmounting}}

\subsubsection{Manual Mounting}
\label{\detokenize{disk-management:manual-mounting}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create mount point}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/mydisk

\PYG{c+c1}{\PYGZsh{} Mount filesystem}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/mydisk

\PYG{c+c1}{\PYGZsh{} Mount with specific options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }rw,noatime\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/mydisk

\PYG{c+c1}{\PYGZsh{} Unmount filesystem}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/mydisk

\PYG{c+c1}{\PYGZsh{} Force unmount (use carefully)}
sudo\PYG{+w}{ }umount\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/mnt/mydisk
\end{sphinxVerbatim}


\subsubsection{Automatic Mounting with /etc/fstab}
\label{\detokenize{disk-management:automatic-mounting-with-etc-fstab}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Edit fstab file}
sudo\PYG{+w}{ }vim\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} Example fstab entries:}
\PYG{c+c1}{\PYGZsh{} UUID=12345678\PYGZhy{}1234\PYGZhy{}1234\PYGZhy{}1234\PYGZhy{}123456789012 /mnt/mydisk ext4 defaults 0 2}
\PYG{c+c1}{\PYGZsh{} /dev/sdb1 /mnt/backup ext4 rw,noatime 0 2}

\PYG{c+c1}{\PYGZsh{} Get UUID of a partition}
sudo\PYG{+w}{ }blkid\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Test fstab configuration}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}a
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{disk-management:frequently-asked-questions}}

\subsubsection{Q: How do I check disk space usage on Ubuntu 22.04?}
\label{\detokenize{disk-management:q-how-do-i-check-disk-space-usage-on-ubuntu-22-04}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these commands to check disk space:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Overall disk usage}
df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Specific directory usage}
du\PYG{+w}{ }\PYGZhy{}sh\PYG{+w}{ }/home/username

\PYG{c+c1}{\PYGZsh{} Interactive disk usage browser}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }ncdu
ncdu\PYG{+w}{ }/
\end{sphinxVerbatim}


\subsubsection{Q: What’s the difference between fdisk and parted?}
\label{\detokenize{disk-management:q-what-s-the-difference-between-fdisk-and-parted}}
\sphinxAtStartPar
\sphinxstylestrong{A:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{fdisk}: Traditional partitioning tool, best for MBR partitions

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{parted}: Modern tool supporting both MBR and GPT, better for large disks (\textgreater{}2TB)

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} fdisk \PYGZhy{} good for disks \PYGZlt{} 2TB}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} parted \PYGZhy{} better for large disks and GPT}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb
\end{sphinxVerbatim}


\subsubsection{Q: How do I resize a partition without losing data?}
\label{\detokenize{disk-management:q-how-do-i-resize-a-partition-without-losing-data}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these steps carefully:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Backup your data first!}
\PYG{c+c1}{\PYGZsh{} 2. Unmount the partition}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 3. Check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 4. Resize partition with parted}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }resizepart\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} 5. Resize filesystem}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 6. Remount}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/mydisk
\end{sphinxVerbatim}


\subsubsection{Q: How can I securely wipe a disk?}
\label{\detokenize{disk-management:q-how-can-i-securely-wipe-a-disk}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Several methods for secure disk wiping:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Method 1: Using dd (single pass)}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/zero\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/dev/sdb\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{n+nv}{status}\PYG{o}{=}progress

\PYG{c+c1}{\PYGZsh{} Method 2: Using shred (multiple passes)}
sudo\PYG{+w}{ }shred\PYG{+w}{ }\PYGZhy{}vfz\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+m}{3}\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Method 3: Using DBAN (boot from USB)}
\PYG{c+c1}{\PYGZsh{} Download DBAN ISO and create bootable USB}

\PYG{c+c1}{\PYGZsh{} For SSDs, use secure erase}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYGZhy{}master\PYG{+w}{ }u\PYG{+w}{ }\PYGZhy{}\PYGZhy{}security\PYGZhy{}set\PYGZhy{}pass\PYG{+w}{ }p\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYGZhy{}master\PYG{+w}{ }u\PYG{+w}{ }\PYGZhy{}\PYGZhy{}security\PYGZhy{}erase\PYG{+w}{ }p\PYG{+w}{ }/dev/sdb
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{disk-management:coding-examples}}

\subsubsection{Python Disk Management Script}
\label{\detokenize{disk-management:python-disk-management-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Disk management utility for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{DiskManager}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}root\PYGZus{}privileges}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}root\PYGZus{}privileges}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check if running with root privileges\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{if} \PYG{n}{os}\PYG{o}{.}\PYG{n}{geteuid}\PYG{p}{(}\PYG{p}{)} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{This script requires root privileges. Run with sudo.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n}{sys}\PYG{o}{.}\PYG{n}{exit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{list\PYGZus{}disks}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}List all available disks\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lsblk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}J}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{n}{data} \PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{data}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blockdevices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error listing disks: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}disk\PYGZus{}info}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get detailed information about a disk\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Get basic info}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lsblk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}J}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{n}{basic\PYGZus{}info} \PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Get SMART info}
            \PYG{n}{smart\PYGZus{}result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smartctl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}i}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                        \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{basic}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{basic\PYGZus{}info}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smart}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{smart\PYGZus{}result}\PYG{o}{.}\PYG{n}{stdout} \PYG{k}{if} \PYG{n}{smart\PYGZus{}result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{create\PYGZus{}partition}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{100}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Create a new partition\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Create GPT partition table}
            \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{parted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mklabel}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gpt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Create partition}
            \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{parted}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mkpart}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{primary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                          \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ext4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{size}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{return} \PYG{k+kc}{True}
        \PYG{k}{except} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{CalledProcessError} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error creating partition: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{format\PYGZus{}partition}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{n}{filesystem}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ext4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Format a partition with specified filesystem\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{filesystem} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ext4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
                \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mkfs.ext4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{elif} \PYG{n}{filesystem} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{xfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
                \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mkfs.xfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{elif} \PYG{n}{filesystem} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{btrfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
                \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mkfs.btrfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{k}{raise} \PYG{n+ne}{ValueError}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Unsupported filesystem: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{filesystem}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{k}{return} \PYG{k+kc}{True}
        \PYG{k}{except} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{CalledProcessError} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error formatting partition: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{mount\PYGZus{}partition}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{,} \PYG{n}{options}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{defaults}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Mount a partition\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Create mountpoint if it doesn\PYGZsq{}t exist}
            \PYG{n}{os}\PYG{o}{.}\PYG{n}{makedirs}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{,} \PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Mount the partition}
            \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{options}\PYG{p}{,} \PYG{n}{device}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{]}\PYG{p}{,}
                         \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{return} \PYG{k+kc}{True}
        \PYG{k}{except} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{CalledProcessError} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error mounting partition: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}filesystem}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check filesystem integrity\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fsck}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clean}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{errors}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{CalledProcessError} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Example usage}
\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{dm} \PYG{o}{=} \PYG{n}{DiskManager}\PYG{p}{(}\PYG{p}{)}

    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=== Available Disks ===}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{disks} \PYG{o}{=} \PYG{n}{dm}\PYG{o}{.}\PYG{n}{list\PYGZus{}disks}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{disk} \PYG{o+ow}{in} \PYG{n}{disks}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Device: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{disk}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{, Size: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{disk}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{, Type: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{disk}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Interactive disk management}
    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{:}
        \PYG{n}{device} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{info} \PYG{o}{=} \PYG{n}{dm}\PYG{o}{.}\PYG{n}{get\PYGZus{}disk\PYGZus{}info}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{nDisk information for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{info}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Bash Disk Monitoring Script}
\label{\detokenize{disk-management:bash-disk-monitoring-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} disk\PYGZus{}monitor.sh \PYGZhy{} Comprehensive disk monitoring for Ubuntu 22.04}

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{ALERT\PYGZus{}THRESHOLD}\PYG{o}{=}\PYG{l+m}{85}\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Alert when disk usage exceeds this percentage}
\PYG{n+nv}{EMAIL\PYGZus{}ALERT}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}admin@example.com\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/disk\PYGZus{}monitor.log\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Colors}
\PYG{n+nv}{RED}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;31m\PYGZsq{}}
\PYG{n+nv}{GREEN}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;32m\PYGZsq{}}
\PYG{n+nv}{YELLOW}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[1;33m\PYGZsq{}}
\PYG{n+nv}{BLUE}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;34m\PYGZsq{}}
\PYG{n+nv}{NC}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0m\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Logging function}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Check disk usage}
check\PYGZus{}disk\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Disk Usage Check ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}vE\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZca{}Filesystem|tmpfs|cdrom\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5 \PYGZdq{} \PYGZdq{} \PYGZdl{}1 \PYGZdq{} \PYGZdq{} \PYGZdl{}6\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }output\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}output}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}1\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZpc{}//g\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{        }\PYG{n+nv}{partition}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}output}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}2\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{        }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}output}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}usage}\PYG{+w}{ }\PYGZhy{}ge\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}ALERT\PYGZus{}THRESHOLD}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{WARNING: }\PYG{n+nv}{\PYGZdl{}partition}\PYG{l+s+s2}{ (}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{) is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HIGH USAGE: }\PYG{n+nv}{\PYGZdl{}partition}\PYG{l+s+s2}{ (}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{) is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Send email alert if configured}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }mail\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}EMAIL\PYGZus{}ALERT}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk usage alert: }\PYG{n+nv}{\PYGZdl{}partition}\PYG{l+s+s2}{ (}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{) is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{                    }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk Usage Alert \PYGZhy{} }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}EMAIL\PYGZus{}ALERT}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{else}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{OK: }\PYG{n+nv}{\PYGZdl{}partition}\PYG{l+s+s2}{ (}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{) is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Check disk health using SMART}
check\PYGZus{}disk\PYGZus{}health\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Disk Health Check ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }disk\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Checking }\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }smartctl\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nv}{health}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SMART overall\PYGZhy{}health\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}6\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}health}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}PASSED\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{: Health OK}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{else}
\PYG{+w}{                    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{: Health FAILED}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{DISK HEALTH: }\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{ health check failed}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{fi}

\PYG{+w}{                }\PYG{c+c1}{\PYGZsh{} Check temperature}
\PYG{+w}{                }\PYG{n+nv}{temp}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}smartctl\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }Temperature\PYGZus{}Celsius\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}10\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}temp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}temp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{55}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{: Temperature high (}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{temp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{°C)}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                    }\PYG{k}{else}
\PYG{+w}{                        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{: Temperature OK (}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{temp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{°C)}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                    }\PYG{k}{fi}
\PYG{+w}{                }\PYG{k}{fi}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}smartctl not available. Install with: sudo apt install smartmontools\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Monitor I/O performance}
monitor\PYGZus{}io\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== I/O Performance Monitor ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }iostat\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{3}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }+4
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}iostat not available. Install with: sudo apt install sysstat\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Find large files}
find\PYGZus{}large\PYGZus{}files\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Large Files (\PYGZgt{}1GB) ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }find\PYG{+w}{ }/\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+1G\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{        }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5 \PYGZdq{}\PYGZbs{}t\PYGZdq{} \PYGZdl{}9\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}10
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Clean temporary files}
cleanup\PYGZus{}temp\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Cleaning Temporary Files ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get initial disk usage}
\PYG{+w}{    }\PYG{n+nv}{initial\PYGZus{}usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }/\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean apt cache}
\PYG{+w}{    }apt\PYGZhy{}get\PYG{+w}{ }autoclean\PYG{+w}{ }\PYGZhy{}y
\PYG{+w}{    }apt\PYGZhy{}get\PYG{+w}{ }autoremove\PYG{+w}{ }\PYGZhy{}y

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean logs older than 30 days}
\PYG{+w}{    }find\PYG{+w}{ }/var/log\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*.log\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+30\PYG{+w}{ }\PYGZhy{}delete

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean temporary files}
\PYG{+w}{    }find\PYG{+w}{ }/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+7\PYG{+w}{ }\PYGZhy{}delete
\PYG{+w}{    }find\PYG{+w}{ }/var/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+7\PYG{+w}{ }\PYGZhy{}delete

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Clean user caches}
\PYG{+w}{    }find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}.cache\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}/thumbnails/*\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get final disk usage}
\PYG{+w}{    }\PYG{n+nv}{final\PYGZus{}usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }/\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Calculate space freed}
\PYG{+w}{    }\PYG{n+nv}{space\PYGZus{}freed}\PYG{o}{=}\PYG{k}{\PYGZdl{}((}\PYG{n+nv}{initial\PYGZus{}usage}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nv}{final\PYGZus{}usage}\PYG{k}{))}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Cleanup completed. Space freed: }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{space\PYGZus{}freed}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{KB}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{CLEANUP: Freed }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{space\PYGZus{}freed}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{KB of disk space}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Generate disk report}
generate\PYGZus{}report\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nv}{report\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/tmp/disk\PYGZus{}report\PYGZus{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}\PYG{l+s+s2}{.txt}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{o}{\PYGZob{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk Report for }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}==================================================\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Disk Usage:\PYGZdq{}}
\PYG{+w}{        }df\PYG{+w}{ }\PYGZhy{}h
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Largest Directories:\PYGZdq{}}
\PYG{+w}{        }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }/home\PYG{+w}{ }/var\PYG{+w}{ }/usr\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}10
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Mount Points:\PYGZdq{}}
\PYG{+w}{        }mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZca{}/dev\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Block Devices:\PYGZdq{}}
\PYG{+w}{        }lsblk

\PYG{+w}{    }\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Report generated: }\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Email report if configured}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }mail\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}EMAIL\PYGZus{}ALERT}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }cat\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk Report \PYGZhy{} }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}EMAIL\PYGZus{}ALERT}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main menu}
\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{help}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}usage\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}disk\PYGZus{}usage
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}health\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}disk\PYGZus{}health
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}io\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }monitor\PYGZus{}io
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}large\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }find\PYGZus{}large\PYGZus{}files
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}clean\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }cleanup\PYGZus{}temp
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}report\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }generate\PYGZus{}report
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}all\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}disk\PYGZus{}usage
\PYG{+w}{        }check\PYGZus{}disk\PYGZus{}health
\PYG{+w}{        }monitor\PYGZus{}io
\PYG{+w}{        }find\PYGZus{}large\PYGZus{}files
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}help\PYGZdq{}}\PYG{p}{|}*\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Disk Monitor for Ubuntu 22.04\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [option]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Options:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  usage  \PYGZhy{} Check disk usage\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  health \PYGZhy{} Check disk health (SMART)\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  io     \PYGZhy{} Monitor I/O performance\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  large  \PYGZhy{} Find large files\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  clean  \PYGZhy{} Clean temporary files\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  report \PYGZhy{} Generate comprehensive report\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  all    \PYGZhy{} Run all checks\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{k}{esac}
\end{sphinxVerbatim}


\subsection{Best Practices for Disk Management}
\label{\detokenize{disk-management:best-practices-for-disk-management}}

\subsubsection{Planning and Strategy}
\label{\detokenize{disk-management:planning-and-strategy}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Partition Strategy}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Separate /home from root partition

\item {} 
\sphinxAtStartPar
Use dedicated partitions for /var and /tmp

\item {} 
\sphinxAtStartPar
Plan for future expansion

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Filesystem Selection}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
ext4: General purpose, reliable

\item {} 
\sphinxAtStartPar
XFS: Large files and high performance

\item {} 
\sphinxAtStartPar
Btrfs: Advanced features, snapshots

\item {} 
\sphinxAtStartPar
ZFS: Enterprise features, data integrity

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring and Maintenance}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Regular SMART checks

\item {} 
\sphinxAtStartPar
Monitor disk usage trends

\item {} 
\sphinxAtStartPar
Schedule regular filesystem checks

\item {} 
\sphinxAtStartPar
Implement log rotation

\end{itemize}

\end{enumerate}


\subsubsection{Ubuntu 22.04 Optimization Tips}
\label{\detokenize{disk-management:ubuntu-22-04-optimization-tips}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable automatic TRIM for SSDs}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Optimize mount options for performance}
\PYG{c+c1}{\PYGZsh{} Add to /etc/fstab:}
\PYG{c+c1}{\PYGZsh{} /dev/sda1 / ext4 defaults,noatime,discard 0 1}

\PYG{c+c1}{\PYGZsh{} Configure I/O scheduler for SSDs}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Set up monitoring}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }smartmontools\PYG{+w}{ }sysstat
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }smartd

\PYG{c+c1}{\PYGZsh{} Configure SMART monitoring}
sudo\PYG{+w}{ }vim\PYG{+w}{ }/etc/smartd.conf
\PYG{c+c1}{\PYGZsh{} Add: /dev/sda \PYGZhy{}a \PYGZhy{}o on \PYGZhy{}S on \PYGZhy{}s (S/../.././02|L/../../6/03)}
\end{sphinxVerbatim}


\subsubsection{Security and Recovery}
\label{\detokenize{disk-management:security-and-recovery}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Backup Strategy}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Regular automated backups

\item {} 
\sphinxAtStartPar
Test restoration procedures

\item {} 
\sphinxAtStartPar
Offsite backup storage

\item {} 
\sphinxAtStartPar
Document recovery procedures

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Access Control}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Proper file permissions

\item {} 
\sphinxAtStartPar
User and group management

\item {} 
\sphinxAtStartPar
Audit trail logging

\item {} 
\sphinxAtStartPar
Encryption for sensitive data

\end{itemize}

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up automatic backups}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }rsync

\PYG{c+c1}{\PYGZsh{} Create backup script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/backup.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}
\PYG{l+s}{rsync \PYGZhy{}avz \PYGZhy{}\PYGZhy{}delete /home/ /backup/home/}
\PYG{l+s}{rsync \PYGZhy{}avz \PYGZhy{}\PYGZhy{}delete /etc/ /backup/etc/}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/backup.sh

\PYG{c+c1}{\PYGZsh{} Schedule with cron}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 2 * * * /usr/local/bin/backup.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{File Systems}
\label{\detokenize{file-systems:file-systems}}\label{\detokenize{file-systems::doc}}

\section{Understanding File Systems}
\label{\detokenize{file-systems:understanding-file-systems}}
\sphinxAtStartPar
A file system is a method used by operating systems to store, organize, and manage files on storage devices. It defines how data is stored, accessed, and organized on disks.


\subsection{What is a File System?}
\label{\detokenize{file-systems:what-is-a-file-system}}
\sphinxAtStartPar
A file system provides:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{File Organization}: Hierarchical structure for organizing files and directories

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Metadata Management}: Information about files (size, permissions, timestamps)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Space Management}: Allocation and deallocation of disk space

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Access Control}: Security and permission mechanisms

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Integrity}: Protection against data corruption

\end{itemize}


\subsection{File System Components}
\label{\detokenize{file-systems:file-system-components}}

\subsubsection{Core Components}
\label{\detokenize{file-systems:core-components}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Superblock}: Contains metadata about the filesystem

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Inode Table}: Stores file metadata and pointers to data blocks

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Blocks}: Actual file content storage

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Directory Structure}: Hierarchical organization of files and folders

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Journal}: Transaction log for filesystem changes (in journaling filesystems)

\end{enumerate}


\subsubsection{File System Structure}
\label{\detokenize{file-systems:file-system-structure}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Filesystem Layout
├── Superblock (filesystem metadata)
├── Group Descriptors (block group information)
├── Block Bitmap (free/used block tracking)
├── Inode Bitmap (free/used inode tracking)
├── Inode Table (file metadata)
└── Data Blocks (actual file content)
\end{sphinxVerbatim}


\subsection{Common File Systems in Ubuntu 22.04}
\label{\detokenize{file-systems:common-file-systems-in-ubuntu-22-04}}

\subsubsection{ext4 (Fourth Extended Filesystem)}
\label{\detokenize{file-systems:ext4-fourth-extended-filesystem}}
\sphinxAtStartPar
The default filesystem for Ubuntu 22.04:

\sphinxAtStartPar
\sphinxstylestrong{Features:}
* Journaling for data integrity
* Large file and filesystem support (up to 1 EB)
* Backward compatibility with ext2/ext3
* Online defragmentation
* Delayed allocation

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* General purpose computing
* Desktop and server installations
* Boot partitions
* Home directories

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create ext4 filesystem}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Check ext4 filesystem}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Get ext4 filesystem information}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Optimize ext4 filesystem}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }journal\PYGZus{}data\PYGZus{}writeback\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsubsection{XFS (eXtended File System)}
\label{\detokenize{file-systems:xfs-extended-file-system}}
\sphinxAtStartPar
High\sphinxhyphen{}performance 64\sphinxhyphen{}bit journaling filesystem:

\sphinxAtStartPar
\sphinxstylestrong{Features:}
* Excellent scalability
* Online resizing (grow only)
* Advanced quota management
* Allocation groups for parallel I/O
* Metadata journaling

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* Large files and databases
* High\sphinxhyphen{}performance computing
* Video editing and media storage
* Enterprise storage systems

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create XFS filesystem}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Check XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}check\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Repair XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}repair\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Get XFS information}
sudo\PYG{+w}{ }xfs\PYGZus{}info\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Resize XFS filesystem (grow only)}
sudo\PYG{+w}{ }xfs\PYGZus{}growfs\PYG{+w}{ }/mnt/xfs
\end{sphinxVerbatim}


\subsubsection{Btrfs (B\sphinxhyphen{}tree File System)}
\label{\detokenize{file-systems:btrfs-b-tree-file-system}}
\sphinxAtStartPar
Modern copy\sphinxhyphen{}on\sphinxhyphen{}write filesystem:

\sphinxAtStartPar
\sphinxstylestrong{Features:}
* Snapshots and cloning
* Built\sphinxhyphen{}in RAID support
* Compression (zlib, lzo, zstd)
* Checksumming for data integrity
* Online resizing (grow and shrink)

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* System snapshots
* Development environments
* Data deduplication scenarios
* Advanced storage management

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create Btrfs filesystem}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Mount with compression}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{compress}\PYG{o}{=}zstd\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/btrfs

\PYG{c+c1}{\PYGZsh{} Create snapshot}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }snapshot\PYG{+w}{ }/mnt/btrfs\PYG{+w}{ }/mnt/btrfs/snapshot

\PYG{c+c1}{\PYGZsh{} List subvolumes}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }list\PYG{+w}{ }/mnt/btrfs
\end{sphinxVerbatim}


\subsubsection{ZFS (Zettabyte File System)}
\label{\detokenize{file-systems:zfs-zettabyte-file-system}}
\sphinxAtStartPar
Advanced filesystem with built\sphinxhyphen{}in volume management:

\sphinxAtStartPar
\sphinxstylestrong{Features:}
* Built\sphinxhyphen{}in RAID (RAID\sphinxhyphen{}Z)
* Snapshots and clones
* Data deduplication
* Compression
* End\sphinxhyphen{}to\sphinxhyphen{}end checksumming

\sphinxAtStartPar
\sphinxstylestrong{Installation and Use:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install ZFS on Ubuntu 22.04}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }zfsutils\PYGZhy{}linux

\PYG{c+c1}{\PYGZsh{} Create ZFS pool}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }create\PYG{+w}{ }mypool\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Create ZFS dataset}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }create\PYG{+w}{ }mypool/data

\PYG{c+c1}{\PYGZsh{} Enable compression}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{n+nv}{compression}\PYG{o}{=}lz4\PYG{+w}{ }mypool/data

\PYG{c+c1}{\PYGZsh{} Create snapshot}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }snapshot\PYG{+w}{ }mypool/data@snapshot1
\end{sphinxVerbatim}


\subsubsection{FAT32 and NTFS}
\label{\detokenize{file-systems:fat32-and-ntfs}}
\sphinxAtStartPar
\sphinxstylestrong{FAT32}: Universal compatibility, limited file size (4GB max)
\sphinxstylestrong{NTFS}: Windows filesystem with advanced features

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create FAT32 filesystem}
sudo\PYG{+w}{ }mkfs.fat\PYG{+w}{ }\PYGZhy{}F32\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Create NTFS filesystem}
sudo\PYG{+w}{ }mkfs.ntfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Mount NTFS with full permissions}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }ntfs\PYGZhy{}3g\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/ntfs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }permissions
\end{sphinxVerbatim}


\subsection{File System Operations in Ubuntu 22.04}
\label{\detokenize{file-systems:file-system-operations-in-ubuntu-22-04}}

\subsubsection{Creating File Systems}
\label{\detokenize{file-systems:creating-file-systems}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} ext4 with custom options}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MyData\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} XFS with custom block size}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{n+nv}{size}\PYG{o}{=}\PYG{l+m}{4096}\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Btrfs with multiple devices (RAID)}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }raid1\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }raid1\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/dev/sdc1

\PYG{c+c1}{\PYGZsh{} Set filesystem label}
sudo\PYG{+w}{ }e2label\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}DataDisk\PYGZdq{}}
\end{sphinxVerbatim}


\subsubsection{Mounting File Systems}
\label{\detokenize{file-systems:mounting-file-systems}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Basic mounting}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} Mount with specific options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }rw,noatime,discard\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} Mount by UUID (preferred method)}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYG{n+nv}{UUID}\PYG{o}{=}\PYG{l+m}{12345678}\PYGZhy{}1234\PYGZhy{}1234\PYGZhy{}1234\PYGZhy{}123456789abc\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} Mount with user permissions}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{uid}\PYG{o}{=}\PYG{l+m}{1000},gid\PYG{o}{=}\PYG{l+m}{1000}\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data
\end{sphinxVerbatim}


\subsubsection{Checking and Repairing File Systems}
\label{\detokenize{file-systems:checking-and-repairing-file-systems}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check filesystem (read\PYGZhy{}only)}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Automatic repair}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Force check and repair}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Check specific filesystem types}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }/dev/sdb1
sudo\PYG{+w}{ }xfs\PYGZus{}check\PYG{+w}{ }/dev/sdb1
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }check\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsection{File System Monitoring}
\label{\detokenize{file-systems:file-system-monitoring}}

\subsubsection{Monitoring Tools and Commands}
\label{\detokenize{file-systems:monitoring-tools-and-commands}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Real\PYGZhy{}time filesystem usage}
watch\PYG{+w}{ }df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Inode usage}
df\PYG{+w}{ }\PYGZhy{}i

\PYG{c+c1}{\PYGZsh{} Detailed filesystem information}
stat\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/

\PYG{c+c1}{\PYGZsh{} Monitor filesystem I/O}
sudo\PYG{+w}{ }iotop\PYG{+w}{ }\PYGZhy{}o

\PYG{c+c1}{\PYGZsh{} Check filesystem fragmentation (ext4)}
sudo\PYG{+w}{ }e4defrag\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Btrfs filesystem usage}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }filesystem\PYG{+w}{ }usage\PYG{+w}{ }/mnt/btrfs
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{file-systems:frequently-asked-questions}}

\subsubsection{Q: Which filesystem should I choose for Ubuntu 22.04?}
\label{\detokenize{file-systems:q-which-filesystem-should-i-choose-for-ubuntu-22-04}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Filesystem selection depends on your use case:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ext4}: Best general\sphinxhyphen{}purpose choice, default for Ubuntu

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{XFS}: Large files, databases, high\sphinxhyphen{}performance needs

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Btrfs}: Need snapshots, compression, or advanced features

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ZFS}: Enterprise features, data integrity critical

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For most users (recommended)}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} For large files and databases}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} For snapshots and modern features}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsubsection{Q: How do I convert between filesystems?}
\label{\detokenize{file-systems:q-how-do-i-convert-between-filesystems}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Filesystem conversion requires backup and restore:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Backup data}
sudo\PYG{+w}{ }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }/mnt/source/\PYG{+w}{ }/backup/

\PYG{c+c1}{\PYGZsh{} 2. Unmount and recreate filesystem}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/source
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 3. Mount and restore data}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/source
sudo\PYG{+w}{ }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }/backup/\PYG{+w}{ }/mnt/source/
\end{sphinxVerbatim}


\subsubsection{Q: How do I optimize filesystem performance?}
\label{\detokenize{file-systems:q-how-do-i-optimize-filesystem-performance}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Several optimization techniques:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For SSDs \PYGZhy{} enable TRIM}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} Disable access time updates}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }noatime\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} For databases \PYGZhy{} use direct I/O}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{barrier}\PYG{o}{=}\PYG{l+m}{0}\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/database

\PYG{c+c1}{\PYGZsh{} Optimize ext4 for SSDs}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsubsection{Q: How do I recover deleted files?}
\label{\detokenize{file-systems:q-how-do-i-recover-deleted-files}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Recovery methods depend on the filesystem:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install recovery tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }testdisk\PYG{+w}{ }photorec\PYG{+w}{ }extundelete

\PYG{c+c1}{\PYGZsh{} For ext4 filesystems}
sudo\PYG{+w}{ }extundelete\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }\PYGZhy{}\PYGZhy{}restore\PYGZhy{}all

\PYG{c+c1}{\PYGZsh{} General purpose recovery}
sudo\PYG{+w}{ }photorec\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} For immediate action after deletion}
sudo\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYGZhy{}B25\PYG{+w}{ }\PYGZhy{}A25\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}text from deleted file\PYGZsq{}}\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{file-systems:coding-examples}}

\subsubsection{Python Filesystem Analyzer}
\label{\detokenize{file-systems:python-filesystem-analyzer}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Filesystem analyzer for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{pathlib}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{FilesystemAnalyzer}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mountpoints} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}mountpoints}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}mountpoints}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get all mounted filesystems\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{mountpoints} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/proc/mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{f}\PYG{p}{:}
                    \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o+ow}{and} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                        \PYG{n}{mountpoints}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{options}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error reading mount points: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{k}{return} \PYG{n}{mountpoints}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{analyze\PYGZus{}filesystem}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Analyze filesystem usage and characteristics\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Get basic filesystem statistics}
            \PYG{n}{statvfs} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{statvfs}\PYG{p}{(}\PYG{n}{path}\PYG{p}{)}

            \PYG{n}{total\PYGZus{}size} \PYG{o}{=} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}frsize} \PYG{o}{*} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}blocks}
            \PYG{n}{free\PYGZus{}size} \PYG{o}{=} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}frsize} \PYG{o}{*} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}bavail}
            \PYG{n}{used\PYGZus{}size} \PYG{o}{=} \PYG{n}{total\PYGZus{}size} \PYG{o}{\PYGZhy{}} \PYG{n}{free\PYGZus{}size}

            \PYG{c+c1}{\PYGZsh{} Get inode information}
            \PYG{n}{total\PYGZus{}inodes} \PYG{o}{=} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}files}
            \PYG{n}{free\PYGZus{}inodes} \PYG{o}{=} \PYG{n}{statvfs}\PYG{o}{.}\PYG{n}{f\PYGZus{}favail}
            \PYG{n}{used\PYGZus{}inodes} \PYG{o}{=} \PYG{n}{total\PYGZus{}inodes} \PYG{o}{\PYGZhy{}} \PYG{n}{free\PYGZus{}inodes}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{path}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}size\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{total\PYGZus{}size} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{used\PYGZus{}size\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{used\PYGZus{}size} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{free\PYGZus{}size\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{free\PYGZus{}size} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{usage\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{used\PYGZus{}size} \PYG{o}{/} \PYG{n}{total\PYGZus{}size}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}inodes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{total\PYGZus{}inodes}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{used\PYGZus{}inodes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{used\PYGZus{}inodes}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{free\PYGZus{}inodes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{free\PYGZus{}inodes}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inode\PYGZus{}usage\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{n}{used\PYGZus{}inodes} \PYG{o}{/} \PYG{n}{total\PYGZus{}inodes}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{k}{if} \PYG{n}{total\PYGZus{}inodes} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+m+mi}{0}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}largest\PYGZus{}files}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{min\PYGZus{}size\PYGZus{}mb}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{count}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Find largest files in a directory tree\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{large\PYGZus{}files} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n}{min\PYGZus{}size\PYGZus{}bytes} \PYG{o}{=} \PYG{n}{min\PYGZus{}size\PYGZus{}mb} \PYG{o}{*} \PYG{l+m+mi}{1024} \PYG{o}{*} \PYG{l+m+mi}{1024}

        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{root}\PYG{p}{,} \PYG{n}{dirs}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{os}\PYG{o}{.}\PYG{n}{walk}\PYG{p}{(}\PYG{n}{path}\PYG{p}{)}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} Skip certain directories to avoid permission errors}
                \PYG{n}{dirs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{n}{d} \PYG{k}{for} \PYG{n}{d} \PYG{o+ow}{in} \PYG{n}{dirs} \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{d}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o+ow}{and} \PYG{n}{d} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{proc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sys}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dev}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}

                \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{files}\PYG{p}{:}
                    \PYG{k}{try}\PYG{p}{:}
                        \PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{root}\PYG{p}{,} \PYG{n}{file}\PYG{p}{)}
                        \PYG{n}{file\PYGZus{}size} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{getsize}\PYG{p}{(}\PYG{n}{file\PYGZus{}path}\PYG{p}{)}

                        \PYG{k}{if} \PYG{n}{file\PYGZus{}size} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{min\PYGZus{}size\PYGZus{}bytes}\PYG{p}{:}
                            \PYG{n}{large\PYGZus{}files}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{file\PYGZus{}path}\PYG{p}{,}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}mb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{file\PYGZus{}size} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}gb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{file\PYGZus{}size} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
                            \PYG{p}{\PYGZcb{}}\PYG{p}{)}
                    \PYG{k}{except} \PYG{p}{(}\PYG{n+ne}{OSError}\PYG{p}{,} \PYG{n+ne}{IOError}\PYG{p}{)}\PYG{p}{:}
                        \PYG{k}{continue}  \PYG{c+c1}{\PYGZsh{} Skip files we can\PYGZsq{}t access}

            \PYG{c+c1}{\PYGZsh{} Sort by size and return top files}
            \PYG{n}{large\PYGZus{}files}\PYG{o}{.}\PYG{n}{sort}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}mb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{reverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{large\PYGZus{}files}\PYG{p}{[}\PYG{p}{:}\PYG{n}{count}\PYG{p}{]}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}directory\PYGZus{}sizes}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{max\PYGZus{}depth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get sizes of directories\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{directory\PYGZus{}sizes} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{du}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}h}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}max\PYGZhy{}depth=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}depth}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{path}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{:}
                        \PYG{n}{size}\PYG{p}{,} \PYG{n}{dir\PYGZus{}path} \PYG{o}{=} \PYG{n}{parts}
                        \PYG{n}{directory\PYGZus{}sizes}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{dir\PYGZus{}path}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{size}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}

            \PYG{k}{return} \PYG{n}{directory\PYGZus{}sizes}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}filesystem\PYGZus{}health}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check filesystem health using fsck\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Run read\PYGZhy{}only check}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fsck}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clean}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{errors\PYGZus{}found}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{errors}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{monitor\PYGZus{}filesystem\PYGZus{}performance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{duration}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Monitor filesystem I/O performance\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Start iostat monitoring}
            \PYG{n}{process} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{Popen}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iostat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{duration}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
                                     \PYG{n}{stdout}\PYG{o}{=}\PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{PIPE}\PYG{p}{,}
                                     \PYG{n}{stderr}\PYG{o}{=}\PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{PIPE}\PYG{p}{,}
                                     \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{n}{output}\PYG{p}{,} \PYG{n}{error} \PYG{o}{=} \PYG{n}{process}\PYG{o}{.}\PYG{n}{communicate}\PYG{p}{(}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duration}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{duration}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iostat\PYGZus{}output}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{output}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{error} \PYG{k}{if} \PYG{n}{error} \PYG{k}{else} \PYG{k+kc}{None}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{generate\PYGZus{}report}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Generate comprehensive filesystem report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{H:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hostname}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{os}\PYG{o}{.}\PYG{n}{uname}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{nodename}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoints}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mountpoints}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem\PYGZus{}analysis}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{large\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{directory\PYGZus{}sizes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}
        \PYG{p}{\PYGZcb{}}

        \PYG{c+c1}{\PYGZsh{} Analyze each mounted filesystem}
        \PYG{k}{for} \PYG{n}{mount} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mountpoints}\PYG{p}{:}
            \PYG{n}{analysis} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{analyze\PYGZus{}filesystem}\PYG{p}{(}\PYG{n}{mount}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
            \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mount}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{mount}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{filesystem\PYGZus{}analysis}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{analysis}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Find large files in home and var directories}
        \PYG{k}{for} \PYG{n}{path} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/var}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{n}{path}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{large\PYGZus{}files} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}largest\PYGZus{}files}\PYG{p}{(}\PYG{n}{path}\PYG{p}{,} \PYG{n}{min\PYGZus{}size\PYGZus{}mb}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{n}{count}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}
                \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{large\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{extend}\PYG{p}{(}\PYG{n}{large\PYGZus{}files}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Get directory sizes for common directories}
        \PYG{k}{for} \PYG{n}{path} \PYG{o+ow}{in} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/var}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/usr}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{n}{path}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{dir\PYGZus{}sizes} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}directory\PYGZus{}sizes}\PYG{p}{(}\PYG{n}{path}\PYG{p}{,} \PYG{n}{max\PYGZus{}depth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
                \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{directory\PYGZus{}sizes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{extend}\PYG{p}{(}\PYG{n}{dir\PYGZus{}sizes}\PYG{p}{)}

        \PYG{k}{return} \PYG{n}{report}

\PYG{c+c1}{\PYGZsh{} Example usage}
\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{analyzer} \PYG{o}{=} \PYG{n}{FilesystemAnalyzer}\PYG{p}{(}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Generate and display report}
    \PYG{n}{report} \PYG{o}{=} \PYG{n}{analyzer}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Save report to file}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/tmp/filesystem\PYGZus{}report\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
        \PYG{n}{json}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{f}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Bash Filesystem Management Script}
\label{\detokenize{file-systems:bash-filesystem-management-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} filesystem\PYGZus{}manager.sh \PYGZhy{} Comprehensive filesystem management for Ubuntu 22.04}

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/backup\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/filesystem\PYGZus{}manager.log\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Colors}
\PYG{n+nv}{RED}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;31m\PYGZsq{}}
\PYG{n+nv}{GREEN}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;32m\PYGZsq{}}
\PYG{n+nv}{YELLOW}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[1;33m\PYGZsq{}}
\PYG{n+nv}{BLUE}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;34m\PYGZsq{}}
\PYG{n+nv}{NC}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0m\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Logging function}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Check if running as root}
check\PYGZus{}root\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}EUID}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{This script must be run as root}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Display filesystem information}
show\PYGZus{}filesystem\PYGZus{}info\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Filesystem Information ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Mounted Filesystems:\PYGZdq{}}
\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}hT\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }tmpfs
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Filesystem Types:\PYGZdq{}}
\PYG{+w}{    }lsblk\PYG{+w}{ }\PYGZhy{}f
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Mount Points:\PYGZdq{}}
\PYG{+w}{    }mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZca{}/dev\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }column\PYG{+w}{ }\PYGZhy{}t
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Create filesystem with optimal settings}
create\PYGZus{}filesystem\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: create\PYGZus{}filesystem \PYGZlt{}device\PYGZgt{} \PYGZlt{}filesystem\PYGZus{}type\PYGZgt{} [label]\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Supported types: ext4, xfs, btrfs\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Creating }\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{ filesystem on }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}ext4\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }mkfs.ext4\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }mkfs.ext4\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Optimize for SSD if detected}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}cat\PYG{+w}{ }/sys/block/\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/[0\PYGZhy{}9]*\PYGZdl{}//\PYGZsq{}}\PYG{k}{)}/queue/rotational\PYG{k}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SSD optimizations applied\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}xfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }mkfs.xfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }mkfs.xfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}btrfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }mkfs.btrfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}label}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }mkfs.btrfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Unsupported filesystem type: }\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Created }\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{ filesystem on }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Filesystem created successfully}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Mount filesystem with optimal options}
mount\PYGZus{}filesystem\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: mount\PYGZus{}filesystem \PYGZlt{}device\PYGZgt{} \PYGZlt{}mountpoint\PYGZgt{} [filesystem\PYGZus{}type]\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create mountpoint if it doesn\PYGZsq{}t exist}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Detect filesystem type if not provided}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}blkid\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }value\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }TYPE\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Set optimal mount options based on filesystem type}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}ext4\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nv}{mount\PYGZus{}options}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}defaults,noatime\PYGZdq{}}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Add discard for SSDs}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}cat\PYG{+w}{ }/sys/block/\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/[0\PYGZhy{}9]*\PYGZdl{}//\PYGZsq{}}\PYG{k}{)}/queue/rotational\PYG{k}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nv}{mount\PYGZus{}options}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}options}\PYG{l+s+s2}{,discard}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}xfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nv}{mount\PYGZus{}options}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}defaults,noatime\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}btrfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nv}{mount\PYGZus{}options}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}defaults,noatime,compress=zstd\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nv}{mount\PYGZus{}options}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}defaults\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Mounting }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ at }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ with options: }\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}options}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}options}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Mounted }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ at }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Filesystem mounted successfully}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Add to fstab for permanent mounting}
\PYG{+w}{        }\PYG{n+nv}{uuid}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}blkid\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }value\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }UUID\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}uuid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UUID=}\PYG{n+nv}{\PYGZdl{}uuid}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}options}\PYG{l+s+s2}{ 0 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/fstab
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Added to /etc/fstab for automatic mounting\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to mount filesystem}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Check filesystem health}
check\PYGZus{}filesystem\PYGZus{}health\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: check\PYGZus{}filesystem\PYGZus{}health \PYGZlt{}device\PYGZgt{}\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Checking filesystem health for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get filesystem type}
\PYG{+w}{    }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}blkid\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }value\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }TYPE\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}ext4\PYGZdq{}}\PYG{p}{|}\PYG{l+s+s2}{\PYGZdq{}ext3\PYGZdq{}}\PYG{p}{|}\PYG{l+s+s2}{\PYGZdq{}ext2\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Running fsck for ext filesystem...\PYGZdq{}}
\PYG{+w}{            }fsck.ext4\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}xfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Running xfs\PYGZus{}check...\PYGZdq{}}
\PYG{+w}{            }xfs\PYGZus{}check\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}btrfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Running btrfs check...\PYGZdq{}}
\PYG{+w}{            }btrfs\PYG{+w}{ }check\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Running generic fsck...\PYGZdq{}}
\PYG{+w}{            }fsck\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Filesystem health check completed for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Optimize filesystem performance}
optimize\PYGZus{}filesystem\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: optimize\PYGZus{}filesystem \PYGZlt{}mountpoint\PYGZgt{}\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Optimizing filesystem at }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get device and filesystem type}
\PYG{+w}{    }\PYG{n+nv}{device}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}1\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }\PYGZhy{}T\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}2\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}ext4\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Optimizing ext4 filesystem...\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Defragment if needed}
\PYG{+w}{            }e4defrag\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Optimize inode allocation}
\PYG{+w}{            }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }journal\PYGZus{}data\PYGZus{}writeback\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Enable TRIM for SSDs}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}cat\PYG{+w}{ }/sys/block/\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/[0\PYGZhy{}9]*\PYGZdl{}//\PYGZsq{}}\PYG{k}{)}/queue/rotational\PYG{k}{)}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SSD optimizations applied\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}xfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Optimizing XFS filesystem...\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} XFS is generally well\PYGZhy{}optimized by default}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Check if online defragmentation is needed}
\PYG{+w}{            }xfs\PYGZus{}fsr\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}btrfs\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Optimizing Btrfs filesystem...\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Balance filesystem}
\PYG{+w}{            }btrfs\PYG{+w}{ }balance\PYG{+w}{ }start\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Defragment}
\PYG{+w}{            }btrfs\PYG{+w}{ }filesystem\PYG{+w}{ }defragment\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Filesystem optimization completed for }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Optimization completed}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Backup filesystem}
backup\PYGZus{}filesystem\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{source}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: backup\PYGZus{}filesystem \PYGZlt{}source\PYGZus{}mountpoint\PYGZgt{} [backup\PYGZus{}name]\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nv}{backup\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{filesystem\PYGZus{}backup\PYGZus{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nv}{backup\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Creating backup of }\PYG{n+nv}{\PYGZdl{}source}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}path}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create backup directory}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Use rsync for efficient backup}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }rsync\PYG{+w}{ }\PYGZhy{}avH\PYG{+w}{ }\PYGZhy{}\PYGZhy{}progress\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}path}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup created: }\PYG{n+nv}{\PYGZdl{}source}\PYG{l+s+s2}{ \PYGZhy{}\PYGZgt{} }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Backup completed successfully}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Create metadata file}
\PYG{+w}{        }cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}path}\PYG{l+s+s2}{/.backup\PYGZus{}info}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} EOF}
\PYG{l+s}{Source: \PYGZdl{}source}
\PYG{l+s}{Backup Date: \PYGZdl{}(date)}
\PYG{l+s}{Backup Size: \PYGZdl{}(du \PYGZhy{}sh \PYGZdq{}\PYGZdl{}backup\PYGZus{}path\PYGZdq{} | cut \PYGZhy{}f1)}
\PYG{l+s}{EOF}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Backup failed}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Monitor filesystem usage}
monitor\PYGZus{}filesystem\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Filesystem Usage Monitor ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{while}\PYG{+w}{ }true\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }clear
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Filesystem Usage (updated every 5 seconds) \PYGZhy{} Press Ctrl+C to exit\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}================================================================\PYGZdq{}}

\PYG{+w}{        }df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZca{}Filesystem|\PYGZca{}/dev\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}I/O Statistics:\PYGZdq{}}
\PYG{+w}{        }iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }+4
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Top 5 largest directories in /:\PYGZdq{}}
\PYG{+w}{        }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYGZhy{}\PYGZhy{}max\PYGZhy{}depth\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }/\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}5

\PYG{+w}{        }sleep\PYG{+w}{ }\PYG{l+m}{5}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main menu}
\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{help}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}info\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }show\PYGZus{}filesystem\PYGZus{}info
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}create\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }create\PYGZus{}filesystem\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}4}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}mount\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }mount\PYGZus{}filesystem\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}4}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}check\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }check\PYGZus{}filesystem\PYGZus{}health\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}optimize\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }optimize\PYGZus{}filesystem\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}backup\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }backup\PYGZus{}filesystem\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}monitor\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }monitor\PYGZus{}filesystem
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}help\PYGZdq{}}\PYG{p}{|}*\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Filesystem Manager for Ubuntu 22.04\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [command] [options]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Commands:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  info                          \PYGZhy{} Show filesystem information\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  create \PYGZlt{}device\PYGZgt{} \PYGZlt{}type\PYGZgt{} [label] \PYGZhy{} Create filesystem\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  mount \PYGZlt{}device\PYGZgt{} \PYGZlt{}mountpoint\PYGZgt{}   \PYGZhy{} Mount filesystem with optimal options\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  check \PYGZlt{}device\PYGZgt{}                \PYGZhy{} Check filesystem health\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  optimize \PYGZlt{}mountpoint\PYGZgt{}         \PYGZhy{} Optimize filesystem performance\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  backup \PYGZlt{}source\PYGZgt{} [name]        \PYGZhy{} Backup filesystem\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  monitor                       \PYGZhy{} Monitor filesystem usage\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Supported filesystem types: ext4, xfs, btrfs\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Examples:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ create /dev/sdb1 ext4 MyData}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ mount /dev/sdb1 /mnt/data}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ check /dev/sdb1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ optimize /home}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ backup /home home\PYGZus{}backup}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{k}{esac}
\end{sphinxVerbatim}


\subsection{Best Practices for File Systems}
\label{\detokenize{file-systems:best-practices-for-file-systems}}

\subsubsection{Choosing the Right Filesystem}
\label{\detokenize{file-systems:choosing-the-right-filesystem}}
\sphinxAtStartPar
\sphinxstylestrong{Decision Matrix:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Use Case                    | Recommended Filesystem
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
General desktop/server      | ext4
Large files/databases       | XFS
Snapshots/modern features   | Btrfs
Maximum data integrity      | ZFS
Cross\PYGZhy{}platform compatibility| FAT32/NTFS
High\PYGZhy{}performance computing  | XFS or ext4
\end{sphinxVerbatim}


\subsubsection{Performance Optimization}
\label{\detokenize{file-systems:performance-optimization}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Mount Options}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For general use}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }defaults,noatime\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} For SSDs}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }defaults,noatime,discard\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/data

\PYG{c+c1}{\PYGZsh{} For databases}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }defaults,noatime,barrier\PYG{o}{=}\PYG{l+m}{0}\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/database
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{I/O Scheduler}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For SSDs}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} For HDDs}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/sys/block/sda/queue/scheduler
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Filesystem Tuning}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Optimize ext4 for SSDs}
tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }/dev/sda1

\PYG{c+c1}{\PYGZsh{} Reduce reserved space (ext4)}
tune2fs\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }/dev/sda1
\end{sphinxVerbatim}

\end{enumerate}


\subsubsection{Security and Maintenance}
\label{\detokenize{file-systems:security-and-maintenance}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Regular Checks}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Schedule regular filesystem checks}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 3 * * 0 /sbin/fsck \PYGZhy{}A \PYGZhy{}f\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/crontab
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Backup Strategy}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Automated backups}
rsync\PYG{+w}{ }\PYGZhy{}avH\PYG{+w}{ }/home/\PYG{+w}{ }/backup/home/

\PYG{c+c1}{\PYGZsh{} Filesystem snapshots (Btrfs)}
btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }snapshot\PYG{+w}{ }/home\PYG{+w}{ }/home/.snapshots/\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up disk usage alerts}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}df \PYGZhy{}h | awk \PYGZsq{}NR\PYGZgt{}1 \PYGZob{}if(\PYGZbs{}\PYGZdl{}5+0 \PYGZgt{} 85) print \PYGZbs{}\PYGZdl{}0\PYGZcb{}\PYGZsq{} | mail \PYGZhy{}s \PYGZsq{}Disk Alert\PYGZsq{} admin@example.com\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}

\end{enumerate}

\sphinxstepscope


\chapter{Data Organization}
\label{\detokenize{data-organization:data-organization}}\label{\detokenize{data-organization::doc}}

\section{Understanding Data Organization}
\label{\detokenize{data-organization:understanding-data-organization}}
\sphinxAtStartPar
Data organization refers to the systematic arrangement and structuring of data to optimize storage efficiency, access speed, and management ease. Proper data organization is crucial for system performance and data integrity.


\subsection{Data Organization Fundamentals}
\label{\detokenize{data-organization:data-organization-fundamentals}}

\subsubsection{What is Data Organization?}
\label{\detokenize{data-organization:what-is-data-organization}}
\sphinxAtStartPar
Data organization encompasses:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Structure}: How data is arranged and stored

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Classification}: Categorizing data by type, importance, and access patterns

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Hierarchy}: Organizing data in logical levels and relationships

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Access Patterns}: Understanding how data is accessed and used

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Lifecycle}: Managing data from creation to deletion

\end{itemize}


\subsection{Data Classification Types}
\label{\detokenize{data-organization:data-classification-types}}

\subsubsection{By Access Frequency}
\label{\detokenize{data-organization:by-access-frequency}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hot Data}: Frequently accessed, requires fast storage (SSD)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Warm Data}: Occasionally accessed, standard performance storage

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Cold Data}: Rarely accessed, slower but cost\sphinxhyphen{}effective storage

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Archival Data}: Long\sphinxhyphen{}term retention, very infrequent access

\end{enumerate}


\subsubsection{By Data Type}
\label{\detokenize{data-organization:by-data-type}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Structured Data}: Databases, spreadsheets, organized formats

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Semi\sphinxhyphen{}structured Data}: JSON, XML, log files

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Unstructured Data}: Documents, images, videos, emails

\end{enumerate}


\subsubsection{By Criticality}
\label{\detokenize{data-organization:by-criticality}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Critical Data}: Business\sphinxhyphen{}essential, requires high availability

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Important Data}: Significant but not critical

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Standard Data}: Regular business data

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Temporary Data}: Short\sphinxhyphen{}term, disposable data

\end{enumerate}


\subsection{Ubuntu 22.04 Data Organization Tools}
\label{\detokenize{data-organization:ubuntu-22-04-data-organization-tools}}

\subsubsection{Directory Structure Best Practices}
\label{\detokenize{data-organization:directory-structure-best-practices}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Standard Ubuntu directory structure}
/
├──\PYG{+w}{ }home/\PYG{+w}{           }\PYG{c+c1}{\PYGZsh{} User data}
├──\PYG{+w}{ }var/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Variable data (logs, databases)}
├──\PYG{+w}{ }usr/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} User programs and libraries}
├──\PYG{+w}{ }opt/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Optional software packages}
├──\PYG{+w}{ }srv/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Service data}
├──\PYG{+w}{ }tmp/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Temporary files}
└──\PYG{+w}{ }mnt/\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Mount points for external storage}

\PYG{c+c1}{\PYGZsh{} Recommended user data organization}
/home/username/
├──\PYG{+w}{ }Documents/\PYG{+w}{      }\PYG{c+c1}{\PYGZsh{} Personal documents}
├──\PYG{+w}{ }Projects/\PYG{+w}{       }\PYG{c+c1}{\PYGZsh{} Development projects}
├──\PYG{+w}{ }Media/\PYG{+w}{          }\PYG{c+c1}{\PYGZsh{} Photos, videos, music}
├──\PYG{+w}{ }Archive/\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Old/archived files}
├──\PYG{+w}{ }Backup/\PYG{+w}{         }\PYG{c+c1}{\PYGZsh{} Local backups}
└──\PYG{+w}{ }Work/\PYG{+w}{           }\PYG{c+c1}{\PYGZsh{} Work\PYGZhy{}related files}
\end{sphinxVerbatim}


\subsubsection{File Organization Commands}
\label{\detokenize{data-organization:file-organization-commands}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create organized directory structure}
mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYGZti{}/Documents/\PYG{o}{\PYGZob{}}Personal,Work\PYG{o}{\PYGZcb{}}/\PYG{o}{\PYGZob{}}\PYG{l+m}{2024},2023,Archive\PYG{o}{\PYGZcb{}}
mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYGZti{}/Projects/\PYG{o}{\PYGZob{}}Active,Completed,Archive\PYG{o}{\PYGZcb{}}
mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYGZti{}/Media/\PYG{o}{\PYGZob{}}Photos,Videos,Music\PYG{o}{\PYGZcb{}}/\PYG{o}{\PYGZob{}}\PYG{l+m}{2024},2023,Archive\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} File organization by date}
find\PYG{+w}{ }\PYGZti{}/Downloads\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}newermt\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}2024\PYGZhy{}01\PYGZhy{}01\PYGZdq{}}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}newermt\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}2024\PYGZhy{}12\PYGZhy{}31\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}exec\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYGZti{}/Archive/2024/\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }mv\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZti{}/Archive/2024/\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}

\PYG{c+c1}{\PYGZsh{} Organize files by extension}
\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZti{}/Downloads
\PYG{k}{for}\PYG{+w}{ }ext\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }pdf\PYG{+w}{ }doc\PYG{+w}{ }docx\PYG{+w}{ }txt\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYGZti{}/Documents/\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}ext}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tr\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:lower:]\PYGZsq{}}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:upper:]\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{    }find\PYG{+w}{ }.\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{*.}\PYG{n+nv}{\PYGZdl{}ext}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }mv\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZti{}/Documents/\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}ext}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tr\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:lower:]\PYGZsq{}}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:upper:]\PYGZsq{}}\PYG{k}{)}/\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}
\PYG{k}{done}

\PYG{c+c1}{\PYGZsh{} Find and organize duplicate files}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYGZhy{}d
\end{sphinxVerbatim}


\subsection{Data Backup and Archival}
\label{\detokenize{data-organization:data-backup-and-archival}}

\subsubsection{Backup Strategies}
\label{\detokenize{data-organization:backup-strategies}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 3\PYGZhy{}2\PYGZhy{}1 Backup Rule Implementation}
\PYG{c+c1}{\PYGZsh{} 3 copies, 2 different media types, 1 offsite}

\PYG{c+c1}{\PYGZsh{} Local backup (rsync)}
rsync\PYG{+w}{ }\PYGZhy{}avH\PYG{+w}{ }\PYGZhy{}\PYGZhy{}delete\PYG{+w}{ }\PYGZti{}/Documents/\PYG{+w}{ }/backup/documents/

\PYG{c+c1}{\PYGZsh{} External drive backup}
rsync\PYG{+w}{ }\PYGZhy{}avH\PYG{+w}{ }\PYGZhy{}\PYGZhy{}delete\PYG{+w}{ }\PYGZti{}/Documents/\PYG{+w}{ }/media/external/backup/documents/

\PYG{c+c1}{\PYGZsh{} Cloud backup (rclone)}
rclone\PYG{+w}{ }sync\PYG{+w}{ }\PYGZti{}/Documents/\PYG{+w}{ }cloud:backup/documents/

\PYG{c+c1}{\PYGZsh{} Compressed archive backup}
tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }/backup/documents\PYGZus{}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}.tar.gz\PYG{+w}{ }\PYGZti{}/Documents/
\end{sphinxVerbatim}


\subsubsection{Automated Data Organization}
\label{\detokenize{data-organization:automated-data-organization}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create organization script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/bin/organize\PYGZus{}data.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{\PYGZsh{} Organize downloads by file type}
\PYG{l+s}{organize\PYGZus{}downloads() \PYGZob{}}
\PYG{l+s}{    cd \PYGZti{}/Downloads}

\PYG{l+s}{    \PYGZsh{} Create directories}
\PYG{l+s}{    mkdir \PYGZhy{}p \PYGZob{}Documents,Images,Videos,Music,Archives,Software\PYGZcb{}}

\PYG{l+s}{    \PYGZsh{} Move files by type}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.pdf\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.doc\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.docx\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.txt\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Documents/ \PYGZbs{};}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.jpg\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.png\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.gif\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.jpeg\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Images/ \PYGZbs{};}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.mp4\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.avi\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.mkv\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Videos/ \PYGZbs{};}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.mp3\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.flac\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.wav\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Music/ \PYGZbs{};}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.zip\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.tar.gz\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.rar\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Archives/ \PYGZbs{};}
\PYG{l+s}{    find . \PYGZhy{}maxdepth 1 \PYGZhy{}type f \PYGZbs{}( \PYGZhy{}iname \PYGZdq{}*.deb\PYGZdq{} \PYGZhy{}o \PYGZhy{}iname \PYGZdq{}*.appimage\PYGZdq{} \PYGZbs{}) \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} Software/ \PYGZbs{};}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Clean old temporary files}
\PYG{l+s}{clean\PYGZus{}temp() \PYGZob{}}
\PYG{l+s}{    find \PYGZti{}/Downloads \PYGZhy{}type f \PYGZhy{}mtime +30 \PYGZhy{}delete}
\PYG{l+s}{    find \PYGZti{}/.cache \PYGZhy{}type f \PYGZhy{}mtime +7 \PYGZhy{}delete}
\PYG{l+s}{    find /tmp \PYGZhy{}user \PYGZdl{}USER \PYGZhy{}type f \PYGZhy{}mtime +1 \PYGZhy{}delete 2\PYGZgt{}/dev/null}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Archive old files}
\PYG{l+s}{archive\PYGZus{}old() \PYGZob{}}
\PYG{l+s}{    find \PYGZti{}/Documents \PYGZhy{}type f \PYGZhy{}mtime +365 \PYGZhy{}exec mkdir \PYGZhy{}p \PYGZti{}/Archive/\PYGZdl{}(date +\PYGZpc{}Y) \PYGZbs{}; \PYGZhy{}exec mv \PYGZob{}\PYGZcb{} \PYGZti{}/Archive/\PYGZdl{}(date +\PYGZpc{}Y)/ \PYGZbs{};}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Execute functions}
\PYG{l+s}{organize\PYGZus{}downloads}
\PYG{l+s}{clean\PYGZus{}temp}
\PYG{l+s}{archive\PYGZus{}old}

\PYG{l+s}{echo \PYGZdq{}Data organization completed: \PYGZdl{}(date)\PYGZdq{}}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }\PYGZti{}/bin/organize\PYGZus{}data.sh

\PYG{c+c1}{\PYGZsh{} Schedule with cron}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 2 * * * \PYGZti{}/bin/organize\PYGZus{}data.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}


\subsection{Data Compression and Deduplication}
\label{\detokenize{data-organization:data-compression-and-deduplication}}

\subsubsection{File Compression Techniques}
\label{\detokenize{data-organization:file-compression-techniques}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install compression tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }p7zip\PYGZhy{}full\PYG{+w}{ }rar\PYG{+w}{ }unrar\PYG{+w}{ }gzip\PYG{+w}{ }bzip2\PYG{+w}{ }xz\PYGZhy{}utils

\PYG{c+c1}{\PYGZsh{} Create compressed archives}
\PYG{c+c1}{\PYGZsh{} gzip (fast, good compression)}
tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }archive.tar.gz\PYG{+w}{ }/path/to/data

\PYG{c+c1}{\PYGZsh{} bzip2 (better compression, slower)}
tar\PYG{+w}{ }\PYGZhy{}cjf\PYG{+w}{ }archive.tar.bz2\PYG{+w}{ }/path/to/data

\PYG{c+c1}{\PYGZsh{} xz (best compression, slowest)}
tar\PYG{+w}{ }\PYGZhy{}cJf\PYG{+w}{ }archive.tar.xz\PYG{+w}{ }/path/to/data

\PYG{c+c1}{\PYGZsh{} 7zip (excellent compression)}
7z\PYG{+w}{ }a\PYG{+w}{ }\PYGZhy{}t7z\PYG{+w}{ }\PYGZhy{}mx\PYG{o}{=}\PYG{l+m}{9}\PYG{+w}{ }archive.7z\PYG{+w}{ }/path/to/data

\PYG{c+c1}{\PYGZsh{} Compare compression ratios}
\PYG{k}{for}\PYG{+w}{ }method\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }gz\PYG{+w}{ }bz2\PYG{+w}{ }xz\PYG{+w}{ }7z\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Compressing with }\PYG{n+nv}{\PYGZdl{}method}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}method}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }gz\PYG{o}{)}\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }test.tar.gz\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }bz2\PYG{o}{)}\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}cjf\PYG{+w}{ }test.tar.bz2\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }xz\PYG{o}{)}\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}cJf\PYG{+w}{ }test.tar.xz\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }7z\PYG{o}{)}\PYG{+w}{ }7z\PYG{+w}{ }a\PYG{+w}{ }test.7z\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}method}\PYG{l+s+s2}{: }\PYG{k}{\PYGZdl{}(}ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }test.*\PYG{n+nv}{\PYGZdl{}method}*\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{done}
\end{sphinxVerbatim}


\subsubsection{Duplicate File Management}
\label{\detokenize{data-organization:duplicate-file-management}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install deduplication tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }fdupes\PYG{+w}{ }rdfind

\PYG{c+c1}{\PYGZsh{} Find duplicates with fdupes}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZti{}/Documents

\PYG{c+c1}{\PYGZsh{} Find and delete duplicates interactively}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZti{}/Documents

\PYG{c+c1}{\PYGZsh{} Find duplicates with rdfind}
rdfind\PYG{+w}{ }\PYGZti{}/Documents

\PYG{c+c1}{\PYGZsh{} Advanced duplicate handling with rdfind}
rdfind\PYG{+w}{ }\PYGZhy{}makehardlinks\PYG{+w}{ }\PYG{n+nb}{true}\PYG{+w}{ }\PYGZti{}/Documents
rdfind\PYG{+w}{ }\PYGZhy{}makeresultsfile\PYG{+w}{ }\PYG{n+nb}{false}\PYG{+w}{ }\PYGZhy{}makehardlinks\PYG{+w}{ }\PYG{n+nb}{true}\PYG{+w}{ }\PYGZti{}/Documents
\end{sphinxVerbatim}


\subsection{Data Monitoring and Analysis}
\label{\detokenize{data-organization:data-monitoring-and-analysis}}

\subsubsection{Storage Usage Analysis}
\label{\detokenize{data-organization:storage-usage-analysis}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Analyze disk usage by directory}
ncdu\PYG{+w}{ }/home

\PYG{c+c1}{\PYGZsh{} Find largest files}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }+\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}rh\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}20

\PYG{c+c1}{\PYGZsh{} Analyze file types and sizes}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/.*\PYGZbs{}\PYGZbs{}.//\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }uniq\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}rn

\PYG{c+c1}{\PYGZsh{} Monitor storage usage trends}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/bin/storage\PYGZus{}trend.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{LOGFILE=\PYGZdq{}/var/log/storage\PYGZus{}usage.log\PYGZdq{}}

\PYG{l+s}{echo \PYGZdq{}\PYGZdl{}(date): \PYGZdl{}(df \PYGZhy{}h / | tail \PYGZhy{}1 | awk \PYGZsq{}\PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{})\PYGZdq{} \PYGZgt{}\PYGZgt{} \PYGZdl{}LOGFILE}

\PYG{l+s}{\PYGZsh{} Generate weekly report}
\PYG{l+s}{if [ \PYGZdq{}\PYGZdl{}(date +\PYGZpc{}u)\PYGZdq{} \PYGZhy{}eq 1 ]; then}
\PYG{l+s}{    echo \PYGZdq{}Weekly Storage Report \PYGZhy{} \PYGZdl{}(date)\PYGZdq{} \PYGZgt{} /tmp/storage\PYGZus{}report.txt}
\PYG{l+s}{    tail \PYGZhy{}7 \PYGZdl{}LOGFILE \PYGZgt{}\PYGZgt{} /tmp/storage\PYGZus{}report.txt}
\PYG{l+s}{    mail \PYGZhy{}s \PYGZdq{}Storage Usage Report\PYGZdq{} admin@example.com \PYGZlt{} /tmp/storage\PYGZus{}report.txt}
\PYG{l+s}{fi}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }\PYGZti{}/bin/storage\PYGZus{}trend.sh
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 0 * * * \PYGZti{}/bin/storage\PYGZus{}trend.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}


\subsubsection{File System Metadata Analysis}
\label{\detokenize{data-organization:file-system-metadata-analysis}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Analyze inode usage}
df\PYG{+w}{ }\PYGZhy{}i

\PYG{c+c1}{\PYGZsh{} Find directories with most files}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }sh\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}echo \PYGZdq{}\PYGZdl{}(find \PYGZdq{}\PYGZdl{}1\PYGZdq{} \PYGZhy{}maxdepth 1 | wc \PYGZhy{}l) \PYGZdl{}1\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYGZus{}\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}rn\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}10

\PYG{c+c1}{\PYGZsh{} Analyze file access patterns}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}atime\PYG{+w}{ }\PYGZhy{}7\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }wc\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Files accessed in last 7 days}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }\PYGZhy{}7\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }wc\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Files modified in last 7 days}
find\PYG{+w}{ }/home\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}atime\PYG{+w}{ }+365\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }wc\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Files not accessed in over a year}
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{data-organization:frequently-asked-questions}}

\subsubsection{Q: How should I organize my home directory in Ubuntu 22.04?}
\label{\detokenize{data-organization:q-how-should-i-organize-my-home-directory-in-ubuntu-22-04}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Follow this recommended structure:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZti{}/
├──\PYG{+w}{ }Documents/
│\PYG{+w}{   }├──\PYG{+w}{ }Personal/
│\PYG{+w}{   }├──\PYG{+w}{ }Work/
│\PYG{+w}{   }└──\PYG{+w}{ }Archive/
├──\PYG{+w}{ }Projects/
│\PYG{+w}{   }├──\PYG{+w}{ }Active/
│\PYG{+w}{   }├──\PYG{+w}{ }Completed/
│\PYG{+w}{   }└──\PYG{+w}{ }Learning/
├──\PYG{+w}{ }Media/
│\PYG{+w}{   }├──\PYG{+w}{ }Photos/
│\PYG{+w}{   }├──\PYG{+w}{ }Videos/
│\PYG{+w}{   }└──\PYG{+w}{ }Music/
├──\PYG{+w}{ }Downloads/
│\PYG{+w}{   }└──\PYG{+w}{ }\PYG{o}{(}temporary,\PYG{+w}{ }clean\PYG{+w}{ }regularly\PYG{o}{)}
├──\PYG{+w}{ }Backup/
│\PYG{+w}{   }└──\PYG{+w}{ }\PYG{o}{(}\PYG{n+nb}{local}\PYG{+w}{ }backup\PYG{+w}{ }copies\PYG{o}{)}
└──\PYG{+w}{ }Scripts/
\PYG{+w}{    }└──\PYG{+w}{ }\PYG{o}{(}personal\PYG{+w}{ }automation\PYG{+w}{ }scripts\PYG{o}{)}
\end{sphinxVerbatim}


\subsubsection{Q: What’s the best way to handle duplicate files?}
\label{\detokenize{data-organization:q-what-s-the-best-way-to-handle-duplicate-files}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these strategies:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Find duplicates without deleting}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZti{}/Documents

\PYG{c+c1}{\PYGZsh{} 2. Interactive deletion}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZti{}/Documents

\PYG{c+c1}{\PYGZsh{} 3. Automatic deletion (keep first occurrence)}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZti{}/Documents\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZca{}\PYGZdl{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }xargs\PYG{+w}{ }rm

\PYG{c+c1}{\PYGZsh{} 4. Convert to hard links (saves space)}
rdfind\PYG{+w}{ }\PYGZhy{}makehardlinks\PYG{+w}{ }\PYG{n+nb}{true}\PYG{+w}{ }\PYGZti{}/Documents
\end{sphinxVerbatim}


\subsubsection{Q: How can I automate file organization?}
\label{\detokenize{data-organization:q-how-can-i-automate-file-organization}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Create automated organization scripts:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} File organizer by extension}
\PYG{c+c1}{\PYGZsh{}!/bin/bash}
organize\PYGZus{}by\PYGZus{}extension\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{source\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{target\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }file\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*.*\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nv}{ext}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{file}\PYG{p}{\PYGZsh{}\PYGZsh{}*.}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nv}{ext\PYGZus{}upper}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}ext}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tr\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:lower:]\PYGZsq{}}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:upper:]\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}ext\PYGZus{}upper}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }mv\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}ext\PYGZus{}upper}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Usage}
organize\PYGZus{}by\PYGZus{}extension\PYG{+w}{ }\PYGZti{}/Downloads\PYG{+w}{ }\PYGZti{}/Downloads/Organized
\end{sphinxVerbatim}


\subsubsection{Q: How do I implement a data retention policy?}
\label{\detokenize{data-organization:q-how-do-i-implement-a-data-retention-policy}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Create a retention management system:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} data\PYGZus{}retention.sh}

\PYG{c+c1}{\PYGZsh{} Define retention periods (days)}
\PYG{n+nv}{TEMP\PYGZus{}RETENTION}\PYG{o}{=}\PYG{l+m}{7}
\PYG{n+nv}{LOG\PYGZus{}RETENTION}\PYG{o}{=}\PYG{l+m}{90}
\PYG{n+nv}{BACKUP\PYGZus{}RETENTION}\PYG{o}{=}\PYG{l+m}{365}
\PYG{n+nv}{ARCHIVE\PYGZus{}RETENTION}\PYG{o}{=}\PYG{l+m}{2555}\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} 7 years}

\PYG{c+c1}{\PYGZsh{} Clean temporary files}
find\PYG{+w}{ }/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}TEMP\PYGZus{}RETENTION}\PYG{+w}{ }\PYGZhy{}delete
find\PYG{+w}{ }\PYGZti{}/.cache\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}TEMP\PYGZus{}RETENTION}\PYG{+w}{ }\PYGZhy{}delete

\PYG{c+c1}{\PYGZsh{} Archive old logs}
find\PYG{+w}{ }/var/log\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*.log\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}RETENTION}\PYG{+w}{ }\PYGZhy{}gzip

\PYG{c+c1}{\PYGZsh{} Remove old backups}
find\PYG{+w}{ }/backup\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*.tar.gz\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}RETENTION}\PYG{+w}{ }\PYGZhy{}delete

\PYG{c+c1}{\PYGZsh{} Alert for very old archives}
find\PYG{+w}{ }/archive\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}ARCHIVE\PYGZus{}RETENTION}\PYG{+w}{ }\PYGZhy{}ls\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Files exceeding retention policy\PYGZdq{}}\PYG{+w}{ }admin@example.com
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{data-organization:coding-examples}}

\subsubsection{Python Data Organization Manager}
\label{\detokenize{data-organization:python-data-organization-manager}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Advanced data organization manager for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{shutil}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{hashlib}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{mimetypes}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{pathlib}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{Path}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{collections}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{defaultdict}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{argparse}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{DataOrganizer}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{base\PYGZus{}path}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{base\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{base\PYGZus{}path}\PYG{p}{)} \PYG{k}{if} \PYG{n}{base\PYGZus{}path} \PYG{k}{else} \PYG{n}{Path}\PYG{o}{.}\PYG{n}{home}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{file\PYGZus{}types} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{documents}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.pdf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.doc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.docx}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.rtf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.odt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{images}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.jpg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.jpeg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.png}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.gif}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.bmp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.tiff}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.svg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{videos}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.mp4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.avi}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.mkv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.mov}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.wmv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.flv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.webm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{music}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.mp3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.flac}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.wav}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.ogg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.m4a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.aac}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{archives}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.zip}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.tar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.gz}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.bz2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.xz}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.rar}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.7z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{code}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.py}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.js}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.html}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.css}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.java}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.cpp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.php}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.xml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.sql}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.db}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.sqlite}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{p}{\PYGZcb{}}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats} \PYG{o}{=} \PYG{n}{defaultdict}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}file\PYGZus{}hash}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{filepath}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculate MD5 hash of a file\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{hash\PYGZus{}md5} \PYG{o}{=} \PYG{n}{hashlib}\PYG{o}{.}\PYG{n}{md5}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{filepath}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{rb}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{chunk} \PYG{o+ow}{in} \PYG{n+nb}{iter}\PYG{p}{(}\PYG{k}{lambda}\PYG{p}{:} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{l+m+mi}{4096}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+sa}{b}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{hash\PYGZus{}md5}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{n}{chunk}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{hash\PYGZus{}md5}\PYG{o}{.}\PYG{n}{hexdigest}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{except} \PYG{p}{(}\PYG{n+ne}{IOError}\PYG{p}{,} \PYG{n+ne}{OSError}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{return} \PYG{k+kc}{None}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{find\PYGZus{}duplicates}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{directory}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Find duplicate files in a directory\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{duplicates} \PYG{o}{=} \PYG{n}{defaultdict}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{root}\PYG{p}{,} \PYG{n}{dirs}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{os}\PYG{o}{.}\PYG{n}{walk}\PYG{p}{(}\PYG{n}{directory}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{files}\PYG{p}{:}
                \PYG{n}{filepath} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{root}\PYG{p}{)} \PYG{o}{/} \PYG{n}{file}
                \PYG{k}{if} \PYG{n}{filepath}\PYG{o}{.}\PYG{n}{is\PYGZus{}file}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{file\PYGZus{}hash} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}file\PYGZus{}hash}\PYG{p}{(}\PYG{n}{filepath}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n}{file\PYGZus{}hash}\PYG{p}{:}
                        \PYG{n}{duplicates}\PYG{p}{[}\PYG{n}{file\PYGZus{}hash}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{filepath}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Filter out unique files}
        \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{n}{k}\PYG{p}{:} \PYG{n}{v} \PYG{k}{for} \PYG{n}{k}\PYG{p}{,} \PYG{n}{v} \PYG{o+ow}{in} \PYG{n}{duplicates}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)} \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{v}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{organize\PYGZus{}by\PYGZus{}type}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{source\PYGZus{}dir}\PYG{p}{,} \PYG{n}{target\PYGZus{}dir}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Organize files by type\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{source\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{source\PYGZus{}dir}\PYG{p}{)}
        \PYG{n}{target\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{target\PYGZus{}dir}\PYG{p}{)} \PYG{k}{if} \PYG{n}{target\PYGZus{}dir} \PYG{k}{else} \PYG{n}{source\PYGZus{}path} \PYG{o}{/} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Organized}\PYG{l+s+s2}{\PYGZdq{}}

        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{source\PYGZus{}path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{raise} \PYG{n+ne}{ValueError}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Source directory }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{source\PYGZus{}path}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ does not exist}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{n}{target\PYGZus{}path}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{file\PYGZus{}path} \PYG{o+ow}{in} \PYG{n}{source\PYGZus{}path}\PYG{o}{.}\PYG{n}{rglob}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{is\PYGZus{}file}\PYG{p}{(}\PYG{p}{)} \PYG{o+ow}{and} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{parent} \PYG{o}{==} \PYG{n}{source\PYGZus{}path}\PYG{p}{:}
                \PYG{n}{file\PYGZus{}ext} \PYG{o}{=} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{suffix}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}

                \PYG{c+c1}{\PYGZsh{} Determine file category}
                \PYG{n}{category} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{misc}\PYG{l+s+s1}{\PYGZsq{}}
                \PYG{k}{for} \PYG{n}{cat}\PYG{p}{,} \PYG{n}{extensions} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{file\PYGZus{}types}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                    \PYG{k}{if} \PYG{n}{file\PYGZus{}ext} \PYG{o+ow}{in} \PYG{n}{extensions}\PYG{p}{:}
                        \PYG{n}{category} \PYG{o}{=} \PYG{n}{cat}
                        \PYG{k}{break}

                \PYG{c+c1}{\PYGZsh{} Create category directory}
                \PYG{n}{category\PYGZus{}dir} \PYG{o}{=} \PYG{n}{target\PYGZus{}path} \PYG{o}{/} \PYG{n}{category}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{p}{)}
                \PYG{n}{category\PYGZus{}dir}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

                \PYG{c+c1}{\PYGZsh{} Move file}
                \PYG{n}{new\PYGZus{}path} \PYG{o}{=} \PYG{n}{category\PYGZus{}dir} \PYG{o}{/} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{name}

                \PYG{c+c1}{\PYGZsh{} Handle naming conflicts}
                \PYG{n}{counter} \PYG{o}{=} \PYG{l+m+mi}{1}
                \PYG{n}{original\PYGZus{}name} \PYG{o}{=} \PYG{n}{new\PYGZus{}path}\PYG{o}{.}\PYG{n}{stem}
                \PYG{k}{while} \PYG{n}{new\PYGZus{}path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{new\PYGZus{}path} \PYG{o}{=} \PYG{n}{category\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{original\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{counter}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{suffix}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
                    \PYG{n}{counter} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}

                \PYG{k}{try}\PYG{p}{:}
                    \PYG{n}{shutil}\PYG{o}{.}\PYG{n}{move}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{file\PYGZus{}path}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{new\PYGZus{}path}\PYG{p}{)}\PYG{p}{)}
                    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{moved\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{category}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Moved }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ to }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{category}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{except} \PYG{p}{(}\PYG{n+ne}{IOError}\PYG{p}{,} \PYG{n+ne}{OSError}\PYG{p}{)} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error moving }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{organize\PYGZus{}by\PYGZus{}date}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{source\PYGZus{}dir}\PYG{p}{,} \PYG{n}{target\PYGZus{}dir}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Organize files by modification date\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{source\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{source\PYGZus{}dir}\PYG{p}{)}
        \PYG{n}{target\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{target\PYGZus{}dir}\PYG{p}{)} \PYG{k}{if} \PYG{n}{target\PYGZus{}dir} \PYG{k}{else} \PYG{n}{source\PYGZus{}path} \PYG{o}{/} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ByDate}\PYG{l+s+s2}{\PYGZdq{}}

        \PYG{n}{target\PYGZus{}path}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{file\PYGZus{}path} \PYG{o+ow}{in} \PYG{n}{source\PYGZus{}path}\PYG{o}{.}\PYG{n}{rglob}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{is\PYGZus{}file}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} Get modification time}
                \PYG{n}{mtime} \PYG{o}{=} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{stat}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{st\PYGZus{}mtime}
                \PYG{n}{date\PYGZus{}str} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y/}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{localtime}\PYG{p}{(}\PYG{n}{mtime}\PYG{p}{)}\PYG{p}{)}

                \PYG{c+c1}{\PYGZsh{} Create date directory}
                \PYG{n}{date\PYGZus{}dir} \PYG{o}{=} \PYG{n}{target\PYGZus{}path} \PYG{o}{/} \PYG{n}{date\PYGZus{}str}
                \PYG{n}{date\PYGZus{}dir}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{parents}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

                \PYG{c+c1}{\PYGZsh{} Move file}
                \PYG{n}{new\PYGZus{}path} \PYG{o}{=} \PYG{n}{date\PYGZus{}dir} \PYG{o}{/} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{name}

                \PYG{c+c1}{\PYGZsh{} Handle naming conflicts}
                \PYG{n}{counter} \PYG{o}{=} \PYG{l+m+mi}{1}
                \PYG{n}{original\PYGZus{}name} \PYG{o}{=} \PYG{n}{new\PYGZus{}path}\PYG{o}{.}\PYG{n}{stem}
                \PYG{k}{while} \PYG{n}{new\PYGZus{}path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{new\PYGZus{}path} \PYG{o}{=} \PYG{n}{date\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{original\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{counter}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{suffix}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
                    \PYG{n}{counter} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}

                \PYG{k}{try}\PYG{p}{:}
                    \PYG{n}{shutil}\PYG{o}{.}\PYG{n}{move}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{file\PYGZus{}path}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{new\PYGZus{}path}\PYG{p}{)}\PYG{p}{)}
                    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{moved\PYGZus{}by\PYGZus{}date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                \PYG{k}{except} \PYG{p}{(}\PYG{n+ne}{IOError}\PYG{p}{,} \PYG{n+ne}{OSError}\PYG{p}{)} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error moving }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{clean\PYGZus{}empty\PYGZus{}directories}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{directory}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Remove empty directories\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{removed\PYGZus{}count} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{root}\PYG{p}{,} \PYG{n}{dirs}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{os}\PYG{o}{.}\PYG{n}{walk}\PYG{p}{(}\PYG{n}{directory}\PYG{p}{,} \PYG{n}{topdown}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{dir\PYGZus{}name} \PYG{o+ow}{in} \PYG{n}{dirs}\PYG{p}{:}
                \PYG{n}{dir\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{root}\PYG{p}{)} \PYG{o}{/} \PYG{n}{dir\PYGZus{}name}
                \PYG{k}{try}\PYG{p}{:}
                    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb}{any}\PYG{p}{(}\PYG{n}{dir\PYGZus{}path}\PYG{o}{.}\PYG{n}{iterdir}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                        \PYG{n}{dir\PYGZus{}path}\PYG{o}{.}\PYG{n}{rmdir}\PYG{p}{(}\PYG{p}{)}
                        \PYG{n}{removed\PYGZus{}count} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Removed empty directory: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{dir\PYGZus{}path}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{except} \PYG{n+ne}{OSError}\PYG{p}{:}
                    \PYG{k}{pass}  \PYG{c+c1}{\PYGZsh{} Directory not empty or permission denied}

        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{removed\PYGZus{}empty\PYGZus{}dirs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{removed\PYGZus{}count}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{analyze\PYGZus{}directory}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{directory}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Analyze directory structure and file distribution\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{analysis} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{0}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{file\PYGZus{}types}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{defaultdict}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}by\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{defaultdict}\PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{largest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{oldest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{newest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}
        \PYG{p}{\PYGZcb{}}

        \PYG{n}{files\PYGZus{}with\PYGZus{}info} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{for} \PYG{n}{root}\PYG{p}{,} \PYG{n}{dirs}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{os}\PYG{o}{.}\PYG{n}{walk}\PYG{p}{(}\PYG{n}{directory}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{files}\PYG{p}{:}
                \PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{root}\PYG{p}{)} \PYG{o}{/} \PYG{n}{file}
                \PYG{k}{if} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{is\PYGZus{}file}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                    \PYG{k}{try}\PYG{p}{:}
                        \PYG{n}{stat\PYGZus{}info} \PYG{o}{=} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{stat}\PYG{p}{(}\PYG{p}{)}
                        \PYG{n}{file\PYGZus{}size} \PYG{o}{=} \PYG{n}{stat\PYGZus{}info}\PYG{o}{.}\PYG{n}{st\PYGZus{}size}
                        \PYG{n}{file\PYGZus{}ext} \PYG{o}{=} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{suffix}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}

                        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{n}{file\PYGZus{}size}
                        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{file\PYGZus{}types}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{file\PYGZus{}ext}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}by\PYGZus{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{file\PYGZus{}ext}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{n}{file\PYGZus{}size}

                        \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{file\PYGZus{}path}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{file\PYGZus{}size}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mtime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{stat\PYGZus{}info}\PYG{o}{.}\PYG{n}{st\PYGZus{}mtime}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}
                    \PYG{k}{except} \PYG{n+ne}{OSError}\PYG{p}{:}
                        \PYG{k}{continue}

        \PYG{c+c1}{\PYGZsh{} Sort files for top lists}
        \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{o}{.}\PYG{n}{sort}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{reverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{largest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size\PYGZus{}mb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024}\PYG{o}{*}\PYG{l+m+mi}{1024}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
            \PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}
        \PYG{p}{]}

        \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{o}{.}\PYG{n}{sort}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mtime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{oldest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{localtime}\PYG{p}{(}\PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mtime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
            \PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}
        \PYG{p}{]}

        \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{o}{.}\PYG{n}{sort}\PYG{p}{(}\PYG{n}{key}\PYG{o}{=}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mtime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{reverse}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n}{analysis}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{newest\PYGZus{}files}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{time}\PYG{o}{.}\PYG{n}{localtime}\PYG{p}{(}\PYG{n}{f}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mtime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
            \PYG{k}{for} \PYG{n}{f} \PYG{o+ow}{in} \PYG{n}{files\PYGZus{}with\PYGZus{}info}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}
        \PYG{p}{]}

        \PYG{k}{return} \PYG{n}{analysis}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{create\PYGZus{}backup\PYGZus{}structure}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{source\PYGZus{}dir}\PYG{p}{,} \PYG{n}{backup\PYGZus{}dir}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Create organized backup structure\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{source\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{source\PYGZus{}dir}\PYG{p}{)}
        \PYG{n}{backup\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{backup\PYGZus{}dir}\PYG{p}{)}

        \PYG{n}{timestamp} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{backup\PYGZus{}target} \PYG{o}{=} \PYG{n}{backup\PYGZus{}path} \PYG{o}{/} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{backup\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{timestamp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{n}{backup\PYGZus{}target}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{parents}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Copy files with organization}
        \PYG{k}{for} \PYG{n}{category}\PYG{p}{,} \PYG{n}{extensions} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{file\PYGZus{}types}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{category\PYGZus{}backup} \PYG{o}{=} \PYG{n}{backup\PYGZus{}target} \PYG{o}{/} \PYG{n}{category}
            \PYG{n}{category\PYGZus{}backup}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{for} \PYG{n}{root}\PYG{p}{,} \PYG{n}{dirs}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{os}\PYG{o}{.}\PYG{n}{walk}\PYG{p}{(}\PYG{n}{source\PYGZus{}path}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{files}\PYG{p}{:}
                    \PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{root}\PYG{p}{)} \PYG{o}{/} \PYG{n}{file}
                    \PYG{k}{if} \PYG{n}{file\PYGZus{}path}\PYG{o}{.}\PYG{n}{suffix}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)} \PYG{o+ow}{in} \PYG{n}{extensions}\PYG{p}{:}
                        \PYG{k}{try}\PYG{p}{:}
                            \PYG{n}{shutil}\PYG{o}{.}\PYG{n}{copy2}\PYG{p}{(}\PYG{n}{file\PYGZus{}path}\PYG{p}{,} \PYG{n}{category\PYGZus{}backup}\PYG{p}{)}
                            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{backed\PYGZus{}up\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{category}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}
                        \PYG{k}{except} \PYG{p}{(}\PYG{n+ne}{IOError}\PYG{p}{,} \PYG{n+ne}{OSError}\PYG{p}{)} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error backing up }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file\PYGZus{}path}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{generate\PYGZus{}report}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Generate organization report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{H:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{statistics}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{dict}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{summary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Processed }\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stats}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ operations}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{return} \PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{parser} \PYG{o}{=} \PYG{n}{argparse}\PYG{o}{.}\PYG{n}{ArgumentParser}\PYG{p}{(}\PYG{n}{description}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Data Organization Manager}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{command}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{choices}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{organize}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{analyze}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duplicates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{backup}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{source}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Source directory}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}target}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Target directory}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}by\PYGZhy{}type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Organize by file type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}by\PYGZhy{}date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Organize by date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{args} \PYG{o}{=} \PYG{n}{parser}\PYG{o}{.}\PYG{n}{parse\PYGZus{}args}\PYG{p}{(}\PYG{p}{)}

    \PYG{n}{organizer} \PYG{o}{=} \PYG{n}{DataOrganizer}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{args}\PYG{o}{.}\PYG{n}{command} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{organize}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{args}\PYG{o}{.}\PYG{n}{by\PYGZus{}type}\PYG{p}{:}
            \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{organize\PYGZus{}by\PYGZus{}type}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{,} \PYG{n}{args}\PYG{o}{.}\PYG{n}{target}\PYG{p}{)}
        \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{by\PYGZus{}date}\PYG{p}{:}
            \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{organize\PYGZus{}by\PYGZus{}date}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{,} \PYG{n}{args}\PYG{o}{.}\PYG{n}{target}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{organize\PYGZus{}by\PYGZus{}type}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{,} \PYG{n}{args}\PYG{o}{.}\PYG{n}{target}\PYG{p}{)}

    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{command} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{analyze}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
        \PYG{n}{analysis} \PYG{o}{=} \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{analyze\PYGZus{}directory}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{analysis}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{default}\PYG{o}{=}\PYG{n+nb}{str}\PYG{p}{)}\PYG{p}{)}

    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{command} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{duplicates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
        \PYG{n}{duplicates} \PYG{o}{=} \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{find\PYGZus{}duplicates}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Found }\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{duplicates}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ sets of duplicate files:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{hash\PYGZus{}val}\PYG{p}{,} \PYG{n}{files} \PYG{o+ow}{in} \PYG{n}{duplicates}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Hash }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{hash\PYGZus{}val}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n}{files}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{file}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{command} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{backup}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{args}\PYG{o}{.}\PYG{n}{target}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Target directory required for backup}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return}
        \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{create\PYGZus{}backup\PYGZus{}structure}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{,} \PYG{n}{args}\PYG{o}{.}\PYG{n}{target}\PYG{p}{)}

    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{command} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
        \PYG{n}{organizer}\PYG{o}{.}\PYG{n}{clean\PYGZus{}empty\PYGZus{}directories}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{source}\PYG{p}{)}

    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{organizer}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Bash File Organization System}
\label{\detokenize{data-organization:bash-file-organization-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} advanced\PYGZus{}file\PYGZus{}organizer.sh \PYGZhy{} Advanced file organization system for Ubuntu 22.04}

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{CONFIG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+s2}{/.file\PYGZus{}organizer.conf}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+s2}{/.file\PYGZus{}organizer.log}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Default configuration}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}CONFIG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} File Organization Configuration}
\PYG{l+s}{ORGANIZE\PYGZus{}DOWNLOADS=true}
\PYG{l+s}{ORGANIZE\PYGZus{}DESKTOP=true}
\PYG{l+s}{AUTO\PYGZus{}ARCHIVE\PYGZus{}DAYS=365}
\PYG{l+s}{DUPLICATE\PYGZus{}ACTION=ask  \PYGZsh{} ask, delete, link}
\PYG{l+s}{BACKUP\PYGZus{}ENABLED=true}
\PYG{l+s}{BACKUP\PYGZus{}DIR=\PYGZdq{}\PYGZdl{}HOME/Backup\PYGZdq{}}

\PYG{l+s}{\PYGZsh{} File type definitions}
\PYG{l+s}{DOCUMENTS=\PYGZdq{}pdf doc docx txt rtf odt\PYGZdq{}}
\PYG{l+s}{IMAGES=\PYGZdq{}jpg jpeg png gif bmp tiff svg\PYGZdq{}}
\PYG{l+s}{VIDEOS=\PYGZdq{}mp4 avi mkv mov wmv flv webm\PYGZdq{}}
\PYG{l+s}{MUSIC=\PYGZdq{}mp3 flac wav ogg m4a aac\PYGZdq{}}
\PYG{l+s}{ARCHIVES=\PYGZdq{}zip tar gz bz2 xz rar 7z\PYGZdq{}}
\PYG{l+s}{CODE=\PYGZdq{}py js html css java cpp c php\PYGZdq{}}
\PYG{l+s}{DATA=\PYGZdq{}csv json xml sql db sqlite\PYGZdq{}}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Load configuration}
\PYG{n+nb}{source}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}CONFIG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Logging function}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Create directory structure}
create\PYGZus{}structure\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{base\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Creating directory structure in }\PYG{n+nv}{\PYGZdl{}base\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}base\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}/\PYG{o}{\PYGZob{}}Documents,Images,Videos,Music,Archives,Code,Data,Misc\PYG{o}{\PYGZcb{}}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}base\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}/Archive/\PYG{o}{\PYGZob{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYG{k}{)},\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}last year\PYGZsq{}}\PYG{+w}{ }+\PYGZpc{}Y\PYG{k}{)}\PYG{o}{\PYGZcb{}}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}base\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}/Backup

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Directory structure created\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Get file category}
get\PYGZus{}file\PYGZus{}category\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{extension}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{file}\PYG{p}{\PYGZsh{}\PYGZsh{}*.}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nv}{extension}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tr\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:upper:]\PYGZsq{}}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}[:lower:]\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}DOCUMENTS}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Documents\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}IMAGES}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Images\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}VIDEOS}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Videos\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}MUSIC}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Music\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}ARCHIVES}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Archives\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}CODE}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Code\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}DATA}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZdq{}}*\PYG{o}{)}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Data\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{return}\PYG{+w}{ }\PYG{p}{;}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{esac}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Misc\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Organize files by type}
organize\PYGZus{}by\PYGZus{}type\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{source\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{target\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Organizing files from }\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }create\PYGZus{}structure\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{moved\PYGZus{}count}\PYG{o}{=}\PYG{l+m}{0}

\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}maxdepth\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }file\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{filename}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{category}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}get\PYGZus{}file\PYGZus{}category\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}filename}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{target\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}category}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}filename}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Handle name conflicts}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{counter}\PYG{o}{=}\PYG{l+m}{1}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{base\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{filename}\PYG{p}{\PYGZpc{}.*}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{extension}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{filename}\PYG{p}{\PYGZsh{}\PYGZsh{}*.}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{k}{while}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}extension}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }!\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}filename}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                    }\PYG{n+nv}{target\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}category}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{base\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{counter}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{extension}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{else}
\PYG{+w}{                    }\PYG{n+nv}{target\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}category}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{filename}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{counter}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{fi}
\PYG{+w}{                }\PYG{o}{(}\PYG{o}{(}counter++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{done}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }mv\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Moved }\PYG{n+nv}{\PYGZdl{}filename}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}category}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{o}{(}\PYG{o}{(}moved\PYGZus{}count++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Failed to move }\PYG{n+nv}{\PYGZdl{}filename}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Organized }\PYG{n+nv}{\PYGZdl{}moved\PYGZus{}count}\PYG{l+s+s2}{ files}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Find and handle duplicates}
handle\PYGZus{}duplicates\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{directory}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{action}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}DUPLICATE\PYGZus{}ACTION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Finding duplicates in }\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }fdupes\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Installing fdupes for duplicate detection\PYGZdq{}}
\PYG{+w}{        }sudo\PYG{+w}{ }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }fdupes
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{duplicates\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/tmp/duplicates\PYGZus{}}\PYG{n+nv}{\PYGZdl{}\PYGZdl{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}duplicates\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{duplicate\PYGZus{}sets}\PYG{o}{=}\PYG{l+m}{0}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{files\PYGZus{}processed}\PYG{o}{=}\PYG{l+m}{0}

\PYG{+w}{    }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nv}{IFS}\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }line\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{o}{(}\PYG{o}{(}duplicate\PYGZus{}sets++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{        }\PYG{k}{elif}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}action}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{                }\PYG{l+s+s2}{\PYGZdq{}delete\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}files\PYGZus{}processed}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                        }rm\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Deleted duplicate: }\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                    }\PYG{k}{fi}
\PYG{+w}{                    }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{                }\PYG{l+s+s2}{\PYGZdq{}link\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}files\PYGZus{}processed}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                        }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{first\PYGZus{}file}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}head\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}duplicates\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{                        }rm\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                        }ln\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}first\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Linked duplicate: }\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                    }\PYG{k}{fi}
\PYG{+w}{                    }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{                }\PYG{l+s+s2}{\PYGZdq{}ask\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{                    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}files\PYGZus{}processed}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Duplicate found: }\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                        }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Delete this file? (y/N): \PYGZdq{}}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}r
\PYG{+w}{                        }\PYG{n+nb}{echo}
\PYG{+w}{                        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}REPLY}\PYG{+w}{ }\PYG{o}{=}\PYGZti{}\PYG{+w}{ }\PYGZca{}\PYG{o}{[}Yy\PYG{o}{]}\PYGZdl{}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                            }rm\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{User deleted duplicate: }\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                        }\PYG{k}{fi}
\PYG{+w}{                    }\PYG{k}{fi}
\PYG{+w}{                    }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{esac}
\PYG{+w}{            }\PYG{o}{(}\PYG{o}{(}files\PYGZus{}processed++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}\PYG{+w}{ }\PYGZlt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}duplicates\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }rm\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}duplicates\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Processed }\PYG{n+nv}{\PYGZdl{}duplicate\PYGZus{}sets}\PYG{l+s+s2}{ sets of duplicates}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Archive old files}
archive\PYGZus{}old\PYGZus{}files\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{source\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{days}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}AUTO\PYGZus{}ARCHIVE\PYGZus{}DAYS}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Archiving files older than }\PYG{n+nv}{\PYGZdl{}days}\PYG{l+s+s2}{ days from }\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{archive\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{/Archive/}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}archive\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{archived\PYGZus{}count}\PYG{o}{=}\PYG{l+m}{0}

\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}days}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}path\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*/Archive/*\PYGZdq{}}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}path\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*/Backup/*\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }file\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{relative\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{file}\PYG{p}{\PYGZsh{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{p}{/}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{archive\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}archive\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}relative\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{archive\PYGZus{}parent}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}dirname\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}archive\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}

\PYG{+w}{        }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}archive\PYGZus{}parent}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }mv\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}archive\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Archived: }\PYG{n+nv}{\PYGZdl{}relative\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{o}{(}\PYG{o}{(}archived\PYGZus{}count++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Archived }\PYG{n+nv}{\PYGZdl{}archived\PYGZus{}count}\PYG{l+s+s2}{ files}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Create backup}
create\PYGZus{}backup\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{source\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}ENABLED}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }!\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}true\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup disabled in configuration\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Creating backup of }\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{timestamp}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}target}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{/backup\PYGZus{}}\PYG{n+nv}{\PYGZdl{}timestamp}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}progress\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}source\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup created successfully: }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Compress backup}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }tar\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}C\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{backup\PYGZus{}}\PYG{n+nv}{\PYGZdl{}timestamp}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup compressed: }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}target}\PYG{l+s+s2}{.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup failed\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Generate organization report}
generate\PYGZus{}report\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{directory}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{report\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/tmp/organization\PYGZus{}report\PYGZus{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}\PYG{l+s+s2}{.txt}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{o}{\PYGZob{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}File Organization Report\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}========================\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Generated: }\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Directory: }\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Directory Structure:\PYGZdq{}}
\PYG{+w}{        }tree\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}20
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}File Count by Type:\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{type}\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }Documents\PYG{+w}{ }Images\PYG{+w}{ }Videos\PYG{+w}{ }Music\PYG{+w}{ }Archives\PYG{+w}{ }Code\PYG{+w}{ }Data\PYG{+w}{ }Misc\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nv}{count}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }wc\PYG{+w}{ }\PYGZhy{}l\PYG{k}{)}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}type}\PYG{l+s+s2}{: }\PYG{n+nv}{\PYGZdl{}count}\PYG{l+s+s2}{ files}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{done}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Storage Usage:\PYGZdq{}}
\PYG{+w}{        }du\PYG{+w}{ }\PYGZhy{}sh\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}directory}\PYG{l+s+s2}{\PYGZdq{}}/*\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Recent Activity (from log):\PYGZdq{}}
\PYG{+w}{        }tail\PYG{+w}{ }\PYGZhy{}20\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Report generated: }\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Email report if mail is configured}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }mail\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }cat\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}report\PYGZus{}file}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}File Organization Report\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}USER}\PYG{l+s+s2}{@localhost}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main execution}
main\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{help}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}organize\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }organize\PYGZus{}by\PYGZus{}type\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{p}{/Downloads}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{3}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{p}{/Organized}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}duplicates\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }handle\PYGZus{}duplicates\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{3}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{ask}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}archive\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }archive\PYGZus{}old\PYGZus{}files\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{3}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{365}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}backup\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }create\PYGZus{}backup\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{3}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}report\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }generate\PYGZus{}report\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}full\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Full organization workflow}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{target\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{2}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{p}{/Organized}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Starting full organization workflow\PYGZdq{}}

\PYG{+w}{            }create\PYGZus{}backup\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+s2}{/Downloads}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }organize\PYGZus{}by\PYGZus{}type\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}HOME}\PYG{l+s+s2}{/Downloads}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }handle\PYGZus{}duplicates\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}ask\PYGZdq{}}
\PYG{+w}{            }archive\PYGZus{}old\PYGZus{}files\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }generate\PYGZus{}report\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Full organization workflow completed\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}config\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }nano\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}CONFIG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}help\PYGZdq{}}\PYG{p}{|}*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Advanced File Organizer for Ubuntu 22.04\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [command] [options]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Commands:\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  organize [source] [target]    \PYGZhy{} Organize files by type\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  duplicates [dir] [action]     \PYGZhy{} Handle duplicate files (ask/delete/link)\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  archive [dir] [days]          \PYGZhy{} Archive old files\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  backup [source] [target]      \PYGZhy{} Create backup\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  report [directory]            \PYGZhy{} Generate organization report\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  full [target]                 \PYGZhy{} Run complete organization workflow\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  config                        \PYGZhy{} Edit configuration\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Examples:\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ organize \PYGZti{}/Downloads \PYGZti{}/Organized}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ duplicates \PYGZti{}/Documents delete}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ archive \PYGZti{}/Documents 180}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ full \PYGZti{}/MyFiles}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Run main function with all arguments}
main\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}@}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\subsection{Best Practices for Data Organization}
\label{\detokenize{data-organization:best-practices-for-data-organization}}

\subsubsection{Strategic Planning}
\label{\detokenize{data-organization:strategic-planning}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Classification Strategy}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Identify data types and access patterns

\item {} 
\sphinxAtStartPar
Define retention policies

\item {} 
\sphinxAtStartPar
Establish backup requirements

\item {} 
\sphinxAtStartPar
Plan for data growth

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Directory Structure Design}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Use consistent naming conventions

\item {} 
\sphinxAtStartPar
Implement logical hierarchies

\item {} 
\sphinxAtStartPar
Plan for scalability

\item {} 
\sphinxAtStartPar
Document organization rules

\end{itemize}

\end{enumerate}


\subsubsection{Automation and Maintenance}
\label{\detokenize{data-organization:automation-and-maintenance}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Automated Organization}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Daily organization cron job}
\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }*\PYG{+w}{ }*\PYG{+w}{ }*\PYG{+w}{ }/home/user/bin/organize\PYGZus{}data.sh

\PYG{c+c1}{\PYGZsh{} Weekly duplicate cleanup}
\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }*\PYG{+w}{ }*\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }/home/user/Documents

\PYG{c+c1}{\PYGZsh{} Monthly archival}
\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }*\PYG{+w}{ }*\PYG{+w}{ }/home/user/bin/archive\PYGZus{}old\PYGZus{}files.sh
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring and Alerts}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Storage usage monitoring}
\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }/\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZpc{}//\PYGZsq{}}\PYG{k}{)}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{85}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Disk usage critical\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Storage Alert\PYGZdq{}}\PYG{+w}{ }admin
\PYG{k}{fi}
\end{sphinxVerbatim}

\end{enumerate}


\subsubsection{Security and Compliance}
\label{\detokenize{data-organization:security-and-compliance}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Protection}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Implement access controls

\item {} 
\sphinxAtStartPar
Use encryption for sensitive data

\item {} 
\sphinxAtStartPar
Regular security audits

\item {} 
\sphinxAtStartPar
Backup verification

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Compliance Requirements}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Document data handling procedures

\item {} 
\sphinxAtStartPar
Implement retention policies

\item {} 
\sphinxAtStartPar
Audit trail maintenance

\item {} 
\sphinxAtStartPar
Regular compliance reviews

\end{itemize}

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up secure data handling}
\PYG{c+c1}{\PYGZsh{} Encrypt sensitive directories}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }ecryptfs\PYGZhy{}utils
ecryptfs\PYGZhy{}migrate\PYGZhy{}home\PYG{+w}{ }\PYGZhy{}u\PYG{+w}{ }username

\PYG{c+c1}{\PYGZsh{} Set appropriate permissions}
find\PYG{+w}{ }/home/user/Documents\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{640}\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}
find\PYG{+w}{ }/home/user/Documents\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{750}\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{RAID Systems}
\label{\detokenize{raid-systems:raid-systems}}\label{\detokenize{raid-systems::doc}}

\section{Understanding RAID}
\label{\detokenize{raid-systems:understanding-raid}}
\sphinxAtStartPar
RAID (Redundant Array of Independent Disks) is a technology that combines multiple disk drives into a single logical unit to improve performance, provide redundancy, or both. RAID systems are crucial for data protection and performance optimization in storage systems.


\subsection{What is RAID?}
\label{\detokenize{raid-systems:what-is-raid}}
\sphinxAtStartPar
RAID provides:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Redundancy}: Protection against disk failures

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance Improvement}: Faster read/write operations through parallelism

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Storage Efficiency}: Optimized use of available disk space

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Fault Tolerance}: Ability to continue operation despite disk failures

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Scalability}: Easy expansion of storage capacity

\end{itemize}


\subsection{RAID Levels Overview}
\label{\detokenize{raid-systems:raid-levels-overview}}

\subsubsection{Standard RAID Levels}
\label{\detokenize{raid-systems:standard-raid-levels}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
RAID Level    | Description              | Min Disks | Fault Tolerance | Performance
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
RAID 0        | Striping (no redundancy) | 2         | None           | High Read/Write
RAID 1        | Mirroring                | 2         | 1 disk failure | Good Read, Normal Write
RAID 5        | Striping with Parity     | 3         | 1 disk failure | Good Read, Moderate Write
RAID 6        | Double Parity           | 4         | 2 disk failures| Good Read, Lower Write
RAID 10       | Mirror + Stripe         | 4         | Multiple disks | High Read/Write
\end{sphinxVerbatim}


\subsubsection{RAID 0 \sphinxhyphen{} Striping}
\label{\detokenize{raid-systems:raid-0-striping}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Data is striped across multiple disks
* No redundancy \sphinxhyphen{} failure of any disk results in total data loss
* Excellent performance for both reads and writes
* Full utilization of disk capacity

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* High\sphinxhyphen{}performance applications
* Temporary data processing
* Non\sphinxhyphen{}critical data requiring high speed

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 0 with mdadm}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{0}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{2}\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Format and mount}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/md0
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/raid0
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/md0\PYG{+w}{ }/mnt/raid0
\end{sphinxVerbatim}


\subsubsection{RAID 1 \sphinxhyphen{} Mirroring}
\label{\detokenize{raid-systems:raid-1-mirroring}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Data is mirrored across multiple disks
* Can survive failure of all but one disk
* Read performance can be improved
* Write performance is similar to single disk
* 50\% storage efficiency

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* Critical data requiring high availability
* Operating system partitions
* Database storage
* Boot drives

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 1 with mdadm}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md1\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{2}\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Monitor RAID status}
cat\PYG{+w}{ }/proc/mdstat

\PYG{c+c1}{\PYGZsh{} Check RAID details}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }/dev/md1
\end{sphinxVerbatim}


\subsubsection{RAID 5 \sphinxhyphen{} Striping with Parity}
\label{\detokenize{raid-systems:raid-5-striping-with-parity}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Data and parity information striped across all disks
* Can survive failure of one disk
* Good read performance
* Write performance penalty due to parity calculation
* Storage efficiency: (n\sphinxhyphen{}1)/n where n is number of disks

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* General purpose storage
* File servers
* Backup storage
* Cost\sphinxhyphen{}effective redundancy

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 5 with 3 disks}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md5\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{5}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Add spare disk}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md5\PYG{+w}{ }/dev/sde
\end{sphinxVerbatim}


\subsubsection{RAID 6 \sphinxhyphen{} Double Parity}
\label{\detokenize{raid-systems:raid-6-double-parity}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Two parity blocks for each stripe
* Can survive failure of two disks
* Better fault tolerance than RAID 5
* Lower write performance than RAID 5
* Storage efficiency: (n\sphinxhyphen{}2)/n

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* Large disk arrays
* Critical data with high availability requirements
* Long rebuild times scenarios
* Enterprise storage systems

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 6 with 4 disks}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md6\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{6}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd\PYG{+w}{ }/dev/sde
\end{sphinxVerbatim}


\subsubsection{RAID 10 \sphinxhyphen{} Mirror and Stripe}
\label{\detokenize{raid-systems:raid-10-mirror-and-stripe}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Combines RAID 1 (mirroring) and RAID 0 (striping)
* Excellent performance and redundancy
* Can survive multiple disk failures (in different mirror sets)
* 50\% storage efficiency
* Fast rebuild times

\sphinxAtStartPar
\sphinxstylestrong{Use Cases:}
* High\sphinxhyphen{}performance databases
* Virtual machine storage
* High\sphinxhyphen{}availability applications
* Enterprise critical data

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 10 with 4 disks}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md10\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{10}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd\PYG{+w}{ }/dev/sde
\end{sphinxVerbatim}


\subsection{Setting Up RAID on Ubuntu 22.04}
\label{\detokenize{raid-systems:setting-up-raid-on-ubuntu-22-04}}

\subsubsection{Installing RAID Tools}
\label{\detokenize{raid-systems:installing-raid-tools}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install mdadm for software RAID}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }mdadm

\PYG{c+c1}{\PYGZsh{} Install additional tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }smartmontools\PYG{+w}{ }hdparm\PYG{+w}{ }parted

\PYG{c+c1}{\PYGZsh{} Check available disks}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l
lsblk
\end{sphinxVerbatim}


\subsubsection{Preparing Disks for RAID}
\label{\detokenize{raid-systems:preparing-disks-for-raid}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Wipe disk signatures (WARNING: This destroys data!)}
sudo\PYG{+w}{ }wipefs\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }wipefs\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Create partitions (optional, can use whole disks)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mklabel\PYG{+w}{ }gpt
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }\PYG{l+m}{0}\PYGZpc{}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }raid\PYG{+w}{ }on

\PYG{c+c1}{\PYGZsh{} Verify no existing RAID metadata}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}examine\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}examine\PYG{+w}{ }/dev/sdc
\end{sphinxVerbatim}


\subsubsection{Creating RAID Arrays}
\label{\detokenize{raid-systems:creating-raid-arrays}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID 1 array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }\PYGZhy{}\PYGZhy{}verbose\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{2}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Create RAID 5 array with spare}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }\PYGZhy{}\PYGZhy{}verbose\PYG{+w}{ }/dev/md1\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{5}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}spare\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd\PYG{+w}{ }/dev/sde

\PYG{c+c1}{\PYGZsh{} Save RAID configuration}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYGZhy{}\PYGZhy{}scan\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/mdadm/mdadm.conf

\PYG{c+c1}{\PYGZsh{} Update initramfs}
sudo\PYG{+w}{ }update\PYGZhy{}initramfs\PYG{+w}{ }\PYGZhy{}u
\end{sphinxVerbatim}


\subsection{RAID Management and Monitoring}
\label{\detokenize{raid-systems:raid-management-and-monitoring}}

\subsubsection{Monitoring RAID Status}
\label{\detokenize{raid-systems:monitoring-raid-status}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check RAID status}
cat\PYG{+w}{ }/proc/mdstat

\PYG{c+c1}{\PYGZsh{} Detailed RAID information}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} Monitor RAID in real\PYGZhy{}time}
watch\PYG{+w}{ }cat\PYG{+w}{ }/proc/mdstat

\PYG{c+c1}{\PYGZsh{} Check individual disk health}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdb
\end{sphinxVerbatim}


\subsubsection{RAID Maintenance Operations}
\label{\detokenize{raid-systems:raid-maintenance-operations}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Add a disk to RAID array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Remove a disk from RAID array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Mark a disk as failed}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}fail\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Replace a failed disk}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb
\PYG{c+c1}{\PYGZsh{} Physically replace disk}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Grow RAID array (add more disks)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Reshape RAID array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{6}
\end{sphinxVerbatim}


\subsection{RAID Performance Optimization}
\label{\detokenize{raid-systems:raid-performance-optimization}}

\subsubsection{Stripe Size Optimization}
\label{\detokenize{raid-systems:stripe-size-optimization}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create RAID with custom chunk size}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{5}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}chunk\PYG{o}{=}\PYG{l+m}{64}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Test different chunk sizes for your workload}
\PYG{k}{for}\PYG{+w}{ }chunk\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }\PYG{l+m}{32}\PYG{+w}{ }\PYG{l+m}{64}\PYG{+w}{ }\PYG{l+m}{128}\PYG{+w}{ }\PYG{l+m}{256}\PYG{+w}{ }\PYG{l+m}{512}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Testing chunk size: }\PYG{n+nv}{\PYGZdl{}chunk}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create test array and measure performance}
\PYG{k}{done}
\end{sphinxVerbatim}


\subsubsection{I/O Scheduler Optimization}
\label{\detokenize{raid-systems:i-o-scheduler-optimization}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set I/O scheduler for RAID devices}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/md0/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Optimize readahead}
sudo\PYG{+w}{ }blockdev\PYG{+w}{ }\PYGZhy{}\PYGZhy{}setra\PYG{+w}{ }\PYG{l+m}{65536}\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} Disable barriers for better performance (if UPS protected)}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{barrier}\PYG{o}{=}\PYG{l+m}{0}\PYG{+w}{ }/dev/md0\PYG{+w}{ }/mnt/raid
\end{sphinxVerbatim}


\subsubsection{Filesystem Considerations}
\label{\detokenize{raid-systems:filesystem-considerations}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Align filesystem to RAID geometry}
\PYG{c+c1}{\PYGZsh{} For RAID 5 with 3 disks and 64K chunk size:}
\PYG{c+c1}{\PYGZsh{} Stripe width = (disks \PYGZhy{} parity) * chunk\PYGZus{}size = 2 * 64K = 128K}

sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{n+nv}{stride}\PYG{o}{=}\PYG{l+m}{16},stripe\PYGZhy{}width\PYG{o}{=}\PYG{l+m}{32}\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} For XFS on RAID}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{n+nv}{su}\PYG{o}{=}\PYG{l+m}{65536},sw\PYG{o}{=}\PYG{l+m}{2}\PYG{+w}{ }/dev/md0
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{raid-systems:frequently-asked-questions}}

\subsubsection{Q: Which RAID level should I choose for my use case?}
\label{\detokenize{raid-systems:q-which-raid-level-should-i-choose-for-my-use-case}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Choose based on your priorities:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Priority              | Recommended RAID
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Maximum Performance  | RAID 0 (no redundancy)
High Availability    | RAID 1 or RAID 10
Balanced Performance | RAID 5
Maximum Protection   | RAID 6
Performance + Safety | RAID 10
\end{sphinxVerbatim}


\subsubsection{Q: Can I convert between RAID levels?}
\label{\detokenize{raid-systems:q-can-i-convert-between-raid-levels}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Yes, but with limitations:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Convert RAID 1 to RAID 5 (requires adding disks first)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdd
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{5}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}

\PYG{c+c1}{\PYGZsh{} Convert RAID 5 to RAID 6}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{6}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/sde

\PYG{c+c1}{\PYGZsh{} Note: Always backup data before conversion!}
\end{sphinxVerbatim}


\subsubsection{Q: How do I recover from a RAID failure?}
\label{\detokenize{raid-systems:q-how-do-i-recover-from-a-raid-failure}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Recovery steps depend on the failure type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For single disk failure in RAID 1/5/6:}
\PYG{c+c1}{\PYGZsh{} 1. Replace failed disk}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Remove failed disk}
\PYG{c+c1}{\PYGZsh{} 2. Add new disk}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} For array corruption:}
\PYG{c+c1}{\PYGZsh{} 1. Stop array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}stop\PYG{+w}{ }/dev/md0
\PYG{c+c1}{\PYGZsh{} 2. Assemble with force}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}assemble\PYG{+w}{ }\PYGZhy{}\PYGZhy{}force\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} For complete array loss:}
\PYG{c+c1}{\PYGZsh{} 1. Try to recreate array with same parameters}
\PYG{c+c1}{\PYGZsh{} 2. Use data recovery tools}
\PYG{c+c1}{\PYGZsh{} 3. Restore from backup}
\end{sphinxVerbatim}


\subsubsection{Q: How do I monitor RAID health automatically?}
\label{\detokenize{raid-systems:q-how-do-i-monitor-raid-health-automatically}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Set up automated monitoring:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Configure mdadm monitoring}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MAILADDR admin@example.com\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/mdadm/mdadm.conf

\PYG{c+c1}{\PYGZsh{} Test email notification}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}monitor\PYG{+w}{ }\PYGZhy{}\PYGZhy{}test\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} Set up continuous monitoring service}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }mdmonitor
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }mdmonitor
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{raid-systems:coding-examples}}

\subsubsection{Python RAID Monitoring Script}
\label{\detokenize{raid-systems:python-raid-monitoring-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{RAID monitoring and management script for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{re}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{smtplib}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{email}\PYG{n+nn}{.}\PYG{n+nn}{mime}\PYG{n+nn}{.}\PYG{n+nn}{text}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{MIMEText}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{datetime}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{datetime}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{RAIDMonitor}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{raid\PYGZus{}devices} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{discover\PYGZus{}raid\PYGZus{}devices}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{discover\PYGZus{}raid\PYGZus{}devices}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Discover all RAID devices on the system\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/proc/mdstat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{n}{devices} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{md}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{device\PYGZus{}name} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
                    \PYG{n}{devices}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

            \PYG{k}{return} \PYG{n}{devices}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error discovering RAID devices: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}raid\PYGZus{}status}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get detailed status of a RAID device\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mdadm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}detail}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{:}
                \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Failed to get status for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}

            \PYG{n}{status} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{\PYGZcb{}}

            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{line} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}

                \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{State :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{state} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{state}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{state}
                    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{clean}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{n}{state}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                        \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RAID Level :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Array Size :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Used Dev Size :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{used\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Active Devices :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{active\PYGZus{}devices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Working Devices :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{working\PYGZus{}devices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Failed Devices :}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{failed} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
                    \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{details}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{failed\PYGZus{}devices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{failed}
                    \PYG{k}{if} \PYG{n}{failed} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
                        \PYG{n}{status}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}

            \PYG{k}{return} \PYG{n}{status}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}disk\PYGZus{}health}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check individual disk health using SMART\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smartctl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PASSED}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{:}
                \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smart\PYGZus{}status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PASSED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}\PYG{p}{\PYGZcb{}}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smart\PYGZus{}status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FAILED}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{False}\PYG{p}{\PYGZcb{}}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}array\PYGZus{}sync}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check if array is currently syncing/rebuilding\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/proc/mdstat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{n}{content} \PYG{o}{=} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}

            \PYG{n}{device\PYGZus{}name} \PYG{o}{=} \PYG{n}{device}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}

            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{content}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{device\PYGZus{}name} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{resync}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line} \PYG{o+ow}{or} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recovery}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line} \PYG{o+ow}{or} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rebuild}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                        \PYG{c+c1}{\PYGZsh{} Extract progress if available}
                        \PYG{n}{progress\PYGZus{}match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{[([\PYGZca{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{]]+)}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{line}\PYG{p}{)}
                        \PYG{k}{if} \PYG{n}{progress\PYGZus{}match}\PYG{p}{:}
                            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syncing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}\PYG{p}{,}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{progress}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{progress\PYGZus{}match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}
                                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}
                            \PYG{p}{\PYGZcb{}}
                        \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syncing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{syncing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{False}\PYG{p}{\PYGZcb{}}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{generate\PYGZus{}report}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Generate comprehensive RAID status report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{datetime}\PYG{o}{.}\PYG{n}{now}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{isoformat}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hostname}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hostname}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{raid\PYGZus{}devices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{overall\PYGZus{}health}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{for} \PYG{n}{device} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{raid\PYGZus{}devices}\PYG{p}{:}
            \PYG{n}{device\PYGZus{}status} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}raid\PYGZus{}status}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}
            \PYG{n}{sync\PYGZus{}status} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}array\PYGZus{}sync}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}

            \PYG{n}{device\PYGZus{}report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{device\PYGZus{}status}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sync}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sync\PYGZus{}status}
            \PYG{p}{\PYGZcb{}}

            \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{device\PYGZus{}status}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{overall\PYGZus{}health}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{k+kc}{False}

            \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{raid\PYGZus{}devices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{device\PYGZus{}report}\PYG{p}{)}

        \PYG{k}{return} \PYG{n}{report}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{send\PYGZus{}alert}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{message}\PYG{p}{,} \PYG{n}{subject}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RAID Alert}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Send email alert (requires SMTP configuration)\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Configure SMTP settings}
            \PYG{n}{smtp\PYGZus{}server} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{localhost}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{n}{smtp\PYGZus{}port} \PYG{o}{=} \PYG{l+m+mi}{587}
            \PYG{n}{from\PYGZus{}email} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{raid\PYGZhy{}monitor@localhost}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{n}{to\PYGZus{}email} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{admin@localhost}\PYG{l+s+s2}{\PYGZdq{}}

            \PYG{n}{msg} \PYG{o}{=} \PYG{n}{MIMEText}\PYG{p}{(}\PYG{n}{message}\PYG{p}{)}
            \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Subject}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{subject}
            \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{From}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{from\PYGZus{}email}
            \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{To}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{to\PYGZus{}email}

            \PYG{n}{server} \PYG{o}{=} \PYG{n}{smtplib}\PYG{o}{.}\PYG{n}{SMTP}\PYG{p}{(}\PYG{n}{smtp\PYGZus{}server}\PYG{p}{,} \PYG{n}{smtp\PYGZus{}port}\PYG{p}{)}
            \PYG{n}{server}\PYG{o}{.}\PYG{n}{send\PYGZus{}message}\PYG{p}{(}\PYG{n}{msg}\PYG{p}{)}
            \PYG{n}{server}\PYG{o}{.}\PYG{n}{quit}\PYG{p}{(}\PYG{p}{)}

            \PYG{k}{return} \PYG{k+kc}{True}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Failed to send alert: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{monitor\PYGZus{}continuous}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{interval}\PYG{o}{=}\PYG{l+m+mi}{300}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Continuous monitoring with specified interval (seconds)\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Starting RAID monitoring (checking every }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{interval}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ seconds)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{k}{while} \PYG{k+kc}{True}\PYG{p}{:}
            \PYG{k}{try}\PYG{p}{:}
                \PYG{n}{report} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}

                \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{overall\PYGZus{}health}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
                    \PYG{n}{alert\PYGZus{}message} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RAID Health Alert \PYGZhy{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hostname}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{n}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{n}\PYG{l+s+s2}{\PYGZdq{}}
                    \PYG{n}{alert\PYGZus{}message} \PYG{o}{+}\PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ALERT: RAID issues detected at }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{send\PYGZus{}alert}\PYG{p}{(}\PYG{n}{alert\PYGZus{}message}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RAID Health Alert}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{else}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{All RAID devices healthy at }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

                \PYG{n}{time}\PYG{o}{.}\PYG{n}{sleep}\PYG{p}{(}\PYG{n}{interval}\PYG{p}{)}

            \PYG{k}{except} \PYG{n+ne}{KeyboardInterrupt}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{nMonitoring stopped by user}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{break}
            \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error during monitoring: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{n}{time}\PYG{o}{.}\PYG{n}{sleep}\PYG{p}{(}\PYG{n}{interval}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Example usage and CLI interface}
\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{argparse}

    \PYG{n}{parser} \PYG{o}{=} \PYG{n}{argparse}\PYG{o}{.}\PYG{n}{ArgumentParser}\PYG{p}{(}\PYG{n}{description}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RAID Monitoring Tool}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}monitor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Start continuous monitoring}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Generate one\PYGZhy{}time report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Check specific device}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}interval}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{type}\PYG{o}{=}\PYG{n+nb}{int}\PYG{p}{,} \PYG{n}{default}\PYG{o}{=}\PYG{l+m+mi}{300}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Monitoring interval in seconds}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{args} \PYG{o}{=} \PYG{n}{parser}\PYG{o}{.}\PYG{n}{parse\PYGZus{}args}\PYG{p}{(}\PYG{p}{)}

    \PYG{n}{monitor} \PYG{o}{=} \PYG{n}{RAIDMonitor}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{args}\PYG{o}{.}\PYG{n}{monitor}\PYG{p}{:}
        \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{monitor\PYGZus{}continuous}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{interval}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{report}\PYG{p}{:}
        \PYG{n}{report} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{device}\PYG{p}{:}
        \PYG{n}{status} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{get\PYGZus{}raid\PYGZus{}status}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{device}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{status}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} Default: show brief status}
        \PYG{k}{for} \PYG{n}{device} \PYG{o+ow}{in} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{raid\PYGZus{}devices}\PYG{p}{:}
            \PYG{n}{status} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{get\PYGZus{}raid\PYGZus{}status}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}
            \PYG{n}{health} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HEALTHY}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{status}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{healthy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{k+kc}{False}\PYG{p}{)} \PYG{k}{else} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UNHEALTHY}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{health}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Bash RAID Management Script}
\label{\detokenize{raid-systems:bash-raid-management-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} raid\PYGZus{}manager.sh \PYGZhy{} Comprehensive RAID management for Ubuntu 22.04}

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{CONFIG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/etc/raid\PYGZus{}manager.conf\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/raid\PYGZus{}manager.log\PYGZdq{}}
\PYG{n+nv}{ALERT\PYGZus{}EMAIL}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}admin@localhost\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Colors for output}
\PYG{n+nv}{RED}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;31m\PYGZsq{}}
\PYG{n+nv}{GREEN}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;32m\PYGZsq{}}
\PYG{n+nv}{YELLOW}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[1;33m\PYGZsq{}}
\PYG{n+nv}{BLUE}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;34m\PYGZsq{}}
\PYG{n+nv}{NC}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0m\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Logging function}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Check if running as root}
check\PYGZus{}root\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}EUID}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{This script must be run as root}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Install required packages}
install\PYGZus{}dependencies\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Installing RAID dependencies...}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }apt\PYG{+w}{ }update
\PYG{+w}{    }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }mdadm\PYG{+w}{ }smartmontools\PYG{+w}{ }parted\PYG{+w}{ }gdisk\PYG{+w}{ }mail\PYGZhy{}utils

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Enable mdadm monitoring}
\PYG{+w}{    }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }mdmonitor
\PYG{+w}{    }systemctl\PYG{+w}{ }start\PYG{+w}{ }mdmonitor

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RAID dependencies installed\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Discover RAID devices}
discover\PYGZus{}raids\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Discovered RAID Devices ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/proc/mdstat\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }cat\PYG{+w}{ }/proc/mdstat
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} List detailed information for each device}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/md*\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Details for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}20
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{done}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}No RAID devices found\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Create RAID array}
create\PYGZus{}raid\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{level}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{devices}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{array\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}devices}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: create\PYGZus{}raid \PYGZlt{}level\PYGZgt{} \PYGZlt{}device1,device2,...\PYGZgt{} [array\PYGZus{}name]\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Example: create\PYGZus{}raid 1 /dev/sdb,/dev/sdc myraid\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device\PYGZus{}array}\PYG{o}{=}\PYG{o}{(}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{devices}\PYG{p}{//,/ }\PYG{l+s+si}{\PYGZcb{}}\PYG{o}{)}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device\PYGZus{}count}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}\PYGZsh{}}\PYG{n+nv}{device\PYGZus{}array}\PYG{p}{[@]}\PYG{l+s+si}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{raid\PYGZus{}device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/dev/md}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{array\PYGZus{}name}\PYG{k}{:\PYGZhy{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}s\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Creating RAID }\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+s2}{ with }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{l+s+s2}{ devices}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Validate RAID level and device count}
\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{+w}{ }\PYGZhy{}lt\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID 0 requires at least 2 devices}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}1\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{+w}{ }\PYGZhy{}lt\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID 1 requires at least 2 devices}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}5\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{+w}{ }\PYGZhy{}lt\PYG{+w}{ }\PYG{l+m}{3}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID 5 requires at least 3 devices}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}6\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{+w}{ }\PYGZhy{}lt\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID 6 requires at least 4 devices}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}10\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{+w}{ }\PYGZhy{}lt\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{k}{\PYGZdl{}((}\PYG{n+nv}{device\PYGZus{}count}\PYG{+w}{ }\PYG{o}{\PYGZpc{}}\PYG{+w}{ }\PYG{l+m}{2}\PYG{k}{))}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID 10 requires at least 4 devices (even number)}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Unsupported RAID level: }\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Prepare devices}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Preparing devices...\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{device\PYGZus{}array}\PYG{p}{[@]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Wiping }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }wipefs\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Zero superblock if exists}
\PYG{+w}{        }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}zero\PYGZhy{}superblock\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null
\PYG{+w}{    }\PYG{k}{done}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create RAID array}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Creating RAID array...\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }\PYGZhy{}\PYGZhy{}verbose\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}raid\PYGZus{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{        }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{        }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device\PYGZus{}count}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{device\PYGZus{}array}\PYG{p}{[@]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{RAID array created successfully: }\PYG{n+nv}{\PYGZdl{}raid\PYGZus{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Save configuration}
\PYG{+w}{        }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYGZhy{}\PYGZhy{}scan\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/mdadm/mdadm.conf
\PYG{+w}{        }update\PYGZhy{}initramfs\PYG{+w}{ }\PYGZhy{}u

\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Created RAID }\PYG{n+nv}{\PYGZdl{}level}\PYG{l+s+s2}{ array }\PYG{n+nv}{\PYGZdl{}raid\PYGZus{}device}\PYG{l+s+s2}{ with devices: }\PYG{n+nv}{\PYGZdl{}devices}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Wait for array to synchronize}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Waiting for initial synchronization...\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{while}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}resync\PYGZdq{}}\PYG{+w}{ }/proc/mdstat\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}.\PYGZdq{}}
\PYG{+w}{            }sleep\PYG{+w}{ }\PYG{l+m}{5}
\PYG{+w}{        }\PYG{k}{done}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Initial synchronization complete}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to create RAID array}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Monitor RAID health}
monitor\PYGZus{}raid\PYGZus{}health\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== RAID Health Monitor ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{unhealthy\PYGZus{}found}\PYG{o}{=}\PYG{n+nb}{false}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check each RAID device}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/md*\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Checking }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{...}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Get RAID status}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{status}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}State :\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}clean\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: Healthy (}\PYG{n+nv}{\PYGZdl{}status}\PYG{l+s+s2}{)}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: Unhealthy (}\PYG{n+nv}{\PYGZdl{}status}\PYG{l+s+s2}{)}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{n+nv}{unhealthy\PYGZus{}found}\PYG{o}{=}\PYG{n+nb}{true}

\PYG{+w}{                }\PYG{c+c1}{\PYGZsh{} Get detailed information}
\PYG{+w}{                }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Check for rebuild/resync}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device}\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }/proc/mdstat\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{sync\PYGZus{}info}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}basename\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}device}\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }/proc/mdstat\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(resync|rebuild|recovery)\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{                }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}sync\PYGZus{}info}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: }\PYG{n+nv}{\PYGZdl{}sync\PYGZus{}info}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{fi}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check individual disk health}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== Individual Disk Health ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{smart\PYGZus{}status}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SMART overall\PYGZhy{}health\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}6\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}smart\PYGZus{}status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}PASSED\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: SMART PASSED}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{elif}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}smart\PYGZus{}status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}FAILED\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: SMART FAILED}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }\PYG{n+nv}{unhealthy\PYGZus{}found}\PYG{o}{=}\PYG{n+nb}{true}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Send alert if issues found}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}unhealthy\PYGZus{}found}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}true\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RAID health issues detected\PYGZdq{}}
\PYG{+w}{        }send\PYGZus{}alert\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RAID health issues detected on }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Manage RAID device}
manage\PYGZus{}raid\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{action}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{target}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}action}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}add\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: manage\PYGZus{}raid add \PYGZlt{}raid\PYGZus{}device\PYGZgt{} \PYGZlt{}new\PYGZus{}disk\PYGZgt{}\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Adding }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Disk added successfully}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Added disk }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to add disk}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}remove\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: manage\PYGZus{}raid remove \PYGZlt{}raid\PYGZus{}device\PYGZgt{} \PYGZlt{}disk\PYGZgt{}\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Removing }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ from }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Disk removed successfully}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Removed disk }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ from }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to remove disk}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}fail\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: manage\PYGZus{}raid fail \PYGZlt{}raid\PYGZus{}device\PYGZgt{} \PYGZlt{}disk\PYGZgt{}\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Marking }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ as failed in }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}fail\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Disk marked as failed}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Marked disk }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ as failed in }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to mark disk as failed}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}replace\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: manage\PYGZus{}raid replace \PYGZlt{}raid\PYGZus{}device\PYGZgt{} \PYGZlt{}old\PYGZus{}disk\PYGZgt{} \PYGZlt{}new\PYGZus{}disk\PYGZgt{}\PYGZdq{}}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Note: old\PYGZus{}disk should be failed first\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{new\PYGZus{}disk}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}4}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}new\PYGZus{}disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}New disk not specified\PYGZdq{}}
\PYG{+w}{                }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Replacing }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ with }\PYG{n+nv}{\PYGZdl{}new\PYGZus{}disk}\PYG{l+s+s2}{ in }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Remove failed disk}
\PYG{+w}{            }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Add new disk}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}new\PYGZus{}disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Disk replacement initiated}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Replaced disk }\PYG{n+nv}{\PYGZdl{}target}\PYG{l+s+s2}{ with }\PYG{n+nv}{\PYGZdl{}new\PYGZus{}disk}\PYG{l+s+s2}{ in }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{Failed to add replacement disk}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }*\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Available actions: add, remove, fail, replace\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Send email alert}
send\PYGZus{}alert\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{message}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }mail\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}message}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RAID Alert \PYGZhy{} }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}ALERT\PYGZus{}EMAIL}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Alert sent: }\PYG{n+nv}{\PYGZdl{}message}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Alert (mail not configured): }\PYG{n+nv}{\PYGZdl{}message}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Performance test}
test\PYGZus{}raid\PYGZus{}performance\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{test\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}z\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Usage: test\PYGZus{}raid\PYGZus{}performance \PYGZlt{}device\PYGZgt{} [test\PYGZus{}file]\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{mount\PYGZus{}point}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/mnt/raid\PYGZus{}test\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{test\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{test\PYGZus{}file}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}point}\PYG{p}{/test\PYGZus{}file}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BLUE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{=== RAID Performance Test ===}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Mount if not already mounted}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }mountpoint\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}point}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}point}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }mount\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}point}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Testing write performance...\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{write\PYGZus{}speed}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/zero\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}test\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{n+nv}{count}\PYG{o}{=}\PYG{l+m}{1024}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}\PYG{p}{\PYGZam{}}\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MB/s\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}(NF\PYGZhy{}1) \PYGZdq{} \PYGZdq{} \PYGZdl{}NF\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Write speed: }\PYG{n+nv}{\PYGZdl{}write\PYGZus{}speed}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Testing read performance...\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{read\PYGZus{}speed}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}test\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/dev/null\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}\PYG{p}{\PYGZam{}}\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MB/s\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}(NF\PYGZhy{}1) \PYGZdq{} \PYGZdq{} \PYGZdl{}NF\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Read speed: }\PYG{n+nv}{\PYGZdl{}read\PYGZus{}speed}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Cleanup}
\PYG{+w}{    }rm\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}test\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Performance test for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ \PYGZhy{} Write: }\PYG{n+nv}{\PYGZdl{}write\PYGZus{}speed}\PYG{l+s+s2}{, Read: }\PYG{n+nv}{\PYGZdl{}read\PYGZus{}speed}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main menu}
\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{help}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}install\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }install\PYGZus{}dependencies
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}discover\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }discover\PYGZus{}raids
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}create\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }create\PYGZus{}raid\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}4}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}monitor\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }monitor\PYGZus{}raid\PYGZus{}health
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}manage\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}root
\PYG{+w}{        }manage\PYGZus{}raid\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}4}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}5}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}performance\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }test\PYGZus{}raid\PYGZus{}performance\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}help\PYGZdq{}}\PYG{p}{|}*\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RAID Manager for Ubuntu 22.04\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [command] [options]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Commands:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  install                           \PYGZhy{} Install RAID dependencies\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  discover                          \PYGZhy{} Discover existing RAID devices\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  create \PYGZlt{}level\PYGZgt{} \PYGZlt{}devices\PYGZgt{} [name]   \PYGZhy{} Create new RAID array\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  monitor                           \PYGZhy{} Check RAID health\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  manage \PYGZlt{}action\PYGZgt{} \PYGZlt{}device\PYGZgt{} \PYGZlt{}disk\PYGZgt{}   \PYGZhy{} Manage RAID devices\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  performance \PYGZlt{}device\PYGZgt{} [file]       \PYGZhy{} Test RAID performance\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RAID Levels: 0, 1, 5, 6, 10\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Manage Actions: add, remove, fail, replace\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Examples:\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ create 1 /dev/sdb,/dev/sdc mirror1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ create 5 /dev/sdb,/dev/sdc,/dev/sdd stripe1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ manage add /dev/md0 /dev/sde}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ manage replace /dev/md0 /dev/sdb /dev/sdf}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ performance /dev/md0}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{k}{esac}
\end{sphinxVerbatim}


\subsection{Best Practices for RAID Implementation}
\label{\detokenize{raid-systems:best-practices-for-raid-implementation}}

\subsubsection{Planning and Design}
\label{\detokenize{raid-systems:planning-and-design}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Capacity Planning}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Calculate usable capacity for each RAID level

\item {} 
\sphinxAtStartPar
Plan for future expansion

\item {} 
\sphinxAtStartPar
Consider spare drives for automatic rebuilds

\item {} 
\sphinxAtStartPar
Account for rebuild times

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance Considerations}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Match disk speeds and sizes

\item {} 
\sphinxAtStartPar
Use appropriate chunk sizes for workload

\item {} 
\sphinxAtStartPar
Consider I/O patterns

\item {} 
\sphinxAtStartPar
Plan for concurrent operations

\end{itemize}

\end{enumerate}


\subsubsection{Hardware Considerations}
\label{\detokenize{raid-systems:hardware-considerations}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Disk Selection}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check disk specifications}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sdb\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Model|Serial|Capacity)\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Verify disks are identical}
\PYG{k}{for}\PYG{+w}{ }disk\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}b\PYGZhy{}d\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=== }\PYG{n+nv}{\PYGZdl{}disk}\PYG{l+s+s2}{ ===}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}disk}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Device Model|Serial Number|User Capacity)\PYGZdq{}}
\PYG{k}{done}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Controller Considerations}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Hardware RAID vs Software RAID

\item {} 
\sphinxAtStartPar
Battery\sphinxhyphen{}backed write cache

\item {} 
\sphinxAtStartPar
Multiple controller support

\item {} 
\sphinxAtStartPar
Hot\sphinxhyphen{}swap capability

\end{itemize}

\end{enumerate}


\subsubsection{Monitoring and Maintenance}
\label{\detokenize{raid-systems:monitoring-and-maintenance}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Automated Monitoring}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up email notifications}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MAILADDR admin@example.com\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/mdadm/mdadm.conf

\PYG{c+c1}{\PYGZsh{} Configure monitoring daemon}
systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }mdmonitor

\PYG{c+c1}{\PYGZsh{} Test notifications}
mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}monitor\PYG{+w}{ }\PYGZhy{}\PYGZhy{}test\PYG{+w}{ }/dev/md0
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Regular Maintenance}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Schedule regular RAID checks}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 1 1 * * root echo check \PYGZgt{} /sys/block/md0/md/sync\PYGZus{}action\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/crontab

\PYG{c+c1}{\PYGZsh{} Monitor rebuild progress}
watch\PYG{+w}{ }cat\PYG{+w}{ }/proc/mdstat

\PYG{c+c1}{\PYGZsh{} Check SMART status regularly}
\PYG{k}{for}\PYG{+w}{ }disk\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}disk}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Health|Temperature|Error)\PYGZdq{}}
\PYG{k}{done}
\end{sphinxVerbatim}

\end{enumerate}


\subsubsection{Recovery and Disaster Planning}
\label{\detokenize{raid-systems:recovery-and-disaster-planning}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Backup Strategy}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
RAID is not a backup solution

\item {} 
\sphinxAtStartPar
Implement 3\sphinxhyphen{}2\sphinxhyphen{}1 backup rule

\item {} 
\sphinxAtStartPar
Test restoration procedures

\item {} 
\sphinxAtStartPar
Document recovery processes

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Disaster Recovery}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Save RAID configuration}
mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }\PYGZhy{}\PYGZhy{}scan\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/mdadm/mdadm.conf.backup

\PYG{c+c1}{\PYGZsh{} Create recovery documentation}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/root/raid\PYGZus{}recovery.txt\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{RAID Recovery Procedures:}

\PYG{l+s}{1. Boot from rescue media}
\PYG{l+s}{2. Install mdadm: apt install mdadm}
\PYG{l+s}{3. Scan for arrays: mdadm \PYGZhy{}\PYGZhy{}assemble \PYGZhy{}\PYGZhy{}scan}
\PYG{l+s}{4. Force assembly if needed: mdadm \PYGZhy{}\PYGZhy{}assemble \PYGZhy{}\PYGZhy{}force /dev/md0 /dev/sdb /dev/sdc}
\PYG{l+s}{5. Mount and check data}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}

\end{enumerate}

\sphinxstepscope


\chapter{Network Storage}
\label{\detokenize{network-storage:network-storage}}\label{\detokenize{network-storage::doc}}

\section{Understanding Network Storage}
\label{\detokenize{network-storage:understanding-network-storage}}
\sphinxAtStartPar
Network storage allows multiple systems to access shared storage resources over a network. This technology is essential for modern IT environments, enabling centralized data management, improved collaboration, and efficient resource utilization.


\subsection{Types of Network Storage}
\label{\detokenize{network-storage:types-of-network-storage}}

\subsubsection{Network Attached Storage (NAS)}
\label{\detokenize{network-storage:network-attached-storage-nas}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* File\sphinxhyphen{}level storage access
* Uses standard network protocols (NFS, SMB/CIFS, FTP)
* Easy to deploy and manage
* Suitable for file sharing and collaboration

\sphinxAtStartPar
\sphinxstylestrong{Common Protocols:}
* \sphinxstylestrong{NFS (Network File System)}: Unix/Linux native protocol
* \sphinxstylestrong{SMB/CIFS}: Windows native, also supported by Linux
* \sphinxstylestrong{FTP/SFTP}: File transfer protocols
* \sphinxstylestrong{HTTP/WebDAV}: Web\sphinxhyphen{}based file access


\subsubsection{Storage Area Network (SAN)}
\label{\detokenize{network-storage:storage-area-network-san}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Block\sphinxhyphen{}level storage access
* High\sphinxhyphen{}performance dedicated network
* Uses specialized protocols (iSCSI, Fibre Channel)
* Enterprise\sphinxhyphen{}level performance and reliability

\sphinxAtStartPar
\sphinxstylestrong{Common Protocols:}
* \sphinxstylestrong{iSCSI}: SCSI over IP networks
* \sphinxstylestrong{Fibre Channel}: High\sphinxhyphen{}speed dedicated network
* \sphinxstylestrong{FCoE}: Fibre Channel over Ethernet
* \sphinxstylestrong{InfiniBand}: High\sphinxhyphen{}performance computing networks


\subsubsection{Cloud Storage}
\label{\detokenize{network-storage:cloud-storage}}
\sphinxAtStartPar
\sphinxstylestrong{Characteristics:}
* Storage as a Service (STaaS)
* Scalable and elastic
* Geographic distribution
* Pay\sphinxhyphen{}per\sphinxhyphen{}use model

\sphinxAtStartPar
\sphinxstylestrong{Common Services:}
* \sphinxstylestrong{Object Storage}: Amazon S3, Google Cloud Storage, Azure Blob
* \sphinxstylestrong{File Storage}: Amazon EFS, Google Filestore, Azure Files
* \sphinxstylestrong{Block Storage}: Amazon EBS, Google Persistent Disk, Azure Disk


\subsection{Setting Up NFS on Ubuntu 22.04}
\label{\detokenize{network-storage:setting-up-nfs-on-ubuntu-22-04}}

\subsubsection{NFS Server Configuration}
\label{\detokenize{network-storage:nfs-server-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install NFS server}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }nfs\PYGZhy{}kernel\PYGZhy{}server

\PYG{c+c1}{\PYGZsh{} Create shared directories}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/nfs/shared
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/nfs/public
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/nfs/private

\PYG{c+c1}{\PYGZsh{} Set permissions}
sudo\PYG{+w}{ }chown\PYG{+w}{ }nobody:nogroup\PYG{+w}{ }/srv/nfs/shared
sudo\PYG{+w}{ }chown\PYG{+w}{ }nobody:nogroup\PYG{+w}{ }/srv/nfs/public
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{755}\PYG{+w}{ }/srv/nfs/shared
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{755}\PYG{+w}{ }/srv/nfs/public

\PYG{c+c1}{\PYGZsh{} Configure exports}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/exports

\PYG{c+c1}{\PYGZsh{} Add export configurations}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/exports\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} NFS exports configuration}
\PYG{l+s}{/srv/nfs/shared    192.168.1.0/24(rw,sync,no\PYGZus{}subtree\PYGZus{}check)}
\PYG{l+s}{/srv/nfs/public    *(ro,sync,no\PYGZus{}subtree\PYGZus{}check)}
\PYG{l+s}{/srv/nfs/private   192.168.1.100(rw,sync,no\PYGZus{}subtree\PYGZus{}check,no\PYGZus{}root\PYGZus{}squash)}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Export the shares}
sudo\PYG{+w}{ }exportfs\PYG{+w}{ }\PYGZhy{}a

\PYG{c+c1}{\PYGZsh{} Restart NFS service}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }nfs\PYGZhy{}kernel\PYGZhy{}server
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }nfs\PYGZhy{}kernel\PYGZhy{}server

\PYG{c+c1}{\PYGZsh{} Check NFS status}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }status\PYG{+w}{ }nfs\PYGZhy{}kernel\PYGZhy{}server
sudo\PYG{+w}{ }exportfs\PYG{+w}{ }\PYGZhy{}v
\end{sphinxVerbatim}


\subsubsection{NFS Client Configuration}
\label{\detokenize{network-storage:nfs-client-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install NFS client}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }nfs\PYGZhy{}common

\PYG{c+c1}{\PYGZsh{} Create mount points}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/mnt/nfs/shared
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/mnt/nfs/public

\PYG{c+c1}{\PYGZsh{} Test NFS connectivity}
showmount\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+m}{192}.168.1.10

\PYG{c+c1}{\PYGZsh{} Mount NFS shares}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }nfs\PYG{+w}{ }\PYG{l+m}{192}.168.1.10:/srv/nfs/shared\PYG{+w}{ }/mnt/nfs/shared
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }nfs\PYG{+w}{ }\PYG{l+m}{192}.168.1.10:/srv/nfs/public\PYG{+w}{ }/mnt/nfs/public

\PYG{c+c1}{\PYGZsh{} Verify mounts}
df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }nfs

\PYG{c+c1}{\PYGZsh{} Add to fstab for persistent mounting}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/fstab\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} NFS mounts}
\PYG{l+s}{192.168.1.10:/srv/nfs/shared  /mnt/nfs/shared  nfs  defaults,\PYGZus{}netdev  0  0}
\PYG{l+s}{192.168.1.10:/srv/nfs/public  /mnt/nfs/public  nfs  ro,defaults,\PYGZus{}netdev  0  0}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Test fstab entries}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/nfs/shared
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}a
\end{sphinxVerbatim}


\subsection{Setting Up Samba (SMB/CIFS) on Ubuntu 22.04}
\label{\detokenize{network-storage:setting-up-samba-smb-cifs-on-ubuntu-22-04}}

\subsubsection{Samba Server Configuration}
\label{\detokenize{network-storage:samba-server-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install Samba}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }samba\PYG{+w}{ }samba\PYGZhy{}common\PYGZhy{}bin

\PYG{c+c1}{\PYGZsh{} Create shared directories}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/samba/shared
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/samba/public
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/samba/users

\PYG{c+c1}{\PYGZsh{} Set permissions}
sudo\PYG{+w}{ }chown\PYG{+w}{ }root:sambashare\PYG{+w}{ }/srv/samba/shared
sudo\PYG{+w}{ }chown\PYG{+w}{ }root:sambashare\PYG{+w}{ }/srv/samba/public
sudo\PYG{+w}{ }chown\PYG{+w}{ }root:sambashare\PYG{+w}{ }/srv/samba/users
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{2775}\PYG{+w}{ }/srv/samba/shared
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{2775}\PYG{+w}{ }/srv/samba/public
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{2775}\PYG{+w}{ }/srv/samba/users

\PYG{c+c1}{\PYGZsh{} Backup original configuration}
sudo\PYG{+w}{ }cp\PYG{+w}{ }/etc/samba/smb.conf\PYG{+w}{ }/etc/samba/smb.conf.backup

\PYG{c+c1}{\PYGZsh{} Configure Samba}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/samba/smb.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}

\PYG{l+s}{[shared]}
\PYG{l+s}{    comment = Shared Files}
\PYG{l+s}{    path = /srv/samba/shared}
\PYG{l+s}{    browseable = yes}
\PYG{l+s}{    writable = yes}
\PYG{l+s}{    guest ok = no}
\PYG{l+s}{    valid users = @sambashare}
\PYG{l+s}{    create mask = 0664}
\PYG{l+s}{    directory mask = 2775}

\PYG{l+s}{[public]}
\PYG{l+s}{    comment = Public Files}
\PYG{l+s}{    path = /srv/samba/public}
\PYG{l+s}{    browseable = yes}
\PYG{l+s}{    writable = yes}
\PYG{l+s}{    guest ok = yes}
\PYG{l+s}{    read only = no}
\PYG{l+s}{    create mask = 0755}

\PYG{l+s}{[users]}
\PYG{l+s}{    comment = User Directories}
\PYG{l+s}{    path = /srv/samba/users/\PYGZpc{}S}
\PYG{l+s}{    browseable = no}
\PYG{l+s}{    writable = yes}
\PYG{l+s}{    valid users = \PYGZpc{}S}
\PYG{l+s}{    create mask = 0644}
\PYG{l+s}{    directory mask = 0755}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Create Samba user}
sudo\PYG{+w}{ }useradd\PYG{+w}{ }\PYGZhy{}M\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }/usr/sbin/nologin\PYG{+w}{ }sambauser
sudo\PYG{+w}{ }usermod\PYG{+w}{ }\PYGZhy{}aG\PYG{+w}{ }sambashare\PYG{+w}{ }sambauser
sudo\PYG{+w}{ }smbpasswd\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }sambauser

\PYG{c+c1}{\PYGZsh{} Restart Samba services}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }smbd\PYG{+w}{ }nmbd
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }smbd\PYG{+w}{ }nmbd

\PYG{c+c1}{\PYGZsh{} Check Samba status}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }status\PYG{+w}{ }smbd
testparm
\end{sphinxVerbatim}


\subsubsection{Samba Client Configuration}
\label{\detokenize{network-storage:samba-client-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install CIFS utilities}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }cifs\PYGZhy{}utils

\PYG{c+c1}{\PYGZsh{} Create mount points}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/mnt/samba/shared
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/mnt/samba/public

\PYG{c+c1}{\PYGZsh{} Mount Samba shares}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }cifs\PYG{+w}{ }//192.168.1.10/shared\PYG{+w}{ }/mnt/samba/shared\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{username}\PYG{o}{=}sambauser

\PYG{c+c1}{\PYGZsh{} Create credentials file for automatic mounting}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/.smbcredentials\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{username=sambauser}
\PYG{l+s}{password=your\PYGZus{}password}
\PYG{l+s}{domain=workgroup}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }\PYG{l+m}{600}\PYG{+w}{ }\PYGZti{}/.smbcredentials

\PYG{c+c1}{\PYGZsh{} Add to fstab}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/fstab\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} Samba mounts}
\PYG{l+s}{//192.168.1.10/shared  /mnt/samba/shared  cifs  credentials=/home/username/.smbcredentials,uid=1000,gid=1000,\PYGZus{}netdev  0  0}
\PYG{l+s}{//192.168.1.10/public  /mnt/samba/public  cifs  guest,uid=1000,gid=1000,\PYGZus{}netdev  0  0}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\subsection{Setting Up iSCSI on Ubuntu 22.04}
\label{\detokenize{network-storage:setting-up-iscsi-on-ubuntu-22-04}}

\subsubsection{iSCSI Target Server Configuration}
\label{\detokenize{network-storage:iscsi-target-server-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install iSCSI target}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }tgt

\PYG{c+c1}{\PYGZsh{} Create storage backing file}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/srv/iscsi
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/zero\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/srv/iscsi/disk1.img\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{n+nv}{count}\PYG{o}{=}\PYG{l+m}{10240}

\PYG{c+c1}{\PYGZsh{} Configure iSCSI target}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/tgt/conf.d/iscsi\PYGZhy{}target.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} iSCSI Target Configuration}
\PYG{l+s}{\PYGZlt{}target iqn.2024\PYGZhy{}01.com.example:storage.disk1\PYGZgt{}}
\PYG{l+s}{    backing\PYGZhy{}store /srv/iscsi/disk1.img}
\PYG{l+s}{    \PYGZsh{} Allow access from specific initiators}
\PYG{l+s}{    initiator\PYGZhy{}address 192.168.1.0/24}
\PYG{l+s}{    \PYGZsh{} Authentication (optional)}
\PYG{l+s}{    incominguser username password}
\PYG{l+s}{\PYGZlt{}/target\PYGZgt{}}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Restart target service}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }tgt
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }tgt

\PYG{c+c1}{\PYGZsh{} Check target status}
sudo\PYG{+w}{ }tgtadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}mode\PYG{+w}{ }target\PYG{+w}{ }\PYGZhy{}\PYGZhy{}op\PYG{+w}{ }show
\end{sphinxVerbatim}


\subsubsection{iSCSI Initiator Configuration}
\label{\detokenize{network-storage:iscsi-initiator-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install iSCSI initiator}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }open\PYGZhy{}iscsi

\PYG{c+c1}{\PYGZsh{} Configure initiator name}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/iscsi/initiatorname.iscsi
\PYG{c+c1}{\PYGZsh{} Set: InitiatorName=iqn.2024\PYGZhy{}01.com.example:client1}

\PYG{c+c1}{\PYGZsh{} Configure CHAP authentication (if required)}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/iscsi/iscsid.conf
\PYG{c+c1}{\PYGZsh{} Uncomment and set:}
\PYG{c+c1}{\PYGZsh{} node.session.auth.authmethod = CHAP}
\PYG{c+c1}{\PYGZsh{} node.session.auth.username = username}
\PYG{c+c1}{\PYGZsh{} node.session.auth.password = password}

\PYG{c+c1}{\PYGZsh{} Discover targets}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }discovery\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }sendtargets\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+m}{192}.168.1.10

\PYG{c+c1}{\PYGZsh{} Login to target}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }node\PYG{+w}{ }\PYGZhy{}\PYGZhy{}login

\PYG{c+c1}{\PYGZsh{} Check connected sessions}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }session

\PYG{c+c1}{\PYGZsh{} Format and mount iSCSI disk}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sdb\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Create partition}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/iscsi
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/iscsi
\end{sphinxVerbatim}


\subsection{Cloud Storage Integration}
\label{\detokenize{network-storage:cloud-storage-integration}}

\subsubsection{Rclone Configuration}
\label{\detokenize{network-storage:rclone-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install rclone}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }rclone

\PYG{c+c1}{\PYGZsh{} Configure cloud storage}
rclone\PYG{+w}{ }config

\PYG{c+c1}{\PYGZsh{} Example: Mount Google Drive}
mkdir\PYG{+w}{ }\PYGZti{}/GoogleDrive
rclone\PYG{+w}{ }mount\PYG{+w}{ }gdrive:\PYG{+w}{ }\PYGZti{}/GoogleDrive\PYG{+w}{ }\PYGZhy{}\PYGZhy{}daemon

\PYG{c+c1}{\PYGZsh{} Example: Sync to cloud storage}
rclone\PYG{+w}{ }sync\PYG{+w}{ }/home/user/Documents\PYG{+w}{ }gdrive:Documents

\PYG{c+c1}{\PYGZsh{} Create systemd service for persistent mounting}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/.config/systemd/user/rclone\PYGZhy{}gdrive.service\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{[Unit]}
\PYG{l+s}{Description=Google Drive mount}
\PYG{l+s}{After=network.target}

\PYG{l+s}{[Service]}
\PYG{l+s}{Type=notify}
\PYG{l+s}{ExecStart=/usr/bin/rclone mount gdrive: \PYGZpc{}h/GoogleDrive \PYGZhy{}\PYGZhy{}vfs\PYGZhy{}cache\PYGZhy{}mode writes}
\PYG{l+s}{ExecStop=/bin/fusermount \PYGZhy{}u \PYGZpc{}h/GoogleDrive}
\PYG{l+s}{Restart=always}
\PYG{l+s}{RestartSec=10}

\PYG{l+s}{[Install]}
\PYG{l+s}{WantedBy=default.target}
\PYG{l+s}{EOF}

systemctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }rclone\PYGZhy{}gdrive.service
systemctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYG{+w}{ }start\PYG{+w}{ }rclone\PYGZhy{}gdrive.service
\end{sphinxVerbatim}


\subsubsection{S3\sphinxhyphen{}Compatible Storage}
\label{\detokenize{network-storage:s3-compatible-storage}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install s3fs}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }s3fs

\PYG{c+c1}{\PYGZsh{} Create credentials file}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}access\PYGZus{}key:secret\PYGZus{}key\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/.passwd\PYGZhy{}s3fs
chmod\PYG{+w}{ }\PYG{l+m}{600}\PYG{+w}{ }\PYGZti{}/.passwd\PYGZhy{}s3fs

\PYG{c+c1}{\PYGZsh{} Mount S3 bucket}
mkdir\PYG{+w}{ }\PYGZti{}/s3bucket
s3fs\PYG{+w}{ }mybucket\PYG{+w}{ }\PYGZti{}/s3bucket\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{passwd\PYGZus{}file}\PYG{o}{=}\PYGZti{}/.passwd\PYGZhy{}s3fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{url}\PYG{o}{=}https://s3.amazonaws.com

\PYG{c+c1}{\PYGZsh{} Add to fstab for persistent mounting}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}s3fs\PYGZsh{}mybucket /home/user/s3bucket fuse \PYGZus{}netdev,passwd\PYGZus{}file=/home/user/.passwd\PYGZhy{}s3fs,url=https://s3.amazonaws.com 0 0\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/fstab
\end{sphinxVerbatim}


\subsection{Network Storage Performance Optimization}
\label{\detokenize{network-storage:network-storage-performance-optimization}}

\subsubsection{NFS Performance Tuning}
\label{\detokenize{network-storage:nfs-performance-tuning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Optimize NFS mount options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }nfs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{rsize}\PYG{o}{=}\PYG{l+m}{32768},wsize\PYG{o}{=}\PYG{l+m}{32768},hard,intr,tcp\PYG{+w}{ }\PYG{l+m}{192}.168.1.10:/srv/nfs/shared\PYG{+w}{ }/mnt/nfs/shared

\PYG{c+c1}{\PYGZsh{} Configure NFS daemon threads}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/default/nfs\PYGZhy{}kernel\PYGZhy{}server
\PYG{c+c1}{\PYGZsh{} Set: RPCNFSDCOUNT=16}

\PYG{c+c1}{\PYGZsh{} Optimize network buffer sizes}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}net.core.rmem\PYGZus{}max = 16777216\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/sysctl.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}net.core.wmem\PYGZus{}max = 16777216\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/sysctl.conf
sudo\PYG{+w}{ }sysctl\PYG{+w}{ }\PYGZhy{}p
\end{sphinxVerbatim}


\subsubsection{Samba Performance Tuning}
\label{\detokenize{network-storage:samba-performance-tuning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Add performance options to smb.conf}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/samba/smb.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{[global]}
\PYG{l+s}{    \PYGZsh{} Performance tuning}
\PYG{l+s}{    socket options = TCP\PYGZus{}NODELAY IPTOS\PYGZus{}LOWDELAY SO\PYGZus{}RCVBUF=65536 SO\PYGZus{}SNDBUF=65536}
\PYG{l+s}{    read raw = yes}
\PYG{l+s}{    write raw = yes}
\PYG{l+s}{    max xmit = 65535}
\PYG{l+s}{    dead time = 15}
\PYG{l+s}{    getwd cache = yes}
\PYG{l+s}{EOF}

sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }smbd
\end{sphinxVerbatim}


\subsubsection{iSCSI Performance Tuning}
\label{\detokenize{network-storage:iscsi-performance-tuning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Optimize iSCSI parameters}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}node.session.iscsi.InitialR2T = No\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/iscsi/iscsid.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}node.session.iscsi.ImmediateData = Yes\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/iscsi/iscsid.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}node.session.iscsi.FirstBurstLength = 262144\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/iscsi/iscsid.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}node.session.iscsi.MaxBurstLength = 16776192\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/iscsi/iscsid.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}node.conn[0].iscsi.MaxRecvDataSegmentLength = 262144\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/iscsi/iscsid.conf

sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }iscsid
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{network-storage:frequently-asked-questions}}

\subsubsection{Q: Which network storage protocol should I choose?}
\label{\detokenize{network-storage:q-which-network-storage-protocol-should-i-choose}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Choose based on your requirements:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Use Case                    | Recommended Protocol | Reason
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Linux\PYGZhy{}only environment     | NFS                 | Native performance
Mixed OS environment       | SMB/CIFS            | Universal compatibility
High\PYGZhy{}performance storage    | iSCSI               | Block\PYGZhy{}level access
Simple file sharing         | FTP/SFTP            | Easy setup
Cloud storage              | Object storage APIs  | Scalability
Database storage           | iSCSI or FC         | Low latency
\end{sphinxVerbatim}


\subsubsection{Q: How do I troubleshoot NFS connection issues?}
\label{\detokenize{network-storage:q-how-do-i-troubleshoot-nfs-connection-issues}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Follow these troubleshooting steps:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check NFS service status}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }status\PYG{+w}{ }nfs\PYGZhy{}kernel\PYGZhy{}server

\PYG{c+c1}{\PYGZsh{} Check exports}
sudo\PYG{+w}{ }exportfs\PYG{+w}{ }\PYGZhy{}v

\PYG{c+c1}{\PYGZsh{} Test connectivity}
telnet\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip\PYG{+w}{ }\PYG{l+m}{2049}

\PYG{c+c1}{\PYGZsh{} Check firewall}
sudo\PYG{+w}{ }ufw\PYG{+w}{ }status
\PYG{c+c1}{\PYGZsh{} Open NFS ports if needed}
sudo\PYG{+w}{ }ufw\PYG{+w}{ }allow\PYG{+w}{ }from\PYG{+w}{ }\PYG{l+m}{192}.168.1.0/24\PYG{+w}{ }to\PYG{+w}{ }any\PYG{+w}{ }port\PYG{+w}{ }\PYG{l+m}{2049}

\PYG{c+c1}{\PYGZsh{} Check mount on client}
showmount\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip

\PYG{c+c1}{\PYGZsh{} Debug mount issues}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }nfs\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip:/path\PYG{+w}{ }/mnt/point
\end{sphinxVerbatim}


\subsubsection{Q: How can I secure network storage?}
\label{\detokenize{network-storage:q-how-can-i-secure-network-storage}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Implement these security measures:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Use VPN for remote access}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }openvpn

\PYG{c+c1}{\PYGZsh{} 2. Enable firewall}
sudo\PYG{+w}{ }ufw\PYG{+w}{ }\PYG{n+nb}{enable}
sudo\PYG{+w}{ }ufw\PYG{+w}{ }allow\PYG{+w}{ }from\PYG{+w}{ }\PYG{l+m}{192}.168.1.0/24\PYG{+w}{ }to\PYG{+w}{ }any\PYG{+w}{ }port\PYG{+w}{ }\PYG{l+m}{2049}\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} NFS}
sudo\PYG{+w}{ }ufw\PYG{+w}{ }allow\PYG{+w}{ }from\PYG{+w}{ }\PYG{l+m}{192}.168.1.0/24\PYG{+w}{ }to\PYG{+w}{ }any\PYG{+w}{ }port\PYG{+w}{ }\PYG{l+m}{445}\PYG{+w}{   }\PYG{c+c1}{\PYGZsh{} SMB}

\PYG{c+c1}{\PYGZsh{} 3. Use authentication}
\PYG{c+c1}{\PYGZsh{} For NFS: Configure Kerberos}
\PYG{c+c1}{\PYGZsh{} For SMB: Use strong passwords and encryption}

\PYG{c+c1}{\PYGZsh{} 4. Enable encryption}
\PYG{c+c1}{\PYGZsh{} For SMB, add to smb.conf:}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}smb encrypt = required\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/samba/smb.conf

\PYG{c+c1}{\PYGZsh{} 5. Regular security updates}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sudo\PYG{+w}{ }apt\PYG{+w}{ }upgrade
\end{sphinxVerbatim}


\subsubsection{Q: How do I monitor network storage performance?}
\label{\detokenize{network-storage:q-how-do-i-monitor-network-storage-performance}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these monitoring tools:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Monitor network I/O}
iftop\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }eth0

\PYG{c+c1}{\PYGZsh{} Monitor NFS statistics}
nfsstat\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Client stats}
nfsstat\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Server stats}

\PYG{c+c1}{\PYGZsh{} Monitor iSCSI performance}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Monitor Samba connections}
sudo\PYG{+w}{ }smbstatus

\PYG{c+c1}{\PYGZsh{} Create monitoring script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }monitor\PYGZus{}network\PYGZus{}storage.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{echo \PYGZdq{}=== Network Storage Performance Monitor ===\PYGZdq{}}
\PYG{l+s}{echo \PYGZdq{}Date: \PYGZdl{}(date)\PYGZdq{}}
\PYG{l+s}{echo \PYGZdq{}\PYGZdq{}}

\PYG{l+s}{echo \PYGZdq{}NFS Statistics:\PYGZdq{}}
\PYG{l+s}{nfsstat \PYGZhy{}c 2\PYGZgt{}/dev/null || echo \PYGZdq{}NFS client not active\PYGZdq{}}
\PYG{l+s}{echo \PYGZdq{}\PYGZdq{}}

\PYG{l+s}{echo \PYGZdq{}Network Interface Statistics:\PYGZdq{}}
\PYG{l+s}{cat /proc/net/dev | grep \PYGZhy{}E \PYGZdq{}(eth0|ens|enp)\PYGZdq{}}
\PYG{l+s}{echo \PYGZdq{}\PYGZdq{}}

\PYG{l+s}{echo \PYGZdq{}Active Network Connections:\PYGZdq{}}
\PYG{l+s}{ss \PYGZhy{}tuln | grep \PYGZhy{}E \PYGZdq{}(2049|445|3260)\PYGZdq{}  \PYGZsh{} NFS, SMB, iSCSI}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }monitor\PYGZus{}network\PYGZus{}storage.sh
\end{sphinxVerbatim}


\subsection{Coding Examples}
\label{\detokenize{network-storage:coding-examples}}

\subsubsection{Python Network Storage Monitor}
\label{\detokenize{network-storage:python-network-storage-monitor}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Network storage monitoring script for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{psutil}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{datetime}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{datetime}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{NetworkStorageMonitor}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{start\PYGZus{}time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{interfaces} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}network\PYGZus{}interfaces}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}network\PYGZus{}interfaces}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get list of network interfaces\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{return} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{psutil}\PYG{o}{.}\PYG{n}{net\PYGZus{}if\PYGZus{}addrs}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}nfs\PYGZus{}mounts}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check NFS mount status\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{n}{mounts} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{6}\PYG{p}{:}
                        \PYG{n}{mounts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{options}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{success}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{mounts}\PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{message}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}smb\PYGZus{}mounts}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check SMB/CIFS mount status\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cifs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{n}{mounts} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{6}\PYG{p}{:}
                        \PYG{n}{mounts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
                            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{options}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}
                        \PYG{p}{\PYGZcb{}}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{success}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{mounts}\PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{message}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}iscsi\PYGZus{}sessions}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check iSCSI session status\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iscsiadm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{session}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{n}{sessions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s1}{n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line} \PYG{o+ow}{and} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tcp:}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{p}{:}
                    \PYG{n}{sessions}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{success}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sessions}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sessions}\PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{status}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{message}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}network\PYGZus{}stats}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get network interface statistics\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{stats} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
        \PYG{n}{net\PYGZus{}io} \PYG{o}{=} \PYG{n}{psutil}\PYG{o}{.}\PYG{n}{net\PYGZus{}io\PYGZus{}counters}\PYG{p}{(}\PYG{n}{pernic}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{interface}\PYG{p}{,} \PYG{n}{counters} \PYG{o+ow}{in} \PYG{n}{net\PYGZus{}io}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{stats}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}sent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{bytes\PYGZus{}sent}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}recv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{bytes\PYGZus{}recv}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{packets\PYGZus{}sent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{packets\PYGZus{}sent}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{packets\PYGZus{}recv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{packets\PYGZus{}recv}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{errors\PYGZus{}in}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{errin}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{errors\PYGZus{}out}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{errout}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{drops\PYGZus{}in}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{dropin}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{drops\PYGZus{}out}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{counters}\PYG{o}{.}\PYG{n}{dropout}
            \PYG{p}{\PYGZcb{}}

        \PYG{k}{return} \PYG{n}{stats}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{service\PYGZus{}name}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check systemd service status\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{systemctl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{is\PYGZhy{}active}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{service\PYGZus{}name}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{k}{return} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{unknown}\PYG{l+s+s1}{\PYGZsq{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{test\PYGZus{}connectivity}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{host}\PYG{p}{,} \PYG{n}{port}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Test network connectivity to host:port\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{socket}
            \PYG{n}{sock} \PYG{o}{=} \PYG{n}{socket}\PYG{o}{.}\PYG{n}{socket}\PYG{p}{(}\PYG{n}{socket}\PYG{o}{.}\PYG{n}{AF\PYGZus{}INET}\PYG{p}{,} \PYG{n}{socket}\PYG{o}{.}\PYG{n}{SOCK\PYGZus{}STREAM}\PYG{p}{)}
            \PYG{n}{sock}\PYG{o}{.}\PYG{n}{settimeout}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{sock}\PYG{o}{.}\PYG{n}{connect\PYGZus{}ex}\PYG{p}{(}\PYG{p}{(}\PYG{n}{host}\PYG{p}{,} \PYG{n}{port}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{sock}\PYG{o}{.}\PYG{n}{close}\PYG{p}{(}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{result} \PYG{o}{==} \PYG{l+m+mi}{0}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{generate\PYGZus{}report}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Generate comprehensive network storage report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{datetime}\PYG{o}{.}\PYG{n}{now}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{isoformat}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{uptime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{start\PYGZus{}time}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{services}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs\PYGZhy{}server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs\PYGZhy{}kernel\PYGZhy{}server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smbd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smbd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nmbd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nmbd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iscsid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iscsid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tgt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}service\PYGZus{}status}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tgt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            \PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}nfs\PYGZus{}mounts}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}smb\PYGZus{}mounts}\PYG{p}{(}\PYG{p}{)}
            \PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iscsi}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}iscsi\PYGZus{}sessions}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{network}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}network\PYGZus{}stats}\PYG{p}{(}\PYG{p}{)}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{return} \PYG{n}{report}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{monitor\PYGZus{}performance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{duration}\PYG{o}{=}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{n}{interval}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Monitor network storage performance over time\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Monitoring network storage for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{duration}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ seconds...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{n}{start\PYGZus{}stats} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}network\PYGZus{}stats}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{time}\PYG{o}{.}\PYG{n}{sleep}\PYG{p}{(}\PYG{n}{duration}\PYG{p}{)}
        \PYG{n}{end\PYGZus{}stats} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}network\PYGZus{}stats}\PYG{p}{(}\PYG{p}{)}

        \PYG{n}{performance} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
        \PYG{k}{for} \PYG{n}{interface} \PYG{o+ow}{in} \PYG{n}{start\PYGZus{}stats}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{interface} \PYG{o+ow}{in} \PYG{n}{end\PYGZus{}stats}\PYG{p}{:}
                \PYG{n}{sent\PYGZus{}diff} \PYG{o}{=} \PYG{n}{end\PYGZus{}stats}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}sent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{start\PYGZus{}stats}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}sent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
                \PYG{n}{recv\PYGZus{}diff} \PYG{o}{=} \PYG{n}{end\PYGZus{}stats}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}recv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{start\PYGZus{}stats}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bytes\PYGZus{}recv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

                \PYG{n}{performance}\PYG{p}{[}\PYG{n}{interface}\PYG{p}{]} \PYG{o}{=} \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg\PYGZus{}send\PYGZus{}rate\PYGZus{}mbps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{(}\PYG{n}{sent\PYGZus{}diff} \PYG{o}{*} \PYG{l+m+mi}{8}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{duration} \PYG{o}{*} \PYG{l+m+mi}{1024} \PYG{o}{*} \PYG{l+m+mi}{1024}\PYG{p}{)}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg\PYGZus{}recv\PYGZus{}rate\PYGZus{}mbps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{(}\PYG{n}{recv\PYGZus{}diff} \PYG{o}{*} \PYG{l+m+mi}{8}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{duration} \PYG{o}{*} \PYG{l+m+mi}{1024} \PYG{o}{*} \PYG{l+m+mi}{1024}\PYG{p}{)}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}sent\PYGZus{}mb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{sent\PYGZus{}diff} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024} \PYG{o}{*} \PYG{l+m+mi}{1024}\PYG{p}{)}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{total\PYGZus{}recv\PYGZus{}mb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{recv\PYGZus{}diff} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1024} \PYG{o}{*} \PYG{l+m+mi}{1024}\PYG{p}{)}
                \PYG{p}{\PYGZcb{}}

        \PYG{k}{return} \PYG{n}{performance}

\PYG{c+c1}{\PYGZsh{} Example usage}
\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{argparse}

    \PYG{n}{parser} \PYG{o}{=} \PYG{n}{argparse}\PYG{o}{.}\PYG{n}{ArgumentParser}\PYG{p}{(}\PYG{n}{description}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Network Storage Monitor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Generate status report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}monitor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{type}\PYG{o}{=}\PYG{n+nb}{int}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Monitor performance for N seconds}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{parser}\PYG{o}{.}\PYG{n}{add\PYGZus{}argument}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{action}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{store\PYGZus{}true}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{help}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Output in JSON format}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{args} \PYG{o}{=} \PYG{n}{parser}\PYG{o}{.}\PYG{n}{parse\PYGZus{}args}\PYG{p}{(}\PYG{p}{)}

    \PYG{n}{monitor} \PYG{o}{=} \PYG{n}{NetworkStorageMonitor}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{args}\PYG{o}{.}\PYG{n}{report}\PYG{p}{:}
        \PYG{n}{report} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}
        \PYG{k}{if} \PYG{n}{args}\PYG{o}{.}\PYG{n}{json}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Network Storage Status Report}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{*} \PYG{l+m+mi}{40}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Timestamp: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{nServices:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{for} \PYG{n}{service}\PYG{p}{,} \PYG{n}{status} \PYG{o+ow}{in} \PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{services}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{service}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{status}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{nNFS Mounts: }\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SMB Mounts: }\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{iSCSI Sessions: }\PYG{l+s+si}{\PYGZob{}}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{report}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iscsi}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sessions}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{elif} \PYG{n}{args}\PYG{o}{.}\PYG{n}{monitor}\PYG{p}{:}
        \PYG{n}{performance} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{monitor\PYGZus{}performance}\PYG{p}{(}\PYG{n}{args}\PYG{o}{.}\PYG{n}{monitor}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{l+s+s2}{nNetwork Performance Summary (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{args}\PYG{o}{.}\PYG{n}{monitor}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{s):}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{interface}\PYG{p}{,} \PYG{n}{stats} \PYG{o+ow}{in} \PYG{n}{performance}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{interface}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{    Average Send Rate: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg\PYGZus{}send\PYGZus{}rate\PYGZus{}mbps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s2}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ Mbps}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{    Average Recv Rate: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{stats}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg\PYGZus{}recv\PYGZus{}rate\PYGZus{}mbps}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{:}\PYG{l+s+s2}{.2f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ Mbps}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{parser}\PYG{o}{.}\PYG{n}{print\PYGZus{}help}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Best Practices for Network Storage}
\label{\detokenize{network-storage:best-practices-for-network-storage}}

\subsubsection{Security Best Practices}
\label{\detokenize{network-storage:security-best-practices}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Network Segmentation}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Use dedicated VLANs for storage traffic

\item {} 
\sphinxAtStartPar
Implement firewall rules

\item {} 
\sphinxAtStartPar
Regular security audits

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Authentication and Authorization}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Strong passwords and multi\sphinxhyphen{}factor authentication

\item {} 
\sphinxAtStartPar
Regular credential rotation

\item {} 
\sphinxAtStartPar
Principle of least privilege

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Encryption}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Encrypt data in transit

\item {} 
\sphinxAtStartPar
Encrypt data at rest

\item {} 
\sphinxAtStartPar
Use VPN for remote access

\end{itemize}

\end{enumerate}


\subsubsection{Performance Best Practices}
\label{\detokenize{network-storage:performance-best-practices}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Network Optimization}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Use dedicated high\sphinxhyphen{}speed networks

\item {} 
\sphinxAtStartPar
Optimize TCP window sizes

\item {} 
\sphinxAtStartPar
Enable jumbo frames where supported

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Protocol Selection}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Choose appropriate protocols for workload

\item {} 
\sphinxAtStartPar
Optimize protocol\sphinxhyphen{}specific parameters

\item {} 
\sphinxAtStartPar
Consider multi\sphinxhyphen{}path configurations

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitoring and Maintenance}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Regular performance monitoring

\item {} 
\sphinxAtStartPar
Proactive capacity planning

\item {} 
\sphinxAtStartPar
Scheduled maintenance windows

\end{itemize}

\end{enumerate}

\sphinxstepscope


\chapter{Volume Management}
\label{\detokenize{volume-management:volume-management}}\label{\detokenize{volume-management::doc}}
\sphinxAtStartPar
Volume management provides an abstraction layer between physical storage devices and file systems, enabling dynamic storage allocation, resizing, and advanced features like snapshots and encryption.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id1}}{\hyperref[\detokenize{volume-management:introduction-to-volume-management}]{\sphinxcrossref{Introduction to Volume Management}}} (\autopageref*{\detokenize{volume-management:introduction-to-volume-management}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id2}}{\hyperref[\detokenize{volume-management:key-concepts}]{\sphinxcrossref{Key Concepts}}} (\autopageref*{\detokenize{volume-management:key-concepts}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id3}}{\hyperref[\detokenize{volume-management:lvm-logical-volume-manager}]{\sphinxcrossref{LVM (Logical Volume Manager)}}} (\autopageref*{\detokenize{volume-management:lvm-logical-volume-manager}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id4}}{\hyperref[\detokenize{volume-management:installation-and-setup}]{\sphinxcrossref{Installation and Setup}}} (\autopageref*{\detokenize{volume-management:installation-and-setup}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id5}}{\hyperref[\detokenize{volume-management:creating-physical-volumes}]{\sphinxcrossref{Creating Physical Volumes}}} (\autopageref*{\detokenize{volume-management:creating-physical-volumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id6}}{\hyperref[\detokenize{volume-management:creating-volume-groups}]{\sphinxcrossref{Creating Volume Groups}}} (\autopageref*{\detokenize{volume-management:creating-volume-groups}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id7}}{\hyperref[\detokenize{volume-management:creating-logical-volumes}]{\sphinxcrossref{Creating Logical Volumes}}} (\autopageref*{\detokenize{volume-management:creating-logical-volumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id8}}{\hyperref[\detokenize{volume-management:formatting-and-mounting-lvm-volumes}]{\sphinxcrossref{Formatting and Mounting LVM Volumes}}} (\autopageref*{\detokenize{volume-management:formatting-and-mounting-lvm-volumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id9}}{\hyperref[\detokenize{volume-management:resizing-lvm-volumes}]{\sphinxcrossref{Resizing LVM Volumes}}} (\autopageref*{\detokenize{volume-management:resizing-lvm-volumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id10}}{\hyperref[\detokenize{volume-management:lvm-snapshots}]{\sphinxcrossref{LVM Snapshots}}} (\autopageref*{\detokenize{volume-management:lvm-snapshots}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id11}}{\hyperref[\detokenize{volume-management:advanced-lvm-features}]{\sphinxcrossref{Advanced LVM Features}}} (\autopageref*{\detokenize{volume-management:advanced-lvm-features}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id12}}{\hyperref[\detokenize{volume-management:zfs-volume-management}]{\sphinxcrossref{ZFS Volume Management}}} (\autopageref*{\detokenize{volume-management:zfs-volume-management}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id13}}{\hyperref[\detokenize{volume-management:installation-on-ubuntu-22-04}]{\sphinxcrossref{Installation on Ubuntu 22.04}}} (\autopageref*{\detokenize{volume-management:installation-on-ubuntu-22-04}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id14}}{\hyperref[\detokenize{volume-management:creating-zfs-pools}]{\sphinxcrossref{Creating ZFS Pools}}} (\autopageref*{\detokenize{volume-management:creating-zfs-pools}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id15}}{\hyperref[\detokenize{volume-management:creating-zfs-datasets}]{\sphinxcrossref{Creating ZFS Datasets}}} (\autopageref*{\detokenize{volume-management:creating-zfs-datasets}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id16}}{\hyperref[\detokenize{volume-management:zfs-snapshots-and-clones}]{\sphinxcrossref{ZFS Snapshots and Clones}}} (\autopageref*{\detokenize{volume-management:zfs-snapshots-and-clones}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id17}}{\hyperref[\detokenize{volume-management:btrfs-volume-management}]{\sphinxcrossref{Btrfs Volume Management}}} (\autopageref*{\detokenize{volume-management:btrfs-volume-management}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id18}}{\hyperref[\detokenize{volume-management:creating-btrfs-volumes}]{\sphinxcrossref{Creating Btrfs Volumes}}} (\autopageref*{\detokenize{volume-management:creating-btrfs-volumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id19}}{\hyperref[\detokenize{volume-management:btrfs-subvolumes}]{\sphinxcrossref{Btrfs Subvolumes}}} (\autopageref*{\detokenize{volume-management:btrfs-subvolumes}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id20}}{\hyperref[\detokenize{volume-management:btrfs-snapshots}]{\sphinxcrossref{Btrfs Snapshots}}} (\autopageref*{\detokenize{volume-management:btrfs-snapshots}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id21}}{\hyperref[\detokenize{volume-management:volume-management-scripts}]{\sphinxcrossref{Volume Management Scripts}}} (\autopageref*{\detokenize{volume-management:volume-management-scripts}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id22}}{\hyperref[\detokenize{volume-management:lvm-monitoring-script}]{\sphinxcrossref{LVM Monitoring Script}}} (\autopageref*{\detokenize{volume-management:lvm-monitoring-script}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id23}}{\hyperref[\detokenize{volume-management:automated-backup-script}]{\sphinxcrossref{Automated Backup Script}}} (\autopageref*{\detokenize{volume-management:automated-backup-script}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id24}}{\hyperref[\detokenize{volume-management:common-tasks-and-q-a}]{\sphinxcrossref{Common Tasks and Q\&A}}} (\autopageref*{\detokenize{volume-management:common-tasks-and-q-a}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id25}}{\hyperref[\detokenize{volume-management:best-practices}]{\sphinxcrossref{Best Practices}}} (\autopageref*{\detokenize{volume-management:best-practices}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{volume-management:id26}}{\hyperref[\detokenize{volume-management:see-also}]{\sphinxcrossref{See Also}}} (\autopageref*{\detokenize{volume-management:see-also}})

\end{itemize}
\end{sphinxcontents}


\section{Introduction to Volume Management}
\label{\detokenize{volume-management:introduction-to-volume-management}}
\sphinxAtStartPar
Volume management systems allow you to:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Combine multiple physical disks into logical volumes

\item {} 
\sphinxAtStartPar
Resize volumes dynamically without downtime

\item {} 
\sphinxAtStartPar
Create snapshots for backup and testing

\item {} 
\sphinxAtStartPar
Implement storage encryption and compression

\item {} 
\sphinxAtStartPar
Manage storage pools efficiently

\end{itemize}


\subsection{Key Concepts}
\label{\detokenize{volume-management:key-concepts}}\begin{description}
\sphinxlineitem{\sphinxstylestrong{Physical Volumes (PV)}}
\sphinxAtStartPar
Physical storage devices or partitions

\sphinxlineitem{\sphinxstylestrong{Volume Groups (VG)}}
\sphinxAtStartPar
Collections of physical volumes

\sphinxlineitem{\sphinxstylestrong{Logical Volumes (LV)}}
\sphinxAtStartPar
Virtual partitions created from volume groups

\sphinxlineitem{\sphinxstylestrong{Logical Volume Manager (LVM)}}
\sphinxAtStartPar
The primary volume management system in Linux

\end{description}


\section{LVM (Logical Volume Manager)}
\label{\detokenize{volume-management:lvm-logical-volume-manager}}

\subsection{Installation and Setup}
\label{\detokenize{volume-management:installation-and-setup}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install LVM tools on Ubuntu 22.04}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }lvm2

\PYG{c+c1}{\PYGZsh{} Check LVM installation}
lvm\PYG{+w}{ }version
\end{sphinxVerbatim}


\subsection{Creating Physical Volumes}
\label{\detokenize{volume-management:creating-physical-volumes}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create physical volume from disk}
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Create PV from partition}
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }/dev/sdc1

\PYG{c+c1}{\PYGZsh{} Display physical volumes}
sudo\PYG{+w}{ }pvdisplay
sudo\PYG{+w}{ }pvs
\end{sphinxVerbatim}


\subsection{Creating Volume Groups}
\label{\detokenize{volume-management:creating-volume-groups}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create volume group from single PV}
sudo\PYG{+w}{ }vgcreate\PYG{+w}{ }myvg\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Create VG from multiple PVs}
sudo\PYG{+w}{ }vgcreate\PYG{+w}{ }datavg\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Display volume groups}
sudo\PYG{+w}{ }vgdisplay
sudo\PYG{+w}{ }vgs
\end{sphinxVerbatim}


\subsection{Creating Logical Volumes}
\label{\detokenize{volume-management:creating-logical-volumes}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create LV with specific size}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }10G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }mylv\PYG{+w}{ }myvg

\PYG{c+c1}{\PYGZsh{} Create LV using percentage of VG}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+m}{50}\PYGZpc{}VG\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }datalv\PYG{+w}{ }datavg

\PYG{c+c1}{\PYGZsh{} Create LV using all available space}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}FREE\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }homelv\PYG{+w}{ }myvg

\PYG{c+c1}{\PYGZsh{} Display logical volumes}
sudo\PYG{+w}{ }lvdisplay
sudo\PYG{+w}{ }lvs
\end{sphinxVerbatim}


\subsection{Formatting and Mounting LVM Volumes}
\label{\detokenize{volume-management:formatting-and-mounting-lvm-volumes}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Format logical volume}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Create mount point}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/mylv

\PYG{c+c1}{\PYGZsh{} Mount the volume}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/myvg/mylv\PYG{+w}{ }/mnt/mylv

\PYG{c+c1}{\PYGZsh{} Add to /etc/fstab for persistent mounting}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}/dev/myvg/mylv /mnt/mylv ext4 defaults 0 2\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab
\end{sphinxVerbatim}


\subsection{Resizing LVM Volumes}
\label{\detokenize{volume-management:resizing-lvm-volumes}}
\sphinxAtStartPar
\sphinxstylestrong{Extending Logical Volumes}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Extend LV size}
sudo\PYG{+w}{ }lvextend\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }+5G\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Extend LV to use all available space}
sudo\PYG{+w}{ }lvextend\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }+100\PYGZpc{}FREE\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Resize filesystem (ext4)}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} For XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}growfs\PYG{+w}{ }/mnt/mylv
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Shrinking Logical Volumes}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Unmount the filesystem first}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/mylv

\PYG{c+c1}{\PYGZsh{} Check filesystem}
sudo\PYG{+w}{ }e2fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Shrink filesystem first}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/myvg/mylv\PYG{+w}{ }8G

\PYG{c+c1}{\PYGZsh{} Then shrink the logical volume}
sudo\PYG{+w}{ }lvreduce\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }8G\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Remount}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/myvg/mylv\PYG{+w}{ }/mnt/mylv
\end{sphinxVerbatim}


\subsection{LVM Snapshots}
\label{\detokenize{volume-management:lvm-snapshots}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create snapshot}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }2G\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }mylv\PYGZus{}snapshot\PYG{+w}{ }/dev/myvg/mylv

\PYG{c+c1}{\PYGZsh{} Mount snapshot for backup}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/snapshot
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/myvg/mylv\PYGZus{}snapshot\PYG{+w}{ }/mnt/snapshot

\PYG{c+c1}{\PYGZsh{} Remove snapshot after backup}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/snapshot
sudo\PYG{+w}{ }lvremove\PYG{+w}{ }/dev/myvg/mylv\PYGZus{}snapshot
\end{sphinxVerbatim}


\subsection{Advanced LVM Features}
\label{\detokenize{volume-management:advanced-lvm-features}}
\sphinxAtStartPar
\sphinxstylestrong{LVM Thin Provisioning}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create thin pool}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }50G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}thinpool\PYG{+w}{ }mythinpool\PYG{+w}{ }myvg

\PYG{c+c1}{\PYGZsh{} Create thin volume}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}V\PYG{+w}{ }100G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}thin\PYG{+w}{ }myvg/mythinpool\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }thinlv

\PYG{c+c1}{\PYGZsh{} Monitor thin pool usage}
sudo\PYG{+w}{ }lvs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }+data\PYGZus{}percent,metadata\PYGZus{}percent
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{LVM Caching}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create cache pool (requires SSD)}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }10G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }cachepool\PYG{+w}{ }myvg\PYG{+w}{ }/dev/nvme0n1p1

\PYG{c+c1}{\PYGZsh{} Convert to cache pool}
sudo\PYG{+w}{ }lvconvert\PYG{+w}{ }\PYGZhy{}\PYGZhy{}type\PYG{+w}{ }cache\PYGZhy{}pool\PYG{+w}{ }myvg/cachepool

\PYG{c+c1}{\PYGZsh{} Cache a logical volume}
sudo\PYG{+w}{ }lvconvert\PYG{+w}{ }\PYGZhy{}\PYGZhy{}type\PYG{+w}{ }cache\PYG{+w}{ }\PYGZhy{}\PYGZhy{}cachepool\PYG{+w}{ }myvg/cachepool\PYG{+w}{ }myvg/mylv
\end{sphinxVerbatim}


\section{ZFS Volume Management}
\label{\detokenize{volume-management:zfs-volume-management}}

\subsection{Installation on Ubuntu 22.04}
\label{\detokenize{volume-management:installation-on-ubuntu-22-04}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install ZFS}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }zfsutils\PYGZhy{}linux

\PYG{c+c1}{\PYGZsh{} Load ZFS module}
sudo\PYG{+w}{ }modprobe\PYG{+w}{ }zfs

\PYG{c+c1}{\PYGZsh{} Verify installation}
zfs\PYG{+w}{ }version
\end{sphinxVerbatim}


\subsection{Creating ZFS Pools}
\label{\detokenize{volume-management:creating-zfs-pools}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create simple pool}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }create\PYG{+w}{ }mypool\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Create mirrored pool}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }create\PYG{+w}{ }mypool\PYG{+w}{ }mirror\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Create RAIDZ pool (RAID5\PYGZhy{}like)}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }create\PYG{+w}{ }mypool\PYG{+w}{ }raidz\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc\PYG{+w}{ }/dev/sdd

\PYG{c+c1}{\PYGZsh{} Check pool status}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }status
sudo\PYG{+w}{ }zpool\PYG{+w}{ }list
\end{sphinxVerbatim}


\subsection{Creating ZFS Datasets}
\label{\detokenize{volume-management:creating-zfs-datasets}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create dataset}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }create\PYG{+w}{ }mypool/data

\PYG{c+c1}{\PYGZsh{} Create dataset with compression}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }create\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{compression}\PYG{o}{=}lz4\PYG{+w}{ }mypool/compressed

\PYG{c+c1}{\PYGZsh{} Set quota}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{n+nv}{quota}\PYG{o}{=}10G\PYG{+w}{ }mypool/data

\PYG{c+c1}{\PYGZsh{} List datasets}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }list
\end{sphinxVerbatim}


\subsection{ZFS Snapshots and Clones}
\label{\detokenize{volume-management:zfs-snapshots-and-clones}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create snapshot}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }snapshot\PYG{+w}{ }mypool/data@backup\PYGZhy{}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}

\PYG{c+c1}{\PYGZsh{} List snapshots}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }list\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }snapshot

\PYG{c+c1}{\PYGZsh{} Clone snapshot}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }clone\PYG{+w}{ }mypool/data@backup\PYGZhy{}20250715\PYG{+w}{ }mypool/data\PYGZhy{}clone

\PYG{c+c1}{\PYGZsh{} Rollback to snapshot}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }rollback\PYG{+w}{ }mypool/data@backup\PYGZhy{}20250715
\end{sphinxVerbatim}


\section{Btrfs Volume Management}
\label{\detokenize{volume-management:btrfs-volume-management}}

\subsection{Creating Btrfs Volumes}
\label{\detokenize{volume-management:creating-btrfs-volumes}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create single device Btrfs}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Create multi\PYGZhy{}device Btrfs}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }raid1\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }raid1\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc

\PYG{c+c1}{\PYGZsh{} Mount Btrfs filesystem}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/mnt/btrfs
\end{sphinxVerbatim}


\subsection{Btrfs Subvolumes}
\label{\detokenize{volume-management:btrfs-subvolumes}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create subvolume}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }create\PYG{+w}{ }/mnt/btrfs/subvol1

\PYG{c+c1}{\PYGZsh{} List subvolumes}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }list\PYG{+w}{ }/mnt/btrfs

\PYG{c+c1}{\PYGZsh{} Mount subvolume}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{subvol}\PYG{o}{=}subvol1\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/mnt/subvol1
\end{sphinxVerbatim}


\subsection{Btrfs Snapshots}
\label{\detokenize{volume-management:btrfs-snapshots}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create snapshot}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }snapshot\PYG{+w}{ }/mnt/btrfs/subvol1\PYG{+w}{ }/mnt/btrfs/snapshot1

\PYG{c+c1}{\PYGZsh{} Create read\PYGZhy{}only snapshot}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }subvolume\PYG{+w}{ }snapshot\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }/mnt/btrfs/subvol1\PYG{+w}{ }/mnt/btrfs/ro\PYGZhy{}snapshot
\end{sphinxVerbatim}


\section{Volume Management Scripts}
\label{\detokenize{volume-management:volume-management-scripts}}

\subsection{LVM Monitoring Script}
\label{\detokenize{volume-management:lvm-monitoring-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{LVM Volume Monitoring Script for Ubuntu 22.04}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Execute shell command and return output\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{,} \PYG{n}{shell}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode}
    \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
        \PYG{k}{return} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{1}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}pv\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get physical volume information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo pvs \PYGZhy{}\PYGZhy{}reportformat json}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{k}{return} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
    \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}vg\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get volume group information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo vgs \PYGZhy{}\PYGZhy{}reportformat json}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{k}{return} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
    \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}lv\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get logical volume information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo lvs \PYGZhy{}\PYGZhy{}reportformat json}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{k}{return} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}
    \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}space\PYGZus{}usage}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check for volume groups with high usage\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{vg\PYGZus{}info} \PYG{o}{=} \PYG{n}{get\PYGZus{}vg\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{alerts} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{vg\PYGZus{}info}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{vg} \PYG{o+ow}{in} \PYG{n}{vg\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n}{used\PYGZus{}percent} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n}{vg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg\PYGZus{}used\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{rstrip}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
            \PYG{k}{if} \PYG{n}{used\PYGZus{}percent} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{80}\PYG{p}{:}
                \PYG{n}{alerts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{VG }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{vg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{used\PYGZus{}percent}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{return} \PYG{n}{alerts}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=== LVM Volume Status ===}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Physical Volumes}
    \PYG{n}{pv\PYGZus{}info} \PYG{o}{=} \PYG{n}{get\PYGZus{}pv\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{pv\PYGZus{}info}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Physical Volumes:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{pv} \PYG{o+ow}{in} \PYG{n}{pv\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{pv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pv\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{pv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pv\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{pv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pv\PYGZus{}used}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ used)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Volume Groups}
    \PYG{n}{vg\PYGZus{}info} \PYG{o}{=} \PYG{n}{get\PYGZus{}vg\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{vg\PYGZus{}info}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Volume Groups:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{vg} \PYG{o+ow}{in} \PYG{n}{vg\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{vg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{vg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{vg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{vg\PYGZus{}used\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ used)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Logical Volumes}
    \PYG{n}{lv\PYGZus{}info} \PYG{o}{=} \PYG{n}{get\PYGZus{}lv\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{lv\PYGZus{}info}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Logical Volumes:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{lv} \PYG{o+ow}{in} \PYG{n}{lv\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{report}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{lv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lv\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{lv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lv\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ (}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{lv}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data\PYGZus{}percent}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{+w}{ }\PYG{o+ow}{or}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} data)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Check for alerts}
    \PYG{n}{alerts} \PYG{o}{=} \PYG{n}{check\PYGZus{}space\PYGZus{}usage}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{alerts}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{=== ALERTS ===}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{alert} \PYG{o+ow}{in} \PYG{n}{alerts}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WARNING: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{alert}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Automated Backup Script}
\label{\detokenize{volume-management:automated-backup-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} LVM Snapshot Backup Script}

\PYG{n+nv}{VOLUME\PYGZus{}GROUP}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}myvg\PYGZdq{}}
\PYG{n+nv}{LOGICAL\PYGZus{}VOLUME}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}mylv\PYGZdq{}}
\PYG{n+nv}{SNAPSHOT\PYGZus{}NAME}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{LOGICAL\PYGZus{}VOLUME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}backup\PYGZus{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/backup\PYGZdq{}}
\PYG{n+nv}{SNAPSHOT\PYGZus{}SIZE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}2G\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Function to log messages}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{: }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/var/log/lvm\PYGZus{}backup.log
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Function to cleanup on exit}
cleanup\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}CREATED}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cleaning up snapshot: }\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}NAME}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/snapshot\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null
\PYG{+w}{        }sudo\PYG{+w}{ }lvremove\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/\PYG{n+nv}{\PYGZdl{}VOLUME\PYGZus{}GROUP}/\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}NAME}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Set trap for cleanup}
\PYG{n+nb}{trap}\PYG{+w}{ }cleanup\PYG{+w}{ }EXIT

\PYG{c+c1}{\PYGZsh{} Create snapshot}
log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Creating snapshot: }\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}NAME}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{if}\PYG{+w}{ }sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}SIZE}\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}NAME}\PYG{+w}{ }/dev/\PYG{n+nv}{\PYGZdl{}VOLUME\PYGZus{}GROUP}/\PYG{n+nv}{\PYGZdl{}LOGICAL\PYGZus{}VOLUME}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }\PYG{n+nv}{SNAPSHOT\PYGZus{}CREATED}\PYG{o}{=}\PYG{l+m}{1}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Snapshot created successfully\PYGZdq{}}
\PYG{k}{else}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Failed to create snapshot\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{k}{fi}

\PYG{c+c1}{\PYGZsh{} Mount snapshot}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/mnt/snapshot
\PYG{k}{if}\PYG{+w}{ }sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/\PYG{n+nv}{\PYGZdl{}VOLUME\PYGZus{}GROUP}/\PYG{n+nv}{\PYGZdl{}SNAPSHOT\PYGZus{}NAME}\PYG{+w}{ }/mnt/snapshot\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Snapshot mounted at /mnt/snapshot\PYGZdq{}}
\PYG{k}{else}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Failed to mount snapshot\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{k}{fi}

\PYG{c+c1}{\PYGZsh{} Create backup}
\PYG{n+nv}{BACKUP\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{/backup\PYGZus{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{LOGICAL\PYGZus{}VOLUME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZus{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}\PYG{l+s+s2}{.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}
log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Creating backup: }\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{if}\PYG{+w}{ }sudo\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}C\PYG{+w}{ }/mnt/snapshot\PYG{+w}{ }.\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup completed: }\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup size: }\PYG{k}{\PYGZdl{}(}du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }cut\PYG{+w}{ }\PYGZhy{}f1\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{else}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup failed\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{k}{fi}
\end{sphinxVerbatim}


\section{Common Tasks and Q\&A}
\label{\detokenize{volume-management:common-tasks-and-q-a}}
\sphinxAtStartPar
\sphinxstylestrong{Q: How do I extend a volume group with a new disk?}

\sphinxAtStartPar
A: Add the new disk as a physical volume and extend the volume group:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }/dev/sdd
sudo\PYG{+w}{ }vgextend\PYG{+w}{ }myvg\PYG{+w}{ }/dev/sdd
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Q: Can I move data between logical volumes?}

\sphinxAtStartPar
A: Yes, use pvmove to migrate data:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Move all data from /dev/sdb to /dev/sdc}
sudo\PYG{+w}{ }pvmove\PYG{+w}{ }/dev/sdb\PYG{+w}{ }/dev/sdc
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Q: How do I remove a disk from LVM?}

\sphinxAtStartPar
A: First move data, then remove:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
sudo\PYG{+w}{ }pvmove\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }vgreduce\PYG{+w}{ }myvg\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }pvremove\PYG{+w}{ }/dev/sdb
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Q: What’s the difference between thick and thin provisioning?}

\sphinxAtStartPar
A: Thick provisioning allocates all space immediately, while thin provisioning allocates space as needed, allowing overcommitment.

\sphinxAtStartPar
\sphinxstylestrong{Q: How do I monitor thin pool usage?}

\sphinxAtStartPar
A: Use lvs with additional columns:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
sudo\PYG{+w}{ }lvs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }+data\PYGZus{}percent,metadata\PYGZus{}percent
\end{sphinxVerbatim}


\section{Best Practices}
\label{\detokenize{volume-management:best-practices}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Regular Monitoring}
\sphinxhyphen{} Monitor volume group usage
\sphinxhyphen{} Set up alerts for high usage
\sphinxhyphen{} Regular snapshot cleanup

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Backup Strategy}
\sphinxhyphen{} Use LVM snapshots for consistent backups
\sphinxhyphen{} Test restore procedures
\sphinxhyphen{} Keep multiple snapshot generations

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance}
\sphinxhyphen{} Align volumes with underlying storage
\sphinxhyphen{} Use appropriate stripe sizes
\sphinxhyphen{} Consider SSD caching for performance

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Security}
\sphinxhyphen{} Use LUKS encryption for sensitive data
\sphinxhyphen{} Implement proper access controls
\sphinxhyphen{} Regular security audits

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Disaster Recovery}
\sphinxhyphen{} Document volume group configurations
\sphinxhyphen{} Practice recovery procedures
\sphinxhyphen{} Maintain offsite backups

\end{enumerate}


\section{See Also}
\label{\detokenize{volume-management:see-also}}\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{disk-management::doc}]{\sphinxcrossref{\DUrole{doc}{Disk Management}}}} (\autopageref*{\detokenize{disk-management::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{file-systems::doc}]{\sphinxcrossref{\DUrole{doc}{File Systems}}}} (\autopageref*{\detokenize{file-systems::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{raid-systems::doc}]{\sphinxcrossref{\DUrole{doc}{RAID Systems}}}} (\autopageref*{\detokenize{raid-systems::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{troubleshooting::doc}]{\sphinxcrossref{\DUrole{doc}{Troubleshooting Guide}}}} (\autopageref*{\detokenize{troubleshooting::doc}})

\end{itemize}

\sphinxstepscope


\chapter{Storage Devices}
\label{\detokenize{storage-devices:storage-devices}}\label{\detokenize{storage-devices::doc}}
\sphinxAtStartPar
This comprehensive guide covers the various types of storage devices, their characteristics, selection criteria, and management on Ubuntu 22.04 LTS.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id2}}{\hyperref[\detokenize{storage-devices:overview-of-storage-devices}]{\sphinxcrossref{Overview of Storage Devices}}} (\autopageref*{\detokenize{storage-devices:overview-of-storage-devices}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id3}}{\hyperref[\detokenize{storage-devices:classification-by-technology}]{\sphinxcrossref{Classification by Technology}}} (\autopageref*{\detokenize{storage-devices:classification-by-technology}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id4}}{\hyperref[\detokenize{storage-devices:hard-disk-drives-hdds}]{\sphinxcrossref{Hard Disk Drives (HDDs)}}} (\autopageref*{\detokenize{storage-devices:hard-disk-drives-hdds}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id5}}{\hyperref[\detokenize{storage-devices:technology-overview}]{\sphinxcrossref{Technology Overview}}} (\autopageref*{\detokenize{storage-devices:technology-overview}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id6}}{\hyperref[\detokenize{storage-devices:types-of-hdds}]{\sphinxcrossref{Types of HDDs}}} (\autopageref*{\detokenize{storage-devices:types-of-hdds}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id7}}{\hyperref[\detokenize{storage-devices:hdd-management-commands}]{\sphinxcrossref{HDD Management Commands}}} (\autopageref*{\detokenize{storage-devices:hdd-management-commands}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id8}}{\hyperref[\detokenize{storage-devices:solid-state-drives-ssds}]{\sphinxcrossref{Solid State Drives (SSDs)}}} (\autopageref*{\detokenize{storage-devices:solid-state-drives-ssds}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id9}}{\hyperref[\detokenize{storage-devices:id1}]{\sphinxcrossref{Technology Overview}}} (\autopageref*{\detokenize{storage-devices:id1}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id10}}{\hyperref[\detokenize{storage-devices:types-of-ssds}]{\sphinxcrossref{Types of SSDs}}} (\autopageref*{\detokenize{storage-devices:types-of-ssds}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id11}}{\hyperref[\detokenize{storage-devices:ssd-management-and-optimization}]{\sphinxcrossref{SSD Management and Optimization}}} (\autopageref*{\detokenize{storage-devices:ssd-management-and-optimization}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id12}}{\hyperref[\detokenize{storage-devices:nvme-management}]{\sphinxcrossref{NVMe Management}}} (\autopageref*{\detokenize{storage-devices:nvme-management}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id13}}{\hyperref[\detokenize{storage-devices:network-attached-storage-nas}]{\sphinxcrossref{Network Attached Storage (NAS)}}} (\autopageref*{\detokenize{storage-devices:network-attached-storage-nas}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id14}}{\hyperref[\detokenize{storage-devices:types-of-nas-devices}]{\sphinxcrossref{Types of NAS Devices}}} (\autopageref*{\detokenize{storage-devices:types-of-nas-devices}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id15}}{\hyperref[\detokenize{storage-devices:storage-area-network-san}]{\sphinxcrossref{Storage Area Network (SAN)}}} (\autopageref*{\detokenize{storage-devices:storage-area-network-san}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id16}}{\hyperref[\detokenize{storage-devices:iscsi-configuration}]{\sphinxcrossref{iSCSI Configuration}}} (\autopageref*{\detokenize{storage-devices:iscsi-configuration}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id17}}{\hyperref[\detokenize{storage-devices:optical-storage}]{\sphinxcrossref{Optical Storage}}} (\autopageref*{\detokenize{storage-devices:optical-storage}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id18}}{\hyperref[\detokenize{storage-devices:cd-dvd-blu-ray-management}]{\sphinxcrossref{CD/DVD/Blu\sphinxhyphen{}ray Management}}} (\autopageref*{\detokenize{storage-devices:cd-dvd-blu-ray-management}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id19}}{\hyperref[\detokenize{storage-devices:usb-storage-devices}]{\sphinxcrossref{USB Storage Devices}}} (\autopageref*{\detokenize{storage-devices:usb-storage-devices}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id20}}{\hyperref[\detokenize{storage-devices:usb-drive-management}]{\sphinxcrossref{USB Drive Management}}} (\autopageref*{\detokenize{storage-devices:usb-drive-management}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id21}}{\hyperref[\detokenize{storage-devices:usb-performance-optimization}]{\sphinxcrossref{USB Performance Optimization}}} (\autopageref*{\detokenize{storage-devices:usb-performance-optimization}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id22}}{\hyperref[\detokenize{storage-devices:storage-device-monitoring}]{\sphinxcrossref{Storage Device Monitoring}}} (\autopageref*{\detokenize{storage-devices:storage-device-monitoring}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id23}}{\hyperref[\detokenize{storage-devices:health-monitoring-script}]{\sphinxcrossref{Health Monitoring Script}}} (\autopageref*{\detokenize{storage-devices:health-monitoring-script}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id24}}{\hyperref[\detokenize{storage-devices:performance-benchmarking}]{\sphinxcrossref{Performance Benchmarking}}} (\autopageref*{\detokenize{storage-devices:performance-benchmarking}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id25}}{\hyperref[\detokenize{storage-devices:device-selection-guidelines}]{\sphinxcrossref{Device Selection Guidelines}}} (\autopageref*{\detokenize{storage-devices:device-selection-guidelines}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id26}}{\hyperref[\detokenize{storage-devices:performance-considerations}]{\sphinxcrossref{Performance Considerations}}} (\autopageref*{\detokenize{storage-devices:performance-considerations}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id27}}{\hyperref[\detokenize{storage-devices:capacity-planning}]{\sphinxcrossref{Capacity Planning}}} (\autopageref*{\detokenize{storage-devices:capacity-planning}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id28}}{\hyperref[\detokenize{storage-devices:common-issues-and-troubleshooting}]{\sphinxcrossref{Common Issues and Troubleshooting}}} (\autopageref*{\detokenize{storage-devices:common-issues-and-troubleshooting}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id29}}{\hyperref[\detokenize{storage-devices:best-practices}]{\sphinxcrossref{Best Practices}}} (\autopageref*{\detokenize{storage-devices:best-practices}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{storage-devices:id30}}{\hyperref[\detokenize{storage-devices:see-also}]{\sphinxcrossref{See Also}}} (\autopageref*{\detokenize{storage-devices:see-also}})

\end{itemize}
\end{sphinxcontents}


\section{Overview of Storage Devices}
\label{\detokenize{storage-devices:overview-of-storage-devices}}
\sphinxAtStartPar
Storage devices are the physical components that store data persistently. Understanding different types helps in making informed decisions for system design, performance optimization, and capacity planning.


\subsection{Classification by Technology}
\label{\detokenize{storage-devices:classification-by-technology}}\begin{description}
\sphinxlineitem{\sphinxstylestrong{Magnetic Storage}}
\sphinxAtStartPar
Traditional hard disk drives (HDDs) using magnetic fields

\sphinxlineitem{\sphinxstylestrong{Solid State Storage}}
\sphinxAtStartPar
Flash\sphinxhyphen{}based storage devices (SSDs) with no moving parts

\sphinxlineitem{\sphinxstylestrong{Optical Storage}}
\sphinxAtStartPar
CD, DVD, Blu\sphinxhyphen{}ray discs using laser technology

\sphinxlineitem{\sphinxstylestrong{Tape Storage}}
\sphinxAtStartPar
Sequential access magnetic tape for long\sphinxhyphen{}term archival

\sphinxlineitem{\sphinxstylestrong{Hybrid Storage}}
\sphinxAtStartPar
Combination devices (SSHDs) with both magnetic and flash storage

\end{description}


\section{Hard Disk Drives (HDDs)}
\label{\detokenize{storage-devices:hard-disk-drives-hdds}}

\subsection{Technology Overview}
\label{\detokenize{storage-devices:technology-overview}}
\sphinxAtStartPar
HDDs store data on rotating magnetic platters with read/write heads. They offer:
\begin{itemize}
\item {} 
\sphinxAtStartPar
High capacity at low cost

\item {} 
\sphinxAtStartPar
Mechanical components subject to wear

\item {} 
\sphinxAtStartPar
Sequential access performance

\item {} 
\sphinxAtStartPar
Susceptible to physical shock

\end{itemize}


\subsection{Types of HDDs}
\label{\detokenize{storage-devices:types-of-hdds}}
\sphinxAtStartPar
\sphinxstylestrong{Desktop HDDs (3.5”)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check 3.5\PYGZdq{} HDD information}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Model|Serial|Capacity)\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Typical characteristics:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Capacity: 500GB to 20TB+}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} RPM: 5400, 7200 RPM}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Interface: SATA 6Gb/s}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Power: 5\PYGZhy{}10W}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Laptop HDDs (2.5”)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check 2.5\PYGZdq{} HDD specifications}
lsblk\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }NAME,SIZE,MODEL,TRAN

\PYG{c+c1}{\PYGZsh{} Typical characteristics:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Capacity: 500GB to 5TB}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} RPM: 5400 RPM (some 7200 RPM)}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Interface: SATA 6Gb/s}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Power: 1\PYGZhy{}3W}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Enterprise HDDs}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check enterprise HDD features}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Model|Rotation|Power\PYGZus{}Cycle)\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Characteristics:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} High reliability (MTBF 2M+ hours)}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} 7200\PYGZhy{}15000 RPM}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Advanced error correction}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Vibration resistance}
\end{sphinxVerbatim}


\subsection{HDD Management Commands}
\label{\detokenize{storage-devices:hdd-management-commands}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Get detailed HDD information}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Check HDD health with SMART}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }/dev/sda
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Test HDD performance}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }/dev/sda\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Buffered reads}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}T\PYG{+w}{ }/dev/sda\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Cached reads}

\PYG{c+c1}{\PYGZsh{} Set HDD parameters}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}S\PYG{+w}{ }\PYG{l+m}{60}\PYG{+w}{ }/dev/sda\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Set standby timeout}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}B\PYG{+w}{ }\PYG{l+m}{254}\PYG{+w}{ }/dev/sda\PYG{+w}{   }\PYG{c+c1}{\PYGZsh{} Disable power management}
\end{sphinxVerbatim}


\section{Solid State Drives (SSDs)}
\label{\detokenize{storage-devices:solid-state-drives-ssds}}

\subsection{Technology Overview}
\label{\detokenize{storage-devices:id1}}
\sphinxAtStartPar
SSDs use NAND flash memory with no moving parts, providing:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Fast random access

\item {} 
\sphinxAtStartPar
Low latency

\item {} 
\sphinxAtStartPar
High IOPS capability

\item {} 
\sphinxAtStartPar
Limited write endurance

\item {} 
\sphinxAtStartPar
Higher cost per GB

\end{itemize}


\subsection{Types of SSDs}
\label{\detokenize{storage-devices:types-of-ssds}}
\sphinxAtStartPar
\sphinxstylestrong{SATA SSDs}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Identify SATA SSD}
lsblk\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }NAME,SIZE,MODEL,TRAN\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }sata

\PYG{c+c1}{\PYGZsh{} Characteristics:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Interface: SATA 6Gb/s (600MB/s max)}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Form factor: 2.5\PYGZdq{} or mSATA}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Compatible with HDD infrastructure}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{NVMe SSDs}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} List NVMe devices}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }list

\PYG{c+c1}{\PYGZsh{} Get NVMe device information}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }id\PYGZhy{}ctrl\PYG{+w}{ }/dev/nvme0n1

\PYG{c+c1}{\PYGZsh{} Characteristics:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Interface: PCIe (up to 7GB/s)}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Form factors: M.2, PCIe card, U.2}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Lower latency than SATA}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{M.2 SSDs}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check M.2 SSD details}
sudo\PYG{+w}{ }lshw\PYG{+w}{ }\PYGZhy{}class\PYG{+w}{ }disk\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }\PYG{l+m}{10}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}product.*M.2\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Types:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} M.2 SATA: Uses SATA protocol}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} M.2 NVMe: Uses NVMe protocol}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Form factors: 2242, 2260, 2280, 22110}
\end{sphinxVerbatim}


\subsection{SSD Management and Optimization}
\label{\detokenize{storage-devices:ssd-management-and-optimization}}
\sphinxAtStartPar
\sphinxstylestrong{Enable TRIM Support}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check TRIM support}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }TRIM

\PYG{c+c1}{\PYGZsh{} Enable TRIM (automatic)}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Manual TRIM}
sudo\PYG{+w}{ }fstrim\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }/

\PYG{c+c1}{\PYGZsh{} Add to fstab for continuous TRIM}
\PYG{c+c1}{\PYGZsh{} /dev/sda1 / ext4 defaults,discard 0 1}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{SSD Health Monitoring}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check SSD health with smartctl}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Wear|Program|Erase|Health)\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} For NVMe SSDs}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }smart\PYGZhy{}log\PYG{+w}{ }/dev/nvme0n1

\PYG{c+c1}{\PYGZsh{} Monitor wear leveling}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }Wear\PYGZus{}Leveling\PYGZus{}Count
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{SSD Performance Tuning}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check current I/O scheduler}
cat\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Set optimal scheduler for SSD}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Disable barriers for better performance (if using UPS)}
\PYG{c+c1}{\PYGZsh{} mount \PYGZhy{}o nobarrier /dev/sda1 /mnt}
\end{sphinxVerbatim}


\subsection{NVMe Management}
\label{\detokenize{storage-devices:nvme-management}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install NVMe tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }nvme\PYGZhy{}cli

\PYG{c+c1}{\PYGZsh{} List NVMe devices}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }list

\PYG{c+c1}{\PYGZsh{} Get device information}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }id\PYGZhy{}ctrl\PYG{+w}{ }/dev/nvme0n1
sudo\PYG{+w}{ }nvme\PYG{+w}{ }id\PYGZhy{}ns\PYG{+w}{ }/dev/nvme0n1

\PYG{c+c1}{\PYGZsh{} Check NVMe health}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }smart\PYGZhy{}log\PYG{+w}{ }/dev/nvme0n1

\PYG{c+c1}{\PYGZsh{} Format NVMe (careful!)}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }format\PYG{+w}{ }/dev/nvme0n1\PYG{+w}{ }\PYGZhy{}\PYGZhy{}lbaf\PYG{o}{=}\PYG{l+m}{0}

\PYG{c+c1}{\PYGZsh{} Secure erase}
sudo\PYG{+w}{ }nvme\PYG{+w}{ }format\PYG{+w}{ }/dev/nvme0n1\PYG{+w}{ }\PYGZhy{}\PYGZhy{}ses\PYG{o}{=}\PYG{l+m}{1}
\end{sphinxVerbatim}


\section{Network Attached Storage (NAS)}
\label{\detokenize{storage-devices:network-attached-storage-nas}}

\subsection{Types of NAS Devices}
\label{\detokenize{storage-devices:types-of-nas-devices}}
\sphinxAtStartPar
\sphinxstylestrong{Consumer NAS}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Typical consumer NAS specs:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} 1\PYGZhy{}8 drive bays}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} ARM or low\PYGZhy{}power x86 CPU}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} 512MB to 8GB RAM}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Gigabit Ethernet}

\PYG{c+c1}{\PYGZsh{} Connect to NAS via SMB}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }cifs\PYG{+w}{ }//nas.local/share\PYG{+w}{ }/mnt/nas\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{  }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{username}\PYG{o}{=}user,password\PYG{o}{=}pass
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Enterprise NAS}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enterprise NAS features:}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} 8+ drive bays}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Redundant components}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} 10GbE networking}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{} Advanced management}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Building DIY NAS with Ubuntu}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install Samba for SMB/CIFS sharing}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }samba

\PYG{c+c1}{\PYGZsh{} Configure Samba share}
sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/samba/smb.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{[storage]}
\PYG{l+s}{path = /srv/storage}
\PYG{l+s}{browseable = yes}
\PYG{l+s}{read only = no}
\PYG{l+s}{guest ok = no}
\PYG{l+s}{valid users = @storage}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Restart Samba}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }smbd
\end{sphinxVerbatim}


\section{Storage Area Network (SAN)}
\label{\detokenize{storage-devices:storage-area-network-san}}

\subsection{iSCSI Configuration}
\label{\detokenize{storage-devices:iscsi-configuration}}
\sphinxAtStartPar
\sphinxstylestrong{iSCSI Target (Server)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install iSCSI target}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }tgt

\PYG{c+c1}{\PYGZsh{} Create target configuration}
sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/tgt/conf.d/storage.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZlt{}target iqn.2025\PYGZhy{}01.com.example:storage\PYGZgt{}}
\PYG{l+s}{    backing\PYGZhy{}store /dev/sdb}
\PYG{l+s}{    incominguser iscsi\PYGZhy{}user password123}
\PYG{l+s}{    outgoinguser iscsi\PYGZhy{}target secretpass}
\PYG{l+s}{\PYGZlt{}/target\PYGZgt{}}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Restart target service}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }restart\PYG{+w}{ }tgt

\PYG{c+c1}{\PYGZsh{} Check target status}
sudo\PYG{+w}{ }tgtadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}mode\PYG{+w}{ }target\PYG{+w}{ }\PYGZhy{}\PYGZhy{}op\PYG{+w}{ }show
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{iSCSI Initiator (Client)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install iSCSI initiator}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }open\PYGZhy{}iscsi

\PYG{c+c1}{\PYGZsh{} Configure authentication}
sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/iscsi/iscsid.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{node.session.auth.authmethod = CHAP}
\PYG{l+s}{node.session.auth.username = iscsi\PYGZhy{}user}
\PYG{l+s}{node.session.auth.password = password123}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Discover targets}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }discovery\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }st\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+m}{192}.168.1.100

\PYG{c+c1}{\PYGZsh{} Login to target}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }node\PYG{+w}{ }\PYGZhy{}\PYGZhy{}login

\PYG{c+c1}{\PYGZsh{} Check connected sessions}
sudo\PYG{+w}{ }iscsiadm\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }session
\end{sphinxVerbatim}


\section{Optical Storage}
\label{\detokenize{storage-devices:optical-storage}}

\subsection{CD/DVD/Blu\sphinxhyphen{}ray Management}
\label{\detokenize{storage-devices:cd-dvd-blu-ray-management}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install optical drive tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }wodim\PYG{+w}{ }genisoimage\PYG{+w}{ }dvd+rw\PYGZhy{}tools

\PYG{c+c1}{\PYGZsh{} Check optical drive capabilities}
wodim\PYG{+w}{ }\PYGZhy{}\PYGZhy{}devices
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sr0

\PYG{c+c1}{\PYGZsh{} Create ISO image}
genisoimage\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }backup.iso\PYG{+w}{ }\PYGZhy{}J\PYG{+w}{ }\PYGZhy{}R\PYG{+w}{ }/home/user/documents

\PYG{c+c1}{\PYGZsh{} Burn ISO to disc}
wodim\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{n+nv}{speed}\PYG{o}{=}\PYG{l+m}{8}\PYG{+w}{ }backup.iso

\PYG{c+c1}{\PYGZsh{} Mount optical disc}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sr0\PYG{+w}{ }/mnt/cdrom

\PYG{c+c1}{\PYGZsh{} Eject disc}
eject\PYG{+w}{ }/dev/sr0
\end{sphinxVerbatim}


\section{USB Storage Devices}
\label{\detokenize{storage-devices:usb-storage-devices}}

\subsection{USB Drive Management}
\label{\detokenize{storage-devices:usb-drive-management}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} List USB storage devices}
lsusb\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }storage
lsblk\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(sd[b\PYGZhy{}z]|sr[0\PYGZhy{}9])\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Get USB device information}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdb
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} Format USB drive (careful!)}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1
sudo\PYG{+w}{ }mkfs.vfat\PYG{+w}{ }\PYGZhy{}F\PYG{+w}{ }\PYG{l+m}{32}\PYG{+w}{ }/dev/sdb1\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} For Windows compatibility}

\PYG{c+c1}{\PYGZsh{} Mount USB drive}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/usb
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/usb

\PYG{c+c1}{\PYGZsh{} Safe removal}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/usb
sudo\PYG{+w}{ }eject\PYG{+w}{ }/dev/sdb
\end{sphinxVerbatim}


\subsection{USB Performance Optimization}
\label{\detokenize{storage-devices:usb-performance-optimization}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check USB version and speed}
lsusb\PYG{+w}{ }\PYGZhy{}t
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}usb.*high\PYGZbs{}|usb.*super\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Optimize mount options for USB}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }async,noatime,nodiratime\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/usb

\PYG{c+c1}{\PYGZsh{} Disable USB autosuspend for external drives}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}SUBSYSTEM==\PYGZdq{}usb\PYGZdq{}, ATTR\PYGZob{}idVendor\PYGZcb{}==\PYGZdq{}1234\PYGZdq{}, ATTR\PYGZob{}idProduct\PYGZcb{}==\PYGZdq{}5678\PYGZdq{}, ATTR\PYGZob{}power/autosuspend\PYGZcb{}=\PYGZdq{}\PYGZhy{}1\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/udev/rules.d/50\PYGZhy{}usb\PYGZhy{}power.rules
\end{sphinxVerbatim}


\section{Storage Device Monitoring}
\label{\detokenize{storage-devices:storage-device-monitoring}}

\subsection{Health Monitoring Script}
\label{\detokenize{storage-devices:health-monitoring-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Storage Device Health Monitoring Script}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{re}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{datetime}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{datetime}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Execute command and return output\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{,} \PYG{n}{shell}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode}
    \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
        \PYG{k}{return} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{1}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}block\PYGZus{}devices}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get list of block devices\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{lsblk \PYGZhy{}J \PYGZhy{}o NAME,TYPE,SIZE,MODEL,SERIAL}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{k}{return} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{output}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blockdevices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{k}{return} \PYG{p}{[}\PYG{p}{]}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}smart\PYGZus{}health}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check SMART health for device\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo smartctl \PYGZhy{}H /dev/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PASSED}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{in} \PYG{n}{output}\PYG{p}{:}
        \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HEALTHY}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{k}{elif} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{FAILED}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{in} \PYG{n}{output}\PYG{p}{:}
        \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{FAILED}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UNKNOWN}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}temperature}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get device temperature\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo smartctl \PYGZhy{}A /dev/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ | grep \PYGZhy{}i temperature}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0} \PYG{o+ow}{and} \PYG{n}{output}\PYG{p}{:}
        \PYG{n}{temp\PYGZus{}match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+)}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{s*}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{(.*Celsius}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{output}\PYG{p}{)}
        \PYG{k}{if} \PYG{n}{temp\PYGZus{}match}\PYG{p}{:}
            \PYG{k}{return} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{temp\PYGZus{}match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{k+kc}{None}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}nvme\PYGZus{}health}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{    }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check NVMe specific health\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sudo nvme smart\PYGZhy{}log /dev/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{output}\PYG{p}{,} \PYG{n}{code} \PYG{o}{=} \PYG{n}{run\PYGZus{}command}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{code} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{health\PYGZus{}info} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
        \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{output}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{temperature}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{temp\PYGZus{}match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{line}\PYG{p}{)}
                \PYG{k}{if} \PYG{n}{temp\PYGZus{}match}\PYG{p}{:}
                    \PYG{n}{health\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{temperature}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{temp\PYGZus{}match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
            \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{percentage\PYGZus{}used}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{line}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{percent\PYGZus{}match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+)}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{line}\PYG{p}{)}
                \PYG{k}{if} \PYG{n}{percent\PYGZus{}match}\PYG{p}{:}
                    \PYG{n}{health\PYGZus{}info}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wear\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{percent\PYGZus{}match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{health\PYGZus{}info}
    \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Storage Device Health Report \PYGZhy{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{datetime}\PYG{o}{.}\PYG{n}{now}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{H:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{*} \PYG{l+m+mi}{70}\PYG{p}{)}

    \PYG{n}{devices} \PYG{o}{=} \PYG{n}{get\PYGZus{}block\PYGZus{}devices}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{alerts} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{for} \PYG{n}{device} \PYG{o+ow}{in} \PYG{n}{devices}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{device}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{type}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{disk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
            \PYG{n}{name} \PYG{o}{=} \PYG{n}{device}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{size} \PYG{o}{=} \PYG{n}{device}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{model} \PYG{o}{=} \PYG{n}{device}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Unknown}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Device: /dev/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Model: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{model}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Size: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{size}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check SMART health}
            \PYG{n}{health} \PYG{o}{=} \PYG{n}{check\PYGZus{}smart\PYGZus{}health}\PYG{p}{(}\PYG{n}{name}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Health: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{health}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{k}{if} \PYG{n}{health} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{FAILED}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
                \PYG{n}{alerts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{CRITICAL: Device }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ SMART health failed!}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check temperature}
            \PYG{n}{temp} \PYG{o}{=} \PYG{n}{get\PYGZus{}temperature}\PYG{p}{(}\PYG{n}{name}\PYG{p}{)}
            \PYG{k}{if} \PYG{n}{temp}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Temperature: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{temp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{°C}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{if} \PYG{n}{temp} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{60}\PYG{p}{:}
                    \PYG{n}{alerts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WARNING: Device }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ temperature high: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{temp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{°C}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check NVMe specific data}
            \PYG{k}{if} \PYG{n}{name}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nvme}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{nvme\PYGZus{}health} \PYG{o}{=} \PYG{n}{check\PYGZus{}nvme\PYGZus{}health}\PYG{p}{(}\PYG{n}{name}\PYG{p}{)}
                \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wear\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{nvme\PYGZus{}health}\PYG{p}{:}
                    \PYG{n}{wear} \PYG{o}{=} \PYG{n}{nvme\PYGZus{}health}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wear\PYGZus{}level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Wear Level: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{wear}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n}{wear} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{80}\PYG{p}{:}
                        \PYG{n}{alerts}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WARNING: Device }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ wear level high: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{wear}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Display alerts}
    \PYG{k}{if} \PYG{n}{alerts}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{*} \PYG{l+m+mi}{70}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ALERTS:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{alert} \PYG{o+ow}{in} \PYG{n}{alerts}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{alert}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{All devices appear healthy.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Performance Benchmarking}
\label{\detokenize{storage-devices:performance-benchmarking}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Storage Performance Benchmark Script}

\PYG{n+nv}{DEVICE}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{p}{/dev/sda}\PYG{l+s+si}{\PYGZcb{}}
\PYG{n+nv}{TEST\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/tmp/storage\PYGZus{}test\PYGZdq{}}
\PYG{n+nv}{BLOCK\PYGZus{}SIZES}\PYG{o}{=}\PYG{o}{(}\PYG{l+s+s2}{\PYGZdq{}4k\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}64k\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}1M\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}16M\PYGZdq{}}\PYG{o}{)}

\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Storage Performance Benchmark for }\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}==========================================\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Check if device exists}
\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }!\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error: Device }\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{l+s+s2}{ not found}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{k}{fi}

\PYG{c+c1}{\PYGZsh{} Install fio if not present}
\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }fio\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Installing fio benchmark tool...\PYGZdq{}}
\PYG{+w}{    }sudo\PYG{+w}{ }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }fio
\PYG{k}{fi}

\PYG{c+c1}{\PYGZsh{} Sequential read test}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}n\PYGZhy{}\PYGZhy{}\PYGZhy{} Sequential Read Test \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
sudo\PYG{+w}{ }fio\PYG{+w}{ }\PYGZhy{}\PYGZhy{}name\PYG{o}{=}seq\PYGZus{}read\PYG{+w}{ }\PYGZhy{}\PYGZhy{}filename\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rw\PYG{o}{=}\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bs\PYG{o}{=}1M\PYG{+w}{ }\PYGZhy{}\PYGZhy{}size\PYG{o}{=}1G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}numjobs\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}runtime\PYG{o}{=}\PYG{l+m}{30}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}group\PYGZus{}reporting

\PYG{c+c1}{\PYGZsh{} Sequential write test}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}n\PYGZhy{}\PYGZhy{}\PYGZhy{} Sequential Write Test \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
sudo\PYG{+w}{ }fio\PYG{+w}{ }\PYGZhy{}\PYGZhy{}name\PYG{o}{=}seq\PYGZus{}write\PYG{+w}{ }\PYGZhy{}\PYGZhy{}filename\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rw\PYG{o}{=}write\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bs\PYG{o}{=}1M\PYG{+w}{ }\PYGZhy{}\PYGZhy{}size\PYG{o}{=}1G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}numjobs\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}runtime\PYG{o}{=}\PYG{l+m}{30}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}group\PYGZus{}reporting

\PYG{c+c1}{\PYGZsh{} Random read test}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}n\PYGZhy{}\PYGZhy{}\PYGZhy{} Random Read Test \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
sudo\PYG{+w}{ }fio\PYG{+w}{ }\PYGZhy{}\PYGZhy{}name\PYG{o}{=}rand\PYGZus{}read\PYG{+w}{ }\PYGZhy{}\PYGZhy{}filename\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rw\PYG{o}{=}randread\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bs\PYG{o}{=}4k\PYG{+w}{ }\PYGZhy{}\PYGZhy{}size\PYG{o}{=}1G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}numjobs\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}runtime\PYG{o}{=}\PYG{l+m}{30}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}group\PYGZus{}reporting

\PYG{c+c1}{\PYGZsh{} Random write test}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}n\PYGZhy{}\PYGZhy{}\PYGZhy{} Random Write Test \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
sudo\PYG{+w}{ }fio\PYG{+w}{ }\PYGZhy{}\PYGZhy{}name\PYG{o}{=}rand\PYGZus{}write\PYG{+w}{ }\PYGZhy{}\PYGZhy{}filename\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rw\PYG{o}{=}randwrite\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bs\PYG{o}{=}4k\PYG{+w}{ }\PYGZhy{}\PYGZhy{}size\PYG{o}{=}1G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}numjobs\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}runtime\PYG{o}{=}\PYG{l+m}{30}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}group\PYGZus{}reporting

\PYG{c+c1}{\PYGZsh{} Mixed workload test}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}n\PYGZhy{}\PYGZhy{}\PYGZhy{} Mixed Workload Test (70\PYGZpc{} read, 30\PYGZpc{} write) \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
sudo\PYG{+w}{ }fio\PYG{+w}{ }\PYGZhy{}\PYGZhy{}name\PYG{o}{=}mixed\PYG{+w}{ }\PYGZhy{}\PYGZhy{}filename\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}DEVICE}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rw\PYG{o}{=}randrw\PYG{+w}{ }\PYGZhy{}\PYGZhy{}rwmixread\PYG{o}{=}\PYG{l+m}{70}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bs\PYG{o}{=}4k\PYG{+w}{ }\PYGZhy{}\PYGZhy{}size\PYG{o}{=}1G\PYG{+w}{ }\PYGZhy{}\PYGZhy{}numjobs\PYG{o}{=}\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}runtime\PYG{o}{=}\PYG{l+m}{30}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}group\PYGZus{}reporting
\end{sphinxVerbatim}


\section{Device Selection Guidelines}
\label{\detokenize{storage-devices:device-selection-guidelines}}

\subsection{Performance Considerations}
\label{\detokenize{storage-devices:performance-considerations}}
\sphinxAtStartPar
\sphinxstylestrong{For Operating System:}
* NVMe SSD for best performance
* SATA SSD as budget alternative
* Minimum 256GB capacity

\sphinxAtStartPar
\sphinxstylestrong{For Data Storage:}
* Large HDDs for bulk storage
* SSDs for frequently accessed data
* Consider hybrid approach

\sphinxAtStartPar
\sphinxstylestrong{For Backup:}
* External HDDs for local backup
* Tape drives for archival
* Cloud storage for offsite backup


\subsection{Capacity Planning}
\label{\detokenize{storage-devices:capacity-planning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Storage Capacity Planning Calculator}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{calculate\PYGZus{}storage\PYGZus{}needs}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Storage Capacity Planning Calculator}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{====================================}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Get current usage}
    \PYG{n}{os\PYGZus{}size} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Operating system size (GB): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{50}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{apps\PYGZus{}size} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Applications size (GB): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{100}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{user\PYGZus{}data} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Current user data (GB): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{500}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Growth projections}
    \PYG{n}{growth\PYGZus{}rate} \PYG{o}{=} \PYG{n+nb}{float}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Annual growth rate (}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{20}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mi}{100}
    \PYG{n}{years} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n+nb}{input}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Planning period (years): }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Calculate projected needs}
    \PYG{n}{current\PYGZus{}total} \PYG{o}{=} \PYG{n}{os\PYGZus{}size} \PYG{o}{+} \PYG{n}{apps\PYGZus{}size} \PYG{o}{+} \PYG{n}{user\PYGZus{}data}
    \PYG{n}{projected\PYGZus{}data} \PYG{o}{=} \PYG{n}{user\PYGZus{}data} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{+} \PYG{n}{growth\PYGZus{}rate}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{n}{years}\PYG{p}{)}
    \PYG{n}{projected\PYGZus{}total} \PYG{o}{=} \PYG{n}{os\PYGZus{}size} \PYG{o}{+} \PYG{n}{apps\PYGZus{}size} \PYG{o}{+} \PYG{n}{projected\PYGZus{}data}

    \PYG{c+c1}{\PYGZsh{} Add overhead for performance and backup}
    \PYG{n}{overhead\PYGZus{}factor} \PYG{o}{=} \PYG{l+m+mf}{1.3}  \PYG{c+c1}{\PYGZsh{} 30\PYGZpc{} overhead}
    \PYG{n}{recommended\PYGZus{}capacity} \PYG{o}{=} \PYG{n}{projected\PYGZus{}total} \PYG{o}{*} \PYG{n}{overhead\PYGZus{}factor}

    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Capacity Analysis:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Current total usage: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{current\PYGZus{}total}\PYG{l+s+si}{:}\PYG{l+s+s2}{.1f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ GB}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Projected data growth: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{projected\PYGZus{}data}\PYG{l+s+si}{:}\PYG{l+s+s2}{.1f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ GB}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Projected total usage: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{projected\PYGZus{}total}\PYG{l+s+si}{:}\PYG{l+s+s2}{.1f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ GB}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Recommended capacity: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{recommended\PYGZus{}capacity}\PYG{l+s+si}{:}\PYG{l+s+s2}{.1f}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ GB}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Storage recommendations}
    \PYG{k}{if} \PYG{n}{recommended\PYGZus{}capacity} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{500}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Recommendation: 500GB SSD}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{recommended\PYGZus{}capacity} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{1000}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Recommendation: 1TB SSD or 1TB HDD + 256GB SSD}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{recommended\PYGZus{}capacity} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{4000}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Recommendation: 4TB HDD + 512GB SSD (hybrid)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Recommendation: Multiple drive configuration or NAS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{calculate\PYGZus{}storage\PYGZus{}needs}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Common Issues and Troubleshooting}
\label{\detokenize{storage-devices:common-issues-and-troubleshooting}}
\sphinxAtStartPar
\sphinxstylestrong{Q: My SSD performance has degraded over time. What can I do?}

\sphinxAtStartPar
A: Check TRIM support, run secure erase, monitor wear leveling:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check TRIM support}
sudo\PYG{+w}{ }fstrim\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }/

\PYG{c+c1}{\PYGZsh{} Check SSD health}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }Wear

\PYG{c+c1}{\PYGZsh{} Consider secure erase if needed}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYGZhy{}master\PYG{+w}{ }u\PYG{+w}{ }\PYGZhy{}\PYGZhy{}security\PYGZhy{}set\PYGZhy{}pass\PYG{+w}{ }p\PYG{+w}{ }/dev/sda
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}user\PYGZhy{}master\PYG{+w}{ }u\PYG{+w}{ }\PYGZhy{}\PYGZhy{}security\PYGZhy{}erase\PYG{+w}{ }p\PYG{+w}{ }/dev/sda
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Q: How do I recover data from a failing HDD?}

\sphinxAtStartPar
A: Use ddrescue for data recovery:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install ddrescue}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }gddrescue

\PYG{c+c1}{\PYGZsh{} Create image of failing drive}
sudo\PYG{+w}{ }ddrescue\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }/dev/sda\PYG{+w}{ }/mnt/backup/drive\PYGZus{}image.img\PYG{+w}{ }/mnt/backup/recovery.log

\PYG{c+c1}{\PYGZsh{} Mount image for data recovery}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }loop,ro\PYG{+w}{ }/mnt/backup/drive\PYGZus{}image.img\PYG{+w}{ }/mnt/recovery
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Q: My USB drive is not recognized. How to troubleshoot?}

\sphinxAtStartPar
A: Check USB subsystem and device recognition:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check USB subsystem}
lsusb
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}20

\PYG{c+c1}{\PYGZsh{} Check block devices}
lsblk

\PYG{c+c1}{\PYGZsh{} Try different USB port}
\PYG{c+c1}{\PYGZsh{} Check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\section{Best Practices}
\label{\detokenize{storage-devices:best-practices}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Regular Monitoring}
\sphinxhyphen{} Monitor SMART health data
\sphinxhyphen{} Check temperatures regularly
\sphinxhyphen{} Track performance metrics

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Preventive Maintenance}
\sphinxhyphen{} Enable TRIM for SSDs
\sphinxhyphen{} Regular defragmentation for HDDs (if needed)
\sphinxhyphen{} Clean physical connections

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Protection}
\sphinxhyphen{} Implement RAID where appropriate
\sphinxhyphen{} Regular backups
\sphinxhyphen{} Test restore procedures

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance Optimization}
\sphinxhyphen{} Use appropriate I/O schedulers
\sphinxhyphen{} Optimize filesystem parameters
\sphinxhyphen{} Consider caching strategies

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Lifecycle Management}
\sphinxhyphen{} Plan for device replacement
\sphinxhyphen{} Monitor wear indicators
\sphinxhyphen{} Secure data wiping when disposing

\end{enumerate}


\section{See Also}
\label{\detokenize{storage-devices:see-also}}\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{disk-management::doc}]{\sphinxcrossref{\DUrole{doc}{Disk Management}}}} (\autopageref*{\detokenize{disk-management::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{file-systems::doc}]{\sphinxcrossref{\DUrole{doc}{File Systems}}}} (\autopageref*{\detokenize{file-systems::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{raid-systems::doc}]{\sphinxcrossref{\DUrole{doc}{RAID Systems}}}} (\autopageref*{\detokenize{raid-systems::doc}})

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{volume-management::doc}]{\sphinxcrossref{\DUrole{doc}{Volume Management}}}} (\autopageref*{\detokenize{volume-management::doc}})

\end{itemize}

\sphinxstepscope


\chapter{Ubuntu 22.04 Setup and Configuration}
\label{\detokenize{ubuntu-setup:ubuntu-22-04-setup-and-configuration}}\label{\detokenize{ubuntu-setup::doc}}

\section{Ubuntu 22.04 LTS Storage Setup}
\label{\detokenize{ubuntu-setup:ubuntu-22-04-lts-storage-setup}}
\sphinxAtStartPar
Ubuntu 22.04 LTS (Jammy Jellyfish) provides excellent storage capabilities out of the box. This section covers the complete setup and configuration process for optimal storage management.


\subsection{System Requirements and Preparation}
\label{\detokenize{ubuntu-setup:system-requirements-and-preparation}}

\subsubsection{Minimum System Requirements}
\label{\detokenize{ubuntu-setup:minimum-system-requirements}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Component          | Minimum         | Recommended
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
RAM                | 4 GB           | 8 GB or more
Storage            | 25 GB          | 100 GB or more
CPU                | 2 GHz dual\PYGZhy{}core| 2 GHz quad\PYGZhy{}core
Graphics           | VGA capable    | GPU with driver support
\end{sphinxVerbatim}


\subsubsection{Pre\sphinxhyphen{}Installation Planning}
\label{\detokenize{ubuntu-setup:pre-installation-planning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check hardware compatibility}
lshw\PYG{+w}{ }\PYGZhy{}short
lscpu
lsmem
lsblk

\PYG{c+c1}{\PYGZsh{} Check UEFI/BIOS mode}
\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }/sys/firmware/efi\PYG{+w}{ }\PYG{o}{]}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}UEFI\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}BIOS\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Verify secure boot status}
mokutil\PYG{+w}{ }\PYGZhy{}\PYGZhy{}sb\PYGZhy{}state
\end{sphinxVerbatim}


\subsection{Storage\sphinxhyphen{}Focused Installation}
\label{\detokenize{ubuntu-setup:storage-focused-installation}}

\subsubsection{Partitioning Strategies}
\label{\detokenize{ubuntu-setup:partitioning-strategies}}
\sphinxAtStartPar
\sphinxstylestrong{Option 1: Simple Layout (Recommended for most users)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Device    | Mount Point | Size      | Filesystem | Purpose
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
/dev/sda1 | /boot/efi   | 512 MB    | FAT32      | EFI System
/dev/sda2 | /           | 50\PYGZhy{}100 GB | ext4       | Root filesystem
/dev/sda3 | /home       | Remaining | ext4       | User data
/dev/sda4 | [SWAP]      | 2x RAM    | swap       | Virtual memory
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Option 2: Advanced Layout (For servers/power users)}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Device    | Mount Point | Size      | Filesystem | Purpose
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
/dev/sda1 | /boot/efi   | 512 MB    | FAT32      | EFI System
/dev/sda2 | /boot       | 1 GB      | ext4       | Boot files
/dev/sda3 | /           | 20 GB     | ext4       | Root filesystem
/dev/sda4 | /var        | 20 GB     | ext4       | Variable data
/dev/sda5 | /tmp        | 5 GB      | ext4       | Temporary files
/dev/sda6 | /home       | Remaining | ext4       | User data
/dev/sda7 | [SWAP]      | 2x RAM    | swap       | Virtual memory
\end{sphinxVerbatim}


\subsubsection{Manual Partitioning with fdisk}
\label{\detokenize{ubuntu-setup:manual-partitioning-with-fdisk}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Start partitioning}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Create GPT partition table}
Command:\PYG{+w}{ }g

\PYG{c+c1}{\PYGZsh{} Create EFI partition}
Command:\PYG{+w}{ }n
Partition\PYG{+w}{ }number:\PYG{+w}{ }\PYG{l+m}{1}
First\PYG{+w}{ }sector:\PYG{+w}{ }\PYG{o}{(}default\PYG{o}{)}
Last\PYG{+w}{ }sector:\PYG{+w}{ }+512M
Command:\PYG{+w}{ }t
Partition\PYG{+w}{ }type:\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{o}{(}EFI\PYG{+w}{ }System\PYG{o}{)}

\PYG{c+c1}{\PYGZsh{} Create root partition}
Command:\PYG{+w}{ }n
Partition\PYG{+w}{ }number:\PYG{+w}{ }\PYG{l+m}{2}
First\PYG{+w}{ }sector:\PYG{+w}{ }\PYG{o}{(}default\PYG{o}{)}
Last\PYG{+w}{ }sector:\PYG{+w}{ }+50G
\PYG{c+c1}{\PYGZsh{} (ext4 by default)}

\PYG{c+c1}{\PYGZsh{} Create home partition}
Command:\PYG{+w}{ }n
Partition\PYG{+w}{ }number:\PYG{+w}{ }\PYG{l+m}{3}
First\PYG{+w}{ }sector:\PYG{+w}{ }\PYG{o}{(}default\PYG{o}{)}
Last\PYG{+w}{ }sector:\PYG{+w}{ }\PYG{o}{(}default\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }use\PYG{+w}{ }remaining\PYG{+w}{ }space\PYG{o}{)}

\PYG{c+c1}{\PYGZsh{} Write changes}
Command:\PYG{+w}{ }w
\end{sphinxVerbatim}


\subsubsection{LVM Setup for Flexible Storage}
\label{\detokenize{ubuntu-setup:lvm-setup-for-flexible-storage}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install LVM tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }lvm2

\PYG{c+c1}{\PYGZsh{} Create physical volume}
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }/dev/sda3

\PYG{c+c1}{\PYGZsh{} Create volume group}
sudo\PYG{+w}{ }vgcreate\PYG{+w}{ }ubuntu\PYGZhy{}vg\PYG{+w}{ }/dev/sda3

\PYG{c+c1}{\PYGZsh{} Create logical volumes}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }20G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }root\PYG{+w}{ }ubuntu\PYGZhy{}vg
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }10G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }var\PYG{+w}{ }ubuntu\PYGZhy{}vg
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }5G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }tmp\PYG{+w}{ }ubuntu\PYGZhy{}vg
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}FREE\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }home\PYG{+w}{ }ubuntu\PYGZhy{}vg

\PYG{c+c1}{\PYGZsh{} Format logical volumes}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/root
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/var
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/tmp
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/home
\end{sphinxVerbatim}


\subsection{Post\sphinxhyphen{}Installation Storage Configuration}
\label{\detokenize{ubuntu-setup:post-installation-storage-configuration}}

\subsubsection{Update System and Install Essential Tools}
\label{\detokenize{ubuntu-setup:update-system-and-install-essential-tools}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Update package lists and system}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sudo\PYG{+w}{ }apt\PYG{+w}{ }upgrade\PYG{+w}{ }\PYGZhy{}y

\PYG{c+c1}{\PYGZsh{} Install essential storage tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }gdisk\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }parted\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }gparted\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }lvm2\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }mdadm\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }smartmontools\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }hdparm\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }iotop\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }htop\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }tree\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }ncdu\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }rsync\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }rclone\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }fdupes\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }testdisk\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }ddrescue\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }safecopy

\PYG{c+c1}{\PYGZsh{} Install filesystem tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }xfsprogs\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }btrfs\PYGZhy{}progs\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }ntfs\PYGZhy{}3g\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }exfat\PYGZhy{}fuse\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}
\PYG{+w}{    }exfat\PYGZhy{}utils
\end{sphinxVerbatim}


\subsubsection{Configure Storage Monitoring}
\label{\detokenize{ubuntu-setup:configure-storage-monitoring}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable and configure SMART monitoring}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }smartmontools
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }smartmontools

\PYG{c+c1}{\PYGZsh{} Configure smartd}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/smartd.conf
\PYG{c+c1}{\PYGZsh{} Add: /dev/sda \PYGZhy{}a \PYGZhy{}o on \PYGZhy{}S on \PYGZhy{}s (S/../.././02|L/../../6/03)}

\PYG{c+c1}{\PYGZsh{} Enable automatic TRIM for SSDs}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Verify TRIM is working}
sudo\PYG{+w}{ }fstrim\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }/
\end{sphinxVerbatim}


\subsubsection{Optimize Storage Performance}
\label{\detokenize{ubuntu-setup:optimize-storage-performance}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check current I/O scheduler}
cat\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Set optimal I/O scheduler for SSDs}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Set optimal I/O scheduler for HDDs}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Make scheduler change permanent}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}ACTION==\PYGZdq{}add|change\PYGZdq{}, KERNEL==\PYGZdq{}sd[a\PYGZhy{}z]\PYGZdq{}, ATTR\PYGZob{}queue/rotational\PYGZcb{}==\PYGZdq{}0\PYGZdq{}, ATTR\PYGZob{}queue/scheduler\PYGZcb{}=\PYGZdq{}none\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/udev/rules.d/60\PYGZhy{}ioschedulers.rules
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}ACTION==\PYGZdq{}add|change\PYGZdq{}, KERNEL==\PYGZdq{}sd[a\PYGZhy{}z]\PYGZdq{}, ATTR\PYGZob{}queue/rotational\PYGZcb{}==\PYGZdq{}1\PYGZdq{}, ATTR\PYGZob{}queue/scheduler\PYGZcb{}=\PYGZdq{}mq\PYGZhy{}deadline\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/udev/rules.d/60\PYGZhy{}ioschedulers.rules
\end{sphinxVerbatim}


\subsection{Storage Security Configuration}
\label{\detokenize{ubuntu-setup:storage-security-configuration}}

\subsubsection{Full Disk Encryption with LUKS}
\label{\detokenize{ubuntu-setup:full-disk-encryption-with-luks}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install cryptsetup}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }cryptsetup

\PYG{c+c1}{\PYGZsh{} Encrypt a partition}
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksFormat\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} Open encrypted partition}
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksOpen\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }encrypted\PYGZus{}drive

\PYG{c+c1}{\PYGZsh{} Create filesystem on encrypted partition}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/mapper/encrypted\PYGZus{}drive

\PYG{c+c1}{\PYGZsh{} Mount encrypted partition}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/encrypted
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/mapper/encrypted\PYGZus{}drive\PYG{+w}{ }/mnt/encrypted

\PYG{c+c1}{\PYGZsh{} Add to /etc/crypttab for automatic mounting}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}encrypted\PYGZus{}drive /dev/sdb1 none luks\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/crypttab

\PYG{c+c1}{\PYGZsh{} Add to /etc/fstab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}/dev/mapper/encrypted\PYGZus{}drive /mnt/encrypted ext4 defaults 0 2\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab
\end{sphinxVerbatim}


\subsubsection{File Permissions and Access Control}
\label{\detokenize{ubuntu-setup:file-permissions-and-access-control}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up secure permissions for user data}
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{750}\PYG{+w}{ }/home/username
sudo\PYG{+w}{ }chown\PYG{+w}{ }username:username\PYG{+w}{ }/home/username

\PYG{c+c1}{\PYGZsh{} Create shared directories with proper permissions}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/shared
sudo\PYG{+w}{ }chown\PYG{+w}{ }root:users\PYG{+w}{ }/shared
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{2775}\PYG{+w}{ }/shared

\PYG{c+c1}{\PYGZsh{} Set up ACLs for fine\PYGZhy{}grained control}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }acl

\PYG{c+c1}{\PYGZsh{} Example: Give user read/write access to specific directory}
sudo\PYG{+w}{ }setfacl\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }u:username:rw\PYG{+w}{ }/path/to/directory
sudo\PYG{+w}{ }setfacl\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }g:groupname:r\PYG{+w}{ }/path/to/directory
\end{sphinxVerbatim}


\subsection{Backup and Recovery Setup}
\label{\detokenize{ubuntu-setup:backup-and-recovery-setup}}

\subsubsection{Automated Backup Configuration}
\label{\detokenize{ubuntu-setup:automated-backup-configuration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create backup directories}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/backup/\PYG{o}{\PYGZob{}}daily,weekly,monthly\PYG{o}{\PYGZcb{}}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/backup/system/\PYG{o}{\PYGZob{}}etc,home,var\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Install backup tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }rsync\PYG{+w}{ }borgbackup\PYG{+w}{ }duplicity

\PYG{c+c1}{\PYGZsh{} Create backup script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/backup\PYGZus{}system.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{BACKUP\PYGZus{}DIR=\PYGZdq{}/backup\PYGZdq{}}
\PYG{l+s}{DATE=\PYGZdl{}(date +\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S)}
\PYG{l+s}{LOG\PYGZus{}FILE=\PYGZdq{}/var/log/backup.log\PYGZdq{}}

\PYG{l+s}{log\PYGZus{}message() \PYGZob{}}
\PYG{l+s}{    echo \PYGZdq{}\PYGZdl{}(date \PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}) \PYGZhy{} \PYGZdl{}1\PYGZdq{} | tee \PYGZhy{}a \PYGZdq{}\PYGZdl{}LOG\PYGZus{}FILE\PYGZdq{}}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Backup system configuration}
\PYG{l+s}{backup\PYGZus{}system() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Starting system backup\PYGZdq{}}

\PYG{l+s}{    \PYGZsh{} Backup /etc}
\PYG{l+s}{    rsync \PYGZhy{}av /etc/ \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/system/etc/\PYGZdq{}}

\PYG{l+s}{    \PYGZsh{} Backup user homes}
\PYG{l+s}{    rsync \PYGZhy{}av /home/ \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/system/home/\PYGZdq{} \PYGZhy{}\PYGZhy{}exclude=\PYGZdq{}.cache\PYGZdq{}}

\PYG{l+s}{    \PYGZsh{} Backup important /var directories}
\PYG{l+s}{    rsync \PYGZhy{}av /var/log/ \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/system/var/log/\PYGZdq{}}
\PYG{l+s}{    rsync \PYGZhy{}av /var/lib/dpkg/ \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/system/var/lib/dpkg/\PYGZdq{}}

\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}System backup completed\PYGZdq{}}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Backup user data}
\PYG{l+s}{backup\PYGZus{}data() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Starting data backup\PYGZdq{}}

\PYG{l+s}{    for user\PYGZus{}dir in /home/*; do}
\PYG{l+s}{        if [ \PYGZhy{}d \PYGZdq{}\PYGZdl{}user\PYGZus{}dir\PYGZdq{} ]; then}
\PYG{l+s}{            username=\PYGZdl{}(basename \PYGZdq{}\PYGZdl{}user\PYGZus{}dir\PYGZdq{})}
\PYG{l+s}{            rsync \PYGZhy{}av \PYGZdq{}\PYGZdl{}user\PYGZus{}dir/\PYGZdq{} \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/daily/\PYGZdl{}username/\PYGZdq{} \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{                \PYGZhy{}\PYGZhy{}exclude=\PYGZdq{}.cache\PYGZdq{} \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{                \PYGZhy{}\PYGZhy{}exclude=\PYGZdq{}.thumbnails\PYGZdq{} \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{                \PYGZhy{}\PYGZhy{}exclude=\PYGZdq{}Downloads\PYGZdq{}}
\PYG{l+s}{        fi}
\PYG{l+s}{    done}

\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Data backup completed\PYGZdq{}}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Create compressed archive}
\PYG{l+s}{create\PYGZus{}archive() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Creating compressed archive\PYGZdq{}}

\PYG{l+s}{    tar \PYGZhy{}czf \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/archive/backup\PYGZus{}\PYGZdl{}DATE.tar.gz\PYGZdq{} \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{        \PYGZhy{}C \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR\PYGZdq{} daily system}

\PYG{l+s}{    \PYGZsh{} Remove archives older than 30 days}
\PYG{l+s}{    find \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/archive\PYGZdq{} \PYGZhy{}name \PYGZdq{}*.tar.gz\PYGZdq{} \PYGZhy{}mtime +30 \PYGZhy{}delete}

\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Archive created: backup\PYGZus{}\PYGZdl{}DATE.tar.gz\PYGZdq{}}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Main execution}
\PYG{l+s}{mkdir \PYGZhy{}p \PYGZdq{}\PYGZdl{}BACKUP\PYGZus{}DIR/archive\PYGZdq{}}
\PYG{l+s}{backup\PYGZus{}system}
\PYG{l+s}{backup\PYGZus{}data}
\PYG{l+s}{create\PYGZus{}archive}

\PYG{l+s}{\PYGZsh{} Send notification}
\PYG{l+s}{echo \PYGZdq{}Backup completed on \PYGZdl{}(hostname) at \PYGZdl{}(date)\PYGZdq{} | \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{    mail \PYGZhy{}s \PYGZdq{}Backup Report\PYGZdq{} admin@localhost 2\PYGZgt{}/dev/null || true}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/backup\PYGZus{}system.sh

\PYG{c+c1}{\PYGZsh{} Schedule backup with cron}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 2 * * * /usr/local/bin/backup\PYGZus{}system.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}


\subsection{Storage Monitoring and Alerts}
\label{\detokenize{ubuntu-setup:storage-monitoring-and-alerts}}

\subsubsection{System Health Monitoring}
\label{\detokenize{ubuntu-setup:system-health-monitoring}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create monitoring script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/storage\PYGZus{}monitor.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{LOG\PYGZus{}FILE=\PYGZdq{}/var/log/storage\PYGZus{}monitor.log\PYGZdq{}}
\PYG{l+s}{ALERT\PYGZus{}THRESHOLD=85}
\PYG{l+s}{SMART\PYGZus{}LOG=\PYGZdq{}/var/log/smart\PYGZus{}check.log\PYGZdq{}}

\PYG{l+s}{log\PYGZus{}message() \PYGZob{}}
\PYG{l+s}{    echo \PYGZdq{}\PYGZdl{}(date \PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}) \PYGZhy{} \PYGZdl{}1\PYGZdq{} | tee \PYGZhy{}a \PYGZdq{}\PYGZdl{}LOG\PYGZus{}FILE\PYGZdq{}}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Check disk usage}
\PYG{l+s}{check\PYGZus{}disk\PYGZus{}usage() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Checking disk usage\PYGZdq{}}

\PYG{l+s}{    df \PYGZhy{}h | grep \PYGZhy{}vE \PYGZsq{}\PYGZca{}Filesystem|tmpfs|cdrom\PYGZsq{} | awk \PYGZsq{}\PYGZob{}print \PYGZdl{}5 \PYGZdq{} \PYGZdq{} \PYGZdl{}1 \PYGZdq{} \PYGZdq{} \PYGZdl{}6\PYGZcb{}\PYGZsq{} | while read usage device mount; do}
\PYG{l+s}{        usage\PYGZus{}percent=\PYGZdl{}(echo \PYGZdl{}usage | sed \PYGZsq{}s/\PYGZpc{}//g\PYGZsq{})}

\PYG{l+s}{        if [ \PYGZdl{}usage\PYGZus{}percent \PYGZhy{}ge \PYGZdl{}ALERT\PYGZus{}THRESHOLD ]; then}
\PYG{l+s}{            log\PYGZus{}message \PYGZdq{}ALERT: \PYGZdl{}device (\PYGZdl{}mount) is \PYGZdl{}\PYGZob{}usage\PYGZus{}percent\PYGZcb{}\PYGZpc{} full\PYGZdq{}}
\PYG{l+s}{            echo \PYGZdq{}Disk usage alert: \PYGZdl{}device (\PYGZdl{}mount) is \PYGZdl{}\PYGZob{}usage\PYGZus{}percent\PYGZcb{}\PYGZpc{} full\PYGZdq{} | \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{                mail \PYGZhy{}s \PYGZdq{}Disk Usage Alert \PYGZhy{} \PYGZdl{}(hostname)\PYGZdq{} admin@localhost}
\PYG{l+s}{        fi}
\PYG{l+s}{    done}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Check SMART status}
\PYG{l+s}{check\PYGZus{}smart\PYGZus{}status() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Checking SMART status\PYGZdq{}}

\PYG{l+s}{    for device in /dev/sd[a\PYGZhy{}z]; do}
\PYG{l+s}{        if [ \PYGZhy{}b \PYGZdq{}\PYGZdl{}device\PYGZdq{} ]; then}
\PYG{l+s}{            smart\PYGZus{}status=\PYGZdl{}(smartctl \PYGZhy{}H \PYGZdq{}\PYGZdl{}device\PYGZdq{} 2\PYGZgt{}/dev/null | grep \PYGZdq{}SMART overall\PYGZhy{}health\PYGZdq{} | awk \PYGZsq{}\PYGZob{}print \PYGZdl{}6\PYGZcb{}\PYGZsq{})}

\PYG{l+s}{            if [ \PYGZdq{}\PYGZdl{}smart\PYGZus{}status\PYGZdq{} = \PYGZdq{}PASSED\PYGZdq{} ]; then}
\PYG{l+s}{                log\PYGZus{}message \PYGZdq{}\PYGZdl{}device: SMART status OK\PYGZdq{}}
\PYG{l+s}{            elif [ \PYGZdq{}\PYGZdl{}smart\PYGZus{}status\PYGZdq{} = \PYGZdq{}FAILED\PYGZdq{} ]; then}
\PYG{l+s}{                log\PYGZus{}message \PYGZdq{}ALERT: \PYGZdl{}device SMART status FAILED\PYGZdq{}}
\PYG{l+s}{                echo \PYGZdq{}SMART failure detected on \PYGZdl{}device\PYGZdq{} | \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{                    mail \PYGZhy{}s \PYGZdq{}SMART Failure Alert \PYGZhy{} \PYGZdl{}(hostname)\PYGZdq{} admin@localhost}
\PYG{l+s}{            fi}

\PYG{l+s}{            \PYGZsh{} Log detailed SMART info}
\PYG{l+s}{            smartctl \PYGZhy{}a \PYGZdq{}\PYGZdl{}device\PYGZdq{} \PYGZgt{}\PYGZgt{} \PYGZdq{}\PYGZdl{}SMART\PYGZus{}LOG\PYGZdq{}}
\PYG{l+s}{        fi}
\PYG{l+s}{    done}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Check filesystem errors}
\PYG{l+s}{check\PYGZus{}filesystem\PYGZus{}errors() \PYGZob{}}
\PYG{l+s}{    log\PYGZus{}message \PYGZdq{}Checking filesystem errors\PYGZdq{}}

\PYG{l+s}{    \PYGZsh{} Check dmesg for filesystem errors}
\PYG{l+s}{    if dmesg | grep \PYGZhy{}i \PYGZdq{}error\PYGZbs{}|fault\PYGZbs{}|fail\PYGZdq{} | grep \PYGZhy{}i \PYGZdq{}ext4\PYGZbs{}|xfs\PYGZbs{}|btrfs\PYGZdq{} \PYGZgt{} /dev/null; then}
\PYG{l+s}{        log\PYGZus{}message \PYGZdq{}ALERT: Filesystem errors detected in dmesg\PYGZdq{}}
\PYG{l+s}{        dmesg | grep \PYGZhy{}i \PYGZdq{}error\PYGZbs{}|fault\PYGZbs{}|fail\PYGZdq{} | grep \PYGZhy{}i \PYGZdq{}ext4\PYGZbs{}|xfs\PYGZbs{}|btrfs\PYGZdq{} | \PYGZbs{}\PYGZbs{}}
\PYG{l+s}{            mail \PYGZhy{}s \PYGZdq{}Filesystem Error Alert \PYGZhy{} \PYGZdl{}(hostname)\PYGZdq{} admin@localhost}
\PYG{l+s}{    fi}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Check RAID status (if applicable)}
\PYG{l+s}{check\PYGZus{}raid\PYGZus{}status() \PYGZob{}}
\PYG{l+s}{    if [ \PYGZhy{}f /proc/mdstat ]; then}
\PYG{l+s}{        log\PYGZus{}message \PYGZdq{}Checking RAID status\PYGZdq{}}

\PYG{l+s}{        if grep \PYGZhy{}q \PYGZdq{}\PYGZus{}\PYGZdq{} /proc/mdstat; then}
\PYG{l+s}{            log\PYGZus{}message \PYGZdq{}ALERT: RAID degraded state detected\PYGZdq{}}
\PYG{l+s}{            cat /proc/mdstat | mail \PYGZhy{}s \PYGZdq{}RAID Alert \PYGZhy{} \PYGZdl{}(hostname)\PYGZdq{} admin@localhost}
\PYG{l+s}{        fi}
\PYG{l+s}{    fi}
\PYG{l+s}{\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} Main execution}
\PYG{l+s}{check\PYGZus{}disk\PYGZus{}usage}
\PYG{l+s}{check\PYGZus{}smart\PYGZus{}status}
\PYG{l+s}{check\PYGZus{}filesystem\PYGZus{}errors}
\PYG{l+s}{check\PYGZus{}raid\PYGZus{}status}

\PYG{l+s}{log\PYGZus{}message \PYGZdq{}Storage monitoring completed\PYGZdq{}}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/storage\PYGZus{}monitor.sh

\PYG{c+c1}{\PYGZsh{} Schedule monitoring}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 */6 * * * /usr/local/bin/storage\PYGZus{}monitor.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}


\subsection{Performance Optimization}
\label{\detokenize{ubuntu-setup:performance-optimization}}

\subsubsection{Kernel Parameter Tuning}
\label{\detokenize{ubuntu-setup:kernel-parameter-tuning}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create performance tuning configuration}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/sysctl.d/99\PYGZhy{}storage\PYGZhy{}performance.conf\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} Storage performance optimizations}

\PYG{l+s}{\PYGZsh{} Increase dirty page writeback interval}
\PYG{l+s}{vm.dirty\PYGZus{}writeback\PYGZus{}centisecs = 500}

\PYG{l+s}{\PYGZsh{} Increase dirty page ratio}
\PYG{l+s}{vm.dirty\PYGZus{}ratio = 20}
\PYG{l+s}{vm.dirty\PYGZus{}background\PYGZus{}ratio = 10}

\PYG{l+s}{\PYGZsh{} Optimize memory management}
\PYG{l+s}{vm.swappiness = 10}
\PYG{l+s}{vm.vfs\PYGZus{}cache\PYGZus{}pressure = 50}

\PYG{l+s}{\PYGZsh{} Increase inotify limits}
\PYG{l+s}{fs.inotify.max\PYGZus{}user\PYGZus{}watches = 524288}
\PYG{l+s}{fs.inotify.max\PYGZus{}user\PYGZus{}instances = 256}

\PYG{l+s}{\PYGZsh{} Optimize network buffer sizes (for network storage)}
\PYG{l+s}{net.core.rmem\PYGZus{}max = 134217728}
\PYG{l+s}{net.core.wmem\PYGZus{}max = 134217728}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} Apply settings}
sudo\PYG{+w}{ }sysctl\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/etc/sysctl.d/99\PYGZhy{}storage\PYGZhy{}performance.conf
\end{sphinxVerbatim}


\subsubsection{Mount Options Optimization}
\label{\detokenize{ubuntu-setup:mount-options-optimization}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Optimize /etc/fstab for performance}
sudo\PYG{+w}{ }cp\PYG{+w}{ }/etc/fstab\PYG{+w}{ }/etc/fstab.backup

\PYG{c+c1}{\PYGZsh{} Example optimized fstab entries}
cat\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/fstab\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} Optimized mount options}
\PYG{l+s}{\PYGZsh{} SSD mounts with noatime and discard}
\PYG{l+s}{UUID=your\PYGZhy{}ssd\PYGZhy{}uuid /home ext4 defaults,noatime,discard 0 2}

\PYG{l+s}{\PYGZsh{} HDD mounts with relatime}
\PYG{l+s}{UUID=your\PYGZhy{}hdd\PYGZhy{}uuid /data ext4 defaults,relatime 0 2}

\PYG{l+s}{\PYGZsh{} Temporary filesystems in RAM}
\PYG{l+s}{tmpfs /tmp tmpfs defaults,noatime,mode=1777,size=2G 0 0}
\PYG{l+s}{tmpfs /var/tmp tmpfs defaults,noatime,mode=1777,size=1G 0 0}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\subsection{Frequently Asked Questions}
\label{\detokenize{ubuntu-setup:frequently-asked-questions}}

\subsubsection{Q: How do I check if my system is using UEFI or BIOS?}
\label{\detokenize{ubuntu-setup:q-how-do-i-check-if-my-system-is-using-uefi-or-bios}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these commands to determine your boot mode:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check for UEFI}
\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }/sys/firmware/efi\PYG{+w}{ }\PYG{o}{]}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}UEFI boot\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}BIOS boot\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Check boot mode in more detail}
bootctl\PYG{+w}{ }status

\PYG{c+c1}{\PYGZsh{} List EFI variables (UEFI only)}
efibootmgr\PYG{+w}{ }\PYGZhy{}v
\end{sphinxVerbatim}


\subsubsection{Q: What filesystem should I use for different use cases?}
\label{\detokenize{ubuntu-setup:q-what-filesystem-should-i-use-for-different-use-cases}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Recommended filesystems by use case:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Use Case                | Recommended Filesystem | Reason
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Root partition (/)      | ext4                  | Stable, well\PYGZhy{}tested
Boot partition (/boot)  | ext4                  | Simple, reliable
Home directories        | ext4                  | Good performance
Large files/media       | XFS                   | Better large file handling
Snapshots needed        | Btrfs                 | Built\PYGZhy{}in snapshots
Windows compatibility   | NTFS                  | Cross\PYGZhy{}platform access
USB drives             | exFAT                 | Universal compatibility
\end{sphinxVerbatim}


\subsubsection{Q: How do I resize partitions safely in Ubuntu 22.04?}
\label{\detokenize{ubuntu-setup:q-how-do-i-resize-partitions-safely-in-ubuntu-22-04}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Follow these steps for safe partition resizing:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. BACKUP YOUR DATA FIRST!}

\PYG{c+c1}{\PYGZsh{} 2. For ext4 filesystems:}
\PYG{c+c1}{\PYGZsh{} Unmount the partition}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} Check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} Resize partition with parted}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sda\PYG{+w}{ }resizepart\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} Resize filesystem to match partition}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} 3. For LVM volumes:}
\PYG{c+c1}{\PYGZsh{} Extend physical volume}
sudo\PYG{+w}{ }pvresize\PYG{+w}{ }/dev/sda3

\PYG{c+c1}{\PYGZsh{} Extend logical volume}
sudo\PYG{+w}{ }lvextend\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }+100\PYGZpc{}FREE\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/home

\PYG{c+c1}{\PYGZsh{} Resize filesystem}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/ubuntu\PYGZhy{}vg/home
\end{sphinxVerbatim}


\subsubsection{Q: How do I set up automatic mounting for external drives?}
\label{\detokenize{ubuntu-setup:q-how-do-i-set-up-automatic-mounting-for-external-drives}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Configure automatic mounting:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Get device UUID}
sudo\PYG{+w}{ }blkid\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 2. Create mount point}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/external

\PYG{c+c1}{\PYGZsh{} 3. Add to fstab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}UUID=your\PYGZhy{}device\PYGZhy{}uuid /mnt/external ext4 defaults,user,noauto 0 0\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} 4. Test mounting}
mount\PYG{+w}{ }/mnt/external

\PYG{c+c1}{\PYGZsh{} 5. For auto\PYGZhy{}mount on insertion (using udev rules)}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/udev/rules.d/99\PYGZhy{}usb\PYGZhy{}mount.rules\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} Auto\PYGZhy{}mount USB drives}
\PYG{l+s}{KERNEL==\PYGZdq{}sd[a\PYGZhy{}z][0\PYGZhy{}9]\PYGZdq{}, SUBSYSTEMS==\PYGZdq{}usb\PYGZdq{}, ACTION==\PYGZdq{}add\PYGZdq{}, RUN+=\PYGZdq{}/usr/local/bin/usb\PYGZhy{}mount.sh \PYGZpc{}k\PYGZdq{}}
\PYG{l+s}{KERNEL==\PYGZdq{}sd[a\PYGZhy{}z][0\PYGZhy{}9]\PYGZdq{}, SUBSYSTEMS==\PYGZdq{}usb\PYGZdq{}, ACTION==\PYGZdq{}remove\PYGZdq{}, RUN+=\PYGZdq{}/usr/local/bin/usb\PYGZhy{}unmount.sh \PYGZpc{}k\PYGZdq{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\subsection{Troubleshooting Common Issues}
\label{\detokenize{ubuntu-setup:troubleshooting-common-issues}}

\subsubsection{Boot Issues}
\label{\detokenize{ubuntu-setup:boot-issues}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Repair GRUB bootloader}
sudo\PYG{+w}{ }grub\PYGZhy{}install\PYG{+w}{ }/dev/sda
sudo\PYG{+w}{ }update\PYGZhy{}grub

\PYG{c+c1}{\PYGZsh{} Boot from live USB and repair}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sda2\PYG{+w}{ }/mnt
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sda1\PYG{+w}{ }/mnt/boot/efi
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/dev\PYG{+w}{ }/mnt/dev
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/proc\PYG{+w}{ }/mnt/proc
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/sys\PYG{+w}{ }/mnt/sys
sudo\PYG{+w}{ }chroot\PYG{+w}{ }/mnt
grub\PYGZhy{}install\PYG{+w}{ }/dev/sda
update\PYGZhy{}grub
\PYG{n+nb}{exit}
\end{sphinxVerbatim}


\subsubsection{Filesystem Corruption}
\label{\detokenize{ubuntu-setup:filesystem-corruption}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check and repair ext4 filesystem}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} For automatic repair}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} For interactive repair}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} Check XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}check\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} Repair XFS filesystem}
sudo\PYG{+w}{ }xfs\PYGZus{}repair\PYG{+w}{ }/dev/sda2
\end{sphinxVerbatim}


\subsubsection{Disk Space Issues}
\label{\detokenize{ubuntu-setup:disk-space-issues}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Find large files}
sudo\PYG{+w}{ }find\PYG{+w}{ }/\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+100M\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}9 \PYGZdq{}: \PYGZdq{} \PYGZdl{}5\PYGZcb{}\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Clean package cache}
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoclean
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoremove

\PYG{c+c1}{\PYGZsh{} Clean logs}
sudo\PYG{+w}{ }journalctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}vacuum\PYGZhy{}time\PYG{o}{=}7d

\PYG{c+c1}{\PYGZsh{} Clean thumbnails and cache}
rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYGZti{}/.cache/thumbnails/*
rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYGZti{}/.cache/*
\end{sphinxVerbatim}


\subsubsection{Performance Issues}
\label{\detokenize{ubuntu-setup:performance-issues}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check I/O wait}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Monitor disk activity}
sudo\PYG{+w}{ }iotop

\PYG{c+c1}{\PYGZsh{} Check for filesystem errors}
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }error

\PYG{c+c1}{\PYGZsh{} Analyze slow queries (for databases)}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }sysstat
sar\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{10}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Coding Examples and Scripts}
\label{\detokenize{coding-examples:coding-examples-and-scripts}}\label{\detokenize{coding-examples::doc}}
\sphinxAtStartPar
This section provides practical coding examples, scripts, and automation tools for storage management on Ubuntu 22.04.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id1}}{\hyperref[\detokenize{coding-examples:storage-monitoring-scripts}]{\sphinxcrossref{Storage Monitoring Scripts}}} (\autopageref*{\detokenize{coding-examples:storage-monitoring-scripts}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id2}}{\hyperref[\detokenize{coding-examples:system-storage-health-monitor}]{\sphinxcrossref{System Storage Health Monitor}}} (\autopageref*{\detokenize{coding-examples:system-storage-health-monitor}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id3}}{\hyperref[\detokenize{coding-examples:automated-backup-script}]{\sphinxcrossref{Automated Backup Script}}} (\autopageref*{\detokenize{coding-examples:automated-backup-script}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id4}}{\hyperref[\detokenize{coding-examples:raid-management-tools}]{\sphinxcrossref{RAID Management Tools}}} (\autopageref*{\detokenize{coding-examples:raid-management-tools}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id5}}{\hyperref[\detokenize{coding-examples:raid-status-checker}]{\sphinxcrossref{RAID Status Checker}}} (\autopageref*{\detokenize{coding-examples:raid-status-checker}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id6}}{\hyperref[\detokenize{coding-examples:lvm-automation-scripts}]{\sphinxcrossref{LVM Automation Scripts}}} (\autopageref*{\detokenize{coding-examples:lvm-automation-scripts}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id7}}{\hyperref[\detokenize{coding-examples:dynamic-lv-resize-script}]{\sphinxcrossref{Dynamic LV Resize Script}}} (\autopageref*{\detokenize{coding-examples:dynamic-lv-resize-script}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id8}}{\hyperref[\detokenize{coding-examples:network-storage-utilities}]{\sphinxcrossref{Network Storage Utilities}}} (\autopageref*{\detokenize{coding-examples:network-storage-utilities}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id9}}{\hyperref[\detokenize{coding-examples:nfs-mount-manager}]{\sphinxcrossref{NFS Mount Manager}}} (\autopageref*{\detokenize{coding-examples:nfs-mount-manager}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id10}}{\hyperref[\detokenize{coding-examples:file-system-utilities}]{\sphinxcrossref{File System Utilities}}} (\autopageref*{\detokenize{coding-examples:file-system-utilities}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id11}}{\hyperref[\detokenize{coding-examples:filesystem-health-checker}]{\sphinxcrossref{Filesystem Health Checker}}} (\autopageref*{\detokenize{coding-examples:filesystem-health-checker}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id12}}{\hyperref[\detokenize{coding-examples:performance-testing-scripts}]{\sphinxcrossref{Performance Testing Scripts}}} (\autopageref*{\detokenize{coding-examples:performance-testing-scripts}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id13}}{\hyperref[\detokenize{coding-examples:storage-benchmark-suite}]{\sphinxcrossref{Storage Benchmark Suite}}} (\autopageref*{\detokenize{coding-examples:storage-benchmark-suite}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id14}}{\hyperref[\detokenize{coding-examples:installation-and-usage-instructions}]{\sphinxcrossref{Installation and Usage Instructions}}} (\autopageref*{\detokenize{coding-examples:installation-and-usage-instructions}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id15}}{\hyperref[\detokenize{coding-examples:setting-up-the-environment}]{\sphinxcrossref{Setting Up the Environment}}} (\autopageref*{\detokenize{coding-examples:setting-up-the-environment}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id16}}{\hyperref[\detokenize{coding-examples:script-configuration}]{\sphinxcrossref{Script Configuration}}} (\autopageref*{\detokenize{coding-examples:script-configuration}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id17}}{\hyperref[\detokenize{coding-examples:integration-examples}]{\sphinxcrossref{Integration Examples}}} (\autopageref*{\detokenize{coding-examples:integration-examples}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id18}}{\hyperref[\detokenize{coding-examples:systemd-service-integration}]{\sphinxcrossref{Systemd Service Integration}}} (\autopageref*{\detokenize{coding-examples:systemd-service-integration}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{coding-examples:id19}}{\hyperref[\detokenize{coding-examples:custom-alerts-integration}]{\sphinxcrossref{Custom Alerts Integration}}} (\autopageref*{\detokenize{coding-examples:custom-alerts-integration}})

\end{itemize}

\end{itemize}
\end{sphinxcontents}


\section{Storage Monitoring Scripts}
\label{\detokenize{coding-examples:storage-monitoring-scripts}}

\subsection{System Storage Health Monitor}
\label{\detokenize{coding-examples:system-storage-health-monitor}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Storage Health Monitor for Ubuntu 22.04}
\PYG{l+s+sd}{Monitors disk usage, SMART status, and filesystem health}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{datetime}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{datetime}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{StorageMonitor}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{log\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/var/log/storage\PYGZhy{}monitor.log}\PYG{l+s+s2}{\PYGZdq{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}disk\PYGZus{}usage}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get disk usage for all mounted filesystems\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{df}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}h}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error getting disk usage: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}smart\PYGZus{}status}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{device}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check SMART status for a device\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{smartctl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{device}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PASSED}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o+ow}{in} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}mounted\PYGZus{}devices}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get list of mounted block devices\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lsblk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}J}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{n}{data} \PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{)}
            \PYG{n}{devices} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{device} \PYG{o+ow}{in} \PYG{n}{data}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blockdevices}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{device}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{devices}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{device}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{devices}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{[}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{log\PYGZus{}status}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{message}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Log status message with timestamp\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{timestamp} \PYG{o}{=} \PYG{n}{datetime}\PYG{o}{.}\PYG{n}{now}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{Y\PYGZhy{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{ }\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{H:}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{M:}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{S}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{log\PYGZus{}entry} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{[}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{timestamp}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{] }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{message}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{log\PYGZus{}file}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{n}{f}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{n}{log\PYGZus{}entry}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error writing to log: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{monitor}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Main monitoring function\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Storage Health Monitor \PYGZhy{} Starting...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Check disk usage}
        \PYG{n}{usage} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}disk\PYGZus{}usage}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Disk Usage:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{usage}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Check SMART status for physical drives}
        \PYG{n}{devices} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/sda}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/sdb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/dev/nvme0n1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{k}{for} \PYG{n}{device} \PYG{o+ow}{in} \PYG{n}{devices}\PYG{p}{:}
            \PYG{k}{try}\PYG{p}{:}
                \PYG{n}{smart\PYGZus{}ok} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}smart\PYGZus{}status}\PYG{p}{(}\PYG{n}{device}\PYG{p}{)}
                \PYG{n}{status} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HEALTHY}\PYG{l+s+s2}{\PYGZdq{}} \PYG{k}{if} \PYG{n}{smart\PYGZus{}ok} \PYG{k}{else} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WARNING}\PYG{l+s+s2}{\PYGZdq{}}
                \PYG{n}{message} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SMART status for }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{status}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{message}\PYG{p}{)}
                \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{log\PYGZus{}status}\PYG{p}{(}\PYG{n}{message}\PYG{p}{)}
            \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Could not check }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{device}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Alert on high usage}
        \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{usage}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{parts} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
                \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{5}\PYG{p}{:}
                    \PYG{n}{usage\PYGZus{}pct} \PYG{o}{=} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                    \PYG{k}{if} \PYG{n}{usage\PYGZus{}pct}\PYG{o}{.}\PYG{n}{isdigit}\PYG{p}{(}\PYG{p}{)} \PYG{o+ow}{and} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{usage\PYGZus{}pct}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{90}\PYG{p}{:}
                        \PYG{n}{alert} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HIGH USAGE ALERT: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{usage\PYGZus{}pct}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}
                        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{alert}\PYG{p}{)}
                        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{log\PYGZus{}status}\PYG{p}{(}\PYG{n}{alert}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{monitor} \PYG{o}{=} \PYG{n}{StorageMonitor}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{monitor}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Automated Backup Script}
\label{\detokenize{coding-examples:automated-backup-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Automated Backup Script for Ubuntu 22.04}
\PYG{c+c1}{\PYGZsh{} Supports incremental backups with rotation}

\PYG{n+nb}{set}\PYG{+w}{ }\PYGZhy{}euo\PYG{+w}{ }pipefail

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{SOURCE\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{p}{/home}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{BACKUP\PYGZus{}BASE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/backup\PYGZdq{}}
\PYG{n+nv}{RETENTION\PYGZus{}DAYS}\PYG{o}{=}\PYG{l+m}{30}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/backup.log\PYGZdq{}}
\PYG{n+nv}{DATE}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}
\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BACKUP\PYGZus{}BASE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/backup\PYGZus{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{DATE}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Functions}
log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}prerequisites\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}EUID}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}ERROR: This script must be run as root\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }rsync\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Installing rsync...\PYGZdq{}}
\PYG{+w}{        }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }rsync
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}BASE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

perform\PYGZus{}backup\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Starting backup of }\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{ to }\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Find most recent backup for incremental}
\PYG{+w}{    }\PYG{n+nv}{LATEST\PYGZus{}BACKUP}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}BASE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}maxdepth\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}backup\PYGZus{}*\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{k}{)}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LATEST\PYGZus{}BACKUP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LATEST\PYGZus{}BACKUP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Performing incremental backup from }\PYG{n+nv}{\PYGZdl{}LATEST\PYGZus{}BACKUP}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}link\PYGZhy{}dest\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LATEST\PYGZus{}BACKUP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Performing full backup\PYGZdq{}}
\PYG{+w}{        }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create backup manifest}
\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }sha256sum\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/manifest.sha256}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup completed: }\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/backup\PYGZus{}info.txt}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Source: }\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BACKUP\PYGZus{}DIR}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/backup\PYGZus{}info.txt}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup completed successfully\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

cleanup\PYGZus{}old\PYGZus{}backups\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cleaning up backups older than }\PYG{n+nv}{\PYGZdl{}RETENTION\PYGZus{}DAYS}\PYG{l+s+s2}{ days}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}BASE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}maxdepth\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}backup\PYGZus{}*\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}RETENTION\PYGZus{}DAYS}\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Cleanup completed\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main execution}
main\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== Backup Process Started ===\PYGZdq{}}
\PYG{+w}{    }check\PYGZus{}prerequisites
\PYG{+w}{    }perform\PYGZus{}backup
\PYG{+w}{    }cleanup\PYGZus{}old\PYGZus{}backups
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== Backup Process Completed ===\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Error handling}
\PYG{n+nb}{trap}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}log\PYGZus{}message \PYGZdq{}ERROR: Backup failed on line \PYGZdl{}LINENO\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }ERR

main\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}@}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\section{RAID Management Tools}
\label{\detokenize{coding-examples:raid-management-tools}}

\subsection{RAID Status Checker}
\label{\detokenize{coding-examples:raid-status-checker}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{RAID Status Checker for Ubuntu 22.04}
\PYG{l+s+sd}{Monitors software RAID arrays and hardware RAID controllers}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{re}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{pathlib}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{RAIDMonitor}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mdstat\PYGZus{}path} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/proc/mdstat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}software\PYGZus{}raid}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check software RAID status from /proc/mdstat\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mdstat\PYGZus{}path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{no\PYGZus{}raid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{message}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{No software RAID detected}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}

        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mdstat\PYGZus{}path}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{n}{content} \PYG{o}{=} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}

            \PYG{n}{arrays} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
            \PYG{n}{lines} \PYG{o}{=} \PYG{n}{content}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

            \PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{lines}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n}{line}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{md}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{array\PYGZus{}info} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{parse\PYGZus{}md\PYGZus{}line}\PYG{p}{(}\PYG{n}{line}\PYG{p}{,} \PYG{n}{lines}\PYG{p}{[}\PYG{n}{i}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]}\PYG{p}{)}
                    \PYG{n}{arrays}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{array\PYGZus{}info}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{active}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{arrays}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{arrays}\PYG{p}{\PYGZcb{}}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{error}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{message}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{parse\PYGZus{}md\PYGZus{}line}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{md\PYGZus{}line}\PYG{p}{,} \PYG{n}{following\PYGZus{}lines}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Parse mdstat line for array information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{parts} \PYG{o}{=} \PYG{n}{md\PYGZus{}line}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{array\PYGZus{}name} \PYG{o}{=} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{n}{array\PYGZus{}status} \PYG{o}{=} \PYG{n}{parts}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{parts}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{2} \PYG{k}{else} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{unknown}\PYG{l+s+s2}{\PYGZdq{}}

        \PYG{c+c1}{\PYGZsh{} Look for status in following lines}
        \PYG{n}{status\PYGZus{}line} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{k}{for} \PYG{n}{line} \PYG{o+ow}{in} \PYG{n}{following\PYGZus{}lines}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)} \PYG{o+ow}{and} \PYG{o+ow}{not} \PYG{n}{line}\PYG{o}{.}\PYG{n}{startswith}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{md}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{status\PYGZus{}line} \PYG{o}{=} \PYG{n}{line}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}
                \PYG{k}{break}

        \PYG{c+c1}{\PYGZsh{} Check for rebuild/sync status}
        \PYG{n}{rebuild\PYGZus{}match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{[.*}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{]}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{s+.*=}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{s*(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+)}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{status\PYGZus{}line}\PYG{p}{)}

        \PYG{k}{return} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{array\PYGZus{}name}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{array\PYGZus{}status}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{devices}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{extract\PYGZus{}devices}\PYG{p}{(}\PYG{n}{md\PYGZus{}line}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{rebuilding}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{rebuild\PYGZus{}match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{if} \PYG{n}{rebuild\PYGZus{}match} \PYG{k}{else} \PYG{k+kc}{None}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{details}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{status\PYGZus{}line}
        \PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{extract\PYGZus{}devices}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{md\PYGZus{}line}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Extract device list from md line\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{c+c1}{\PYGZsh{} Simple extraction \PYGZhy{} could be enhanced}
        \PYG{n}{devices} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{findall}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{[a\PYGZhy{}z]+}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{[}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{md\PYGZus{}line}\PYG{p}{)}
        \PYG{k}{return} \PYG{p}{[}\PYG{n}{dev}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{k}{for} \PYG{n}{dev} \PYG{o+ow}{in} \PYG{n}{devices}\PYG{p}{]}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}hardware\PYGZus{}raid}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check hardware RAID controllers\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{controllers} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{c+c1}{\PYGZsh{} Check for MegaRAID}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{megacli}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}AdpAllInfo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}aALL}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
                \PYG{n}{controllers}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MegaRAID}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{detected}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{FileNotFoundError}\PYG{p}{:}
            \PYG{k}{pass}

        \PYG{c+c1}{\PYGZsh{} Check for HP Smart Array}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hpacucli}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ctrl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{all}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{show}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
                \PYG{n}{controllers}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HP Smart Array}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{status}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{detected}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{FileNotFoundError}\PYG{p}{:}
            \PYG{k}{pass}

        \PYG{k}{return} \PYG{n}{controllers}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}full\PYGZus{}status}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get complete RAID status report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{timestamp}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{stdout}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{software\PYGZus{}raid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}software\PYGZus{}raid}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{hardware\PYGZus{}raid}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}hardware\PYGZus{}raid}\PYG{p}{(}\PYG{p}{)}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{return} \PYG{n}{report}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{monitor} \PYG{o}{=} \PYG{n}{RAIDMonitor}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{status} \PYG{o}{=} \PYG{n}{monitor}\PYG{o}{.}\PYG{n}{get\PYGZus{}full\PYGZus{}status}\PYG{p}{(}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{status}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{LVM Automation Scripts}
\label{\detokenize{coding-examples:lvm-automation-scripts}}

\subsection{Dynamic LV Resize Script}
\label{\detokenize{coding-examples:dynamic-lv-resize-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Dynamic Logical Volume Resize Script}
\PYG{c+c1}{\PYGZsh{} Automatically extends LV when usage exceeds threshold}

\PYG{n+nb}{set}\PYG{+w}{ }\PYGZhy{}euo\PYG{+w}{ }pipefail

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{THRESHOLD}\PYG{o}{=}\PYG{l+m}{85}
\PYG{n+nv}{EXTEND\PYGZus{}SIZE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}1G\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/lv\PYGZhy{}autoresize.log\PYGZdq{}}

log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}lv\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{lv\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }usage

\PYG{+w}{    }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}df\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}NR==2 \PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZpc{}//\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

extend\PYGZus{}logical\PYGZus{}volume\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{lv\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{vg\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{lv\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Extending }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{ by }\PYG{n+nv}{\PYGZdl{}EXTEND\PYGZus{}SIZE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check VG free space}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }free\PYGZus{}space
\PYG{+w}{    }\PYG{n+nv}{free\PYGZus{}space}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}vgs\PYG{+w}{ }\PYGZhy{}\PYGZhy{}noheadings\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }vg\PYGZus{}free\PYG{+w}{ }\PYGZhy{}\PYGZhy{}units\PYG{+w}{ }g\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}vg\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}1\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/g//\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{(}\PYG{o}{(}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}free\PYGZus{}space}\PYG{l+s+s2}{ \PYGZlt{} 1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }bc\PYG{+w}{ }\PYGZhy{}l\PYG{k}{)}\PYG{+w}{ }\PYG{o}{)}\PYG{o}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERROR: Not enough free space in VG }\PYG{n+nv}{\PYGZdl{}vg\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Extend LV}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }lvextend\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{+}\PYG{n+nv}{\PYGZdl{}EXTEND\PYGZus{}SIZE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/dev/}\PYG{n+nv}{\PYGZdl{}vg\PYGZus{}name}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Resize filesystem}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }resize2fs\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/dev/}\PYG{n+nv}{\PYGZdl{}vg\PYGZus{}name}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Successfully extended }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{        }\PYG{k}{else}
\PYG{+w}{            }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERROR: Failed to resize filesystem for }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERROR: Failed to extend LV }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

monitor\PYGZus{}logical\PYGZus{}volumes\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get all LVs}
\PYG{+w}{    }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nv}{IFS}\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }line\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{n+nb}{local}\PYG{+w}{ }lv\PYGZus{}path\PYG{+w}{ }vg\PYGZus{}name\PYG{+w}{ }lv\PYGZus{}name
\PYG{+w}{        }\PYG{n+nv}{lv\PYGZus{}path}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}1\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{        }\PYG{n+nv}{vg\PYGZus{}name}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}2\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{        }\PYG{n+nv}{lv\PYGZus{}name}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }!\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}LV\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }usage
\PYG{+w}{            }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}check\PYGZus{}lv\PYGZus{}usage\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}THRESHOLD}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{WARNING: }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{ usage is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}, threshold is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{THRESHOLD}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{                }extend\PYGZus{}logical\PYGZus{}volume\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}vg\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{INFO: }\PYG{n+nv}{\PYGZdl{}lv\PYGZus{}path}\PYG{l+s+s2}{ usage is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} (OK)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}\PYG{+w}{ }\PYGZlt{}\PYG{+w}{ }\PYGZlt{}\PYG{o}{(}lvs\PYG{+w}{ }\PYGZhy{}\PYGZhy{}noheadings\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }lv\PYGZus{}path,vg\PYGZus{}name,lv\PYGZus{}name\PYG{o}{)}
\PYG{o}{\PYGZcb{}}

main\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}EUID}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}This script must be run as root\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== LV Auto\PYGZhy{}resize Monitor Started ===\PYGZdq{}}
\PYG{+w}{    }monitor\PYGZus{}logical\PYGZus{}volumes
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== LV Auto\PYGZhy{}resize Monitor Completed ===\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

main\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}@}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\section{Network Storage Utilities}
\label{\detokenize{coding-examples:network-storage-utilities}}

\subsection{NFS Mount Manager}
\label{\detokenize{coding-examples:nfs-mount-manager}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{NFS Mount Manager for Ubuntu 22.04}
\PYG{l+s+sd}{Manages NFS mounts with health checking and auto\PYGZhy{}recovery}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{yaml}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{pathlib}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{NFSManager}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{config\PYGZus{}file}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/etc/nfs\PYGZhy{}mounts.yaml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config\PYGZus{}file} \PYG{o}{=} \PYG{n}{config\PYGZus{}file}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{load\PYGZus{}config}\PYG{p}{(}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{load\PYGZus{}config}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Load NFS mount configuration\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{default\PYGZus{}config} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}
                \PYG{p}{\PYGZob{}}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{192.168.1.100}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{export}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/export/shared}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/mnt/nfs\PYGZhy{}shared}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{options}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rw,sync,hard,intr}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{auto\PYGZus{}mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k+kc}{True}
                \PYG{p}{\PYGZcb{}}
            \PYG{p}{]}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timeout}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{30}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{retry\PYGZus{}count}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{3}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{if} \PYG{n}{Path}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config\PYGZus{}file}\PYG{p}{)}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{try}\PYG{p}{:}
                \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config\PYGZus{}file}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                    \PYG{k}{return} \PYG{n}{yaml}\PYG{o}{.}\PYG{n}{safe\PYGZus{}load}\PYG{p}{(}\PYG{n}{f}\PYG{p}{)}
            \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error loading config: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{return} \PYG{n}{default\PYGZus{}config}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{save\PYGZus{}config}\PYG{p}{(}\PYG{n}{default\PYGZus{}config}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{default\PYGZus{}config}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{save\PYGZus{}config}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{config}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Save configuration to file\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config\PYGZus{}file}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{n}{yaml}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{config}\PYG{p}{,} \PYG{n}{f}\PYG{p}{,} \PYG{n}{default\PYGZus{}flow\PYGZus{}style}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Error saving config: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{check\PYGZus{}nfs\PYGZus{}server}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{server}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check if NFS server is reachable\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ping}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}W}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{server}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{is\PYGZus{}mounted}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check if mountpoint is currently mounted\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}q}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{]}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{mount\PYGZus{}nfs}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{mount\PYGZus{}config}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Mount an NFS share\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{server} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{export} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{export}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{mountpoint} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
        \PYG{n}{options} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{options}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rw,sync}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Mounting }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{server}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{export}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ \PYGZhy{}\PYGZgt{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mountpoint}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Create mountpoint if it doesn\PYGZsq{}t exist}
        \PYG{n}{Path}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{parents}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Check if already mounted}
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{is\PYGZus{}mounted}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Already mounted: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mountpoint}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{True}

        \PYG{c+c1}{\PYGZsh{} Check server connectivity}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}nfs\PYGZus{}server}\PYG{p}{(}\PYG{n}{server}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  ERROR: Cannot reach NFS server }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{server}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

        \PYG{c+c1}{\PYGZsh{} Mount the share}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{nfs\PYGZus{}source} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{server}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{export}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{n}{cmd} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{nfs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{options}\PYG{p}{,} \PYG{n}{nfs\PYGZus{}source}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{]}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Successfully mounted }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mountpoint}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{return} \PYG{k+kc}{True}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  ERROR: Mount failed: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{return} \PYG{k+kc}{False}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  ERROR: Exception during mount: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{unmount\PYGZus{}nfs}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Unmount an NFS share\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{is\PYGZus{}mounted}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{umount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{mountpoint}\PYG{p}{]}\PYG{p}{,}
                                      \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
                \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Successfully unmounted }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mountpoint}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                    \PYG{k}{return} \PYG{k+kc}{True}
                \PYG{k}{else}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERROR: Unmount failed: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                    \PYG{k}{return} \PYG{k+kc}{False}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mountpoint}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ is not mounted}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{return} \PYG{k+kc}{True}
        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERROR: Exception during unmount: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{e}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{return} \PYG{k+kc}{False}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{mount\PYGZus{}all}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Mount all configured NFS shares\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{success\PYGZus{}count} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{total\PYGZus{}count} \PYG{o}{=} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{mount\PYGZus{}config} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{mount\PYGZus{}config}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{auto\PYGZus{}mount}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mount\PYGZus{}nfs}\PYG{p}{(}\PYG{n}{mount\PYGZus{}config}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{success\PYGZus{}count} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{1}

        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Mounted }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{success\PYGZus{}count}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{total\PYGZus{}count}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ NFS shares}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{success\PYGZus{}count} \PYG{o}{==} \PYG{n}{total\PYGZus{}count}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{unmount\PYGZus{}all}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Unmount all configured NFS shares\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{for} \PYG{n}{mount\PYGZus{}config} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{unmount\PYGZus{}nfs}\PYG{p}{(}\PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{health\PYGZus{}check}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Check health of all NFS mounts\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NFS Mount Health Check}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{*} \PYG{l+m+mi}{50}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{mount\PYGZus{}config} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mounts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
            \PYG{n}{server} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{server}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{mountpoint} \PYG{o}{=} \PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mountpoint}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Checking }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{server}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{mount\PYGZus{}config}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{export}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check server}
            \PYG{n}{server\PYGZus{}ok} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{check\PYGZus{}nfs\PYGZus{}server}\PYG{p}{(}\PYG{n}{server}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Server reachable: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YES}\PYG{l+s+s1}{\PYGZsq{}}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{n}{server\PYGZus{}ok}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check mount}
            \PYG{n}{mounted} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{is\PYGZus{}mounted}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{)}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Mounted: }\PYG{l+s+si}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{YES}\PYG{l+s+s1}{\PYGZsq{}}\PYG{+w}{ }\PYG{k}{if}\PYG{+w}{ }\PYG{n}{mounted}\PYG{+w}{ }\PYG{k}{else}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NO}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Check accessibility}
            \PYG{k}{if} \PYG{n}{mounted}\PYG{p}{:}
                \PYG{k}{try}\PYG{p}{:}
                    \PYG{n}{test\PYGZus{}file} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{mountpoint}\PYG{p}{)} \PYG{o}{/} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.nfs\PYGZus{}test}\PYG{l+s+s1}{\PYGZsq{}}
                    \PYG{n}{test\PYGZus{}file}\PYG{o}{.}\PYG{n}{touch}\PYG{p}{(}\PYG{p}{)}
                    \PYG{n}{test\PYGZus{}file}\PYG{o}{.}\PYG{n}{unlink}\PYG{p}{(}\PYG{p}{)}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Accessible: YES}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Accessible: NO}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

            \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{)} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{2}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: nfs\PYGZhy{}manager.py }\PYG{l+s+s2}{\PYGZob{}}\PYG{l+s+s2}{mount|unmount|health|mount\PYGZhy{}all|unmount\PYGZhy{}all\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{sys}\PYG{o}{.}\PYG{n}{exit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{os}\PYG{o}{.}\PYG{n}{geteuid}\PYG{p}{(}\PYG{p}{)} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{This script must be run as root}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{sys}\PYG{o}{.}\PYG{n}{exit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{n}{manager} \PYG{o}{=} \PYG{n}{NFSManager}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{command} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}

    \PYG{k}{if} \PYG{n}{command} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mount\PYGZhy{}all}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
        \PYG{n}{manager}\PYG{o}{.}\PYG{n}{mount\PYGZus{}all}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{command} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{unmount\PYGZhy{}all}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
        \PYG{n}{manager}\PYG{o}{.}\PYG{n}{unmount\PYGZus{}all}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{elif} \PYG{n}{command} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{health}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
        \PYG{n}{manager}\PYG{o}{.}\PYG{n}{health\PYGZus{}check}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Unknown command: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{command}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{File System Utilities}
\label{\detokenize{coding-examples:file-system-utilities}}

\subsection{Filesystem Health Checker}
\label{\detokenize{coding-examples:filesystem-health-checker}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Comprehensive Filesystem Health Checker for Ubuntu 22.04}

\PYG{n+nb}{set}\PYG{+w}{ }\PYGZhy{}euo\PYG{+w}{ }pipefail

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/filesystem\PYGZhy{}health.log\PYGZdq{}}
\PYG{n+nv}{REPORT\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/tmp/filesystem\PYGZhy{}health\PYGZhy{}report.txt\PYGZdq{}}

log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}filesystem\PYGZus{}errors\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{device}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}3}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Checking filesystem errors for }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ (}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{)}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }ext4\PYG{p}{|}ext3\PYG{p}{|}ext2\PYG{o}{)}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Check for ext filesystem errors}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }error\PYGZus{}count
\PYG{+w}{            }\PYG{n+nv}{error\PYGZus{}count}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}tune2fs\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Filesystem errors behavior\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }dumpe2fs\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}has\PYGZus{}journal\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  Journal filesystem detected\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}

\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Force check if needed}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }mount\PYGZus{}count\PYG{+w}{ }max\PYGZus{}count
\PYG{+w}{            }\PYG{n+nv}{mount\PYGZus{}count}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}tune2fs\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Mount count:\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nv}{max\PYGZus{}count}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}tune2fs\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Maximum mount count:\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}4\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}max\PYGZus{}count}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}count}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}max\PYGZus{}count}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  WARNING: Mount count (}\PYG{n+nv}{\PYGZdl{}mount\PYGZus{}count}\PYG{l+s+s2}{) exceeds maximum (}\PYG{n+nv}{\PYGZdl{}max\PYGZus{}count}\PYG{l+s+s2}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }xfs\PYG{o}{)}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Check XFS filesystem}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }xfs\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}\PYG{p}{\PYGZam{}}\PYG{l+m}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  XFS filesystem appears healthy\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{else}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  WARNING: XFS filesystem check failed\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}

\PYG{+w}{        }btrfs\PYG{o}{)}
\PYG{+w}{            }\PYG{c+c1}{\PYGZsh{} Check Btrfs filesystem}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }btrfs\PYG{+w}{ }filesystem\PYG{+w}{ }show\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}\PYG{p}{\PYGZam{}}\PYG{l+m}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }\PYG{n+nb}{local}\PYG{+w}{ }errors
\PYG{+w}{                }\PYG{n+nv}{errors}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}btrfs\PYG{+w}{ }device\PYG{+w}{ }stats\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}err\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0\PYGZdq{}}\PYG{k}{)}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Btrfs error count: }\PYG{n+nv}{\PYGZdl{}errors}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}disk\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Checking disk usage patterns\PYGZdq{}}

\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nv}{IFS}\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }line\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}\PYGZpc{} /\PYGZdq{}}*\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }usage
\PYG{+w}{            }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZpc{}//\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }mountpoint
\PYG{+w}{            }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}6\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{90}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  CRITICAL: }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{elif}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{80}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  WARNING: }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}inode\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Checking inode usage\PYGZdq{}}

\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nv}{IFS}\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }line\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }*\PYG{l+s+s2}{\PYGZdq{}\PYGZpc{} /\PYGZdq{}}*\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }usage
\PYG{+w}{            }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}5\PYGZcb{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZpc{}//\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }mountpoint
\PYG{+w}{            }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}6\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{90}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  CRITICAL: }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ inodes }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} used}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{elif}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{l+m}{80}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  WARNING: }\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ inodes }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} used}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

generate\PYGZus{}report\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{o}{\PYGZob{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Filesystem Health Report\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Generated: }\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}==========================================\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}DISK USAGE:\PYGZdq{}}
\PYG{+w}{        }df\PYG{+w}{ }\PYGZhy{}h
\PYG{+w}{        }\PYG{n+nb}{echo}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}INODE USAGE:\PYGZdq{}}
\PYG{+w}{        }df\PYG{+w}{ }\PYGZhy{}i
\PYG{+w}{        }\PYG{n+nb}{echo}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}MOUNTED FILESYSTEMS:\PYGZdq{}}
\PYG{+w}{        }mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZca{}/dev/\PYGZsq{}}
\PYG{+w}{        }\PYG{n+nb}{echo}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}FILESYSTEM TYPES:\PYGZdq{}}
\PYG{+w}{        }lsblk\PYG{+w}{ }\PYGZhy{}f
\PYG{+w}{        }\PYG{n+nb}{echo}

\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RECENT LOG ENTRIES:\PYGZdq{}}
\PYG{+w}{        }tail\PYG{+w}{ }\PYGZhy{}20\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}REPORT\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Health report generated: }\PYG{n+nv}{\PYGZdl{}REPORT\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

main\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}EUID}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}This script should be run as root for complete checks\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== Filesystem Health Check Started ===\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Get mounted filesystems}
\PYG{+w}{    }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nv}{IFS}\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }line\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYG{o}{=}\PYG{+w}{ }/dev/*\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }device\PYG{+w}{ }fstype\PYG{+w}{ }mountpoint
\PYG{+w}{            }\PYG{n+nv}{device}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}1\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nv}{fstype}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}3\PYGZcb{}\PYGZsq{}}\PYG{k}{)}
\PYG{+w}{            }\PYG{n+nv}{mountpoint}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}line}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }awk\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZob{}print \PYGZdl{}2\PYGZcb{}\PYGZsq{}}\PYG{k}{)}

\PYG{+w}{            }check\PYGZus{}filesystem\PYGZus{}errors\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}fstype}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}\PYG{+w}{ }\PYGZlt{}\PYG{+w}{ }\PYGZlt{}\PYG{o}{(}mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZca{}/dev/\PYGZsq{}}\PYG{o}{)}

\PYG{+w}{    }check\PYGZus{}disk\PYGZus{}usage
\PYG{+w}{    }check\PYGZus{}inode\PYGZus{}usage
\PYG{+w}{    }generate\PYGZus{}report

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}=== Filesystem Health Check Completed ===\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Health check completed. Report available at: }\PYG{n+nv}{\PYGZdl{}REPORT\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Log file: }\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

main\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}@}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\section{Performance Testing Scripts}
\label{\detokenize{coding-examples:performance-testing-scripts}}

\subsection{Storage Benchmark Suite}
\label{\detokenize{coding-examples:storage-benchmark-suite}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/usr/bin/env python3}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{Storage Performance Benchmark Suite for Ubuntu 22.04}
\PYG{l+s+sd}{Tests various storage scenarios and generates performance reports}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{subprocess}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{time}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{json}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{os}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{sys}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{pathlib}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{Path}

\PYG{k}{class}\PYG{+w}{ }\PYG{n+nc}{StorageBenchmark}\PYG{p}{:}
    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{test\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/tmp/storage\PYGZus{}test}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir} \PYG{o}{=} \PYG{n}{Path}\PYG{p}{(}\PYG{n}{test\PYGZus{}dir}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{n}{exist\PYGZus{}ok}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}dd\PYGZus{}test}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{test\PYGZus{}name}\PYG{p}{,} \PYG{n}{block\PYGZus{}size}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{count}\PYG{o}{=}\PYG{l+m+mi}{1024}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run DD\PYGZhy{}based I/O test\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{test\PYGZus{}file} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.dat}\PYG{l+s+s2}{\PYGZdq{}}

        \PYG{c+c1}{\PYGZsh{} Write test}
        \PYG{n}{write\PYGZus{}start} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{cmd} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{if=/dev/zero}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{of=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}file}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
               \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bs=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{block\PYGZus{}size}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{count=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{count}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{conv=fdatasync}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

        \PYG{k}{try}\PYG{p}{:}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{n}{write\PYGZus{}time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{write\PYGZus{}start}

            \PYG{c+c1}{\PYGZsh{} Parse DD output for speed}
            \PYG{n}{write\PYGZus{}speed} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{parse\PYGZus{}dd\PYGZus{}output}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Read test}
            \PYG{n}{read\PYGZus{}start} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)}
            \PYG{n}{cmd} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dd}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{if=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}file}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{of=/dev/null}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bs=}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{block\PYGZus{}size}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
            \PYG{n}{read\PYGZus{}time} \PYG{o}{=} \PYG{n}{time}\PYG{o}{.}\PYG{n}{time}\PYG{p}{(}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{read\PYGZus{}start}

            \PYG{n}{read\PYGZus{}speed} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{parse\PYGZus{}dd\PYGZus{}output}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Cleanup}
            \PYG{n}{test\PYGZus{}file}\PYG{o}{.}\PYG{n}{unlink}\PYG{p}{(}\PYG{p}{)}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{write\PYGZus{}time}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{read\PYGZus{}time}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write\PYGZus{}speed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{write\PYGZus{}speed}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read\PYGZus{}speed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{read\PYGZus{}speed}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{block\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{block\PYGZus{}size}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{count}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{block\PYGZus{}size}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{p}{\PYGZcb{}}

        \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{e}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{e}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{parse\PYGZus{}dd\PYGZus{}output}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{dd\PYGZus{}stderr}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Parse DD output to extract transfer rate\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{re}

        \PYG{c+c1}{\PYGZsh{} Look for patterns like \PYGZdq{}1.0 GB/s\PYGZdq{} or \PYGZdq{}500 MB/s\PYGZdq{}}
        \PYG{n}{pattern} \PYG{o}{=} \PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d+}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{.?}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{d*)}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{s*([KMGT]?B/s)}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{match} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{n}{pattern}\PYG{p}{,} \PYG{n}{dd\PYGZus{}stderr}\PYG{p}{)}

        \PYG{k}{if} \PYG{n}{match}\PYG{p}{:}
            \PYG{k}{return} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{match}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
        \PYG{k}{return} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Unknown}\PYG{l+s+s2}{\PYGZdq{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}fio\PYGZus{}test}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{test\PYGZus{}name}\PYG{p}{,} \PYG{n}{job\PYGZus{}config}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run FIO benchmark if available\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Check if fio is available}
            \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{which}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{check}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Create FIO job file}
            \PYG{n}{job\PYGZus{}file} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}name}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.fio}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{job\PYGZus{}file}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
                \PYG{n}{f}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{n}{job\PYGZus{}config}\PYG{p}{)}

            \PYG{c+c1}{\PYGZsh{} Run FIO}
            \PYG{n}{result} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{job\PYGZus{}file}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}output\PYGZhy{}format=json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                                  \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

            \PYG{k}{if} \PYG{n}{result}\PYG{o}{.}\PYG{n}{returncode} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{:}
                \PYG{n}{fio\PYGZus{}data} \PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{loads}\PYG{p}{(}\PYG{n}{result}\PYG{o}{.}\PYG{n}{stdout}\PYG{p}{)}
                \PYG{n}{job\PYGZus{}file}\PYG{o}{.}\PYG{n}{unlink}\PYG{p}{(}\PYG{p}{)}
                \PYG{k}{return} \PYG{n}{fio\PYGZus{}data}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{result}\PYG{o}{.}\PYG{n}{stderr}\PYG{p}{\PYGZcb{}}

        \PYG{k}{except} \PYG{p}{(}\PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{CalledProcessError}\PYG{p}{,} \PYG{n+ne}{FileNotFoundError}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FIO not available}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}sequential\PYGZus{}tests}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run sequential I/O tests\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Running sequential I/O tests...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Various block sizes}
        \PYG{n}{block\PYGZus{}sizes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4K}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{64K}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

        \PYG{k}{for} \PYG{n}{bs} \PYG{o+ow}{in} \PYG{n}{block\PYGZus{}sizes}\PYG{p}{:}
            \PYG{n}{test\PYGZus{}name} \PYG{o}{=} \PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sequential\PYGZus{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bs}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Testing }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bs}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ blocks...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{n}{result} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{run\PYGZus{}dd\PYGZus{}test}\PYG{p}{(}\PYG{n}{test\PYGZus{}name}\PYG{p}{,} \PYG{n}{bs}\PYG{p}{,} \PYG{l+m+mi}{256} \PYG{k}{if} \PYG{n}{bs} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4M}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{else} \PYG{l+m+mi}{1024}\PYG{p}{)}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results}\PYG{p}{[}\PYG{n}{test\PYGZus{}name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{result}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}random\PYGZus{}tests}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run random I/O tests using FIO\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Running random I/O tests...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Random read test}
        \PYG{n}{random\PYGZus{}read\PYGZus{}config} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{[random\PYGZus{}read]}
\PYG{l+s+s2}{ioengine=libaio}
\PYG{l+s+s2}{rw=randread}
\PYG{l+s+s2}{bs=4k}
\PYG{l+s+s2}{direct=1}
\PYG{l+s+s2}{size=100M}
\PYG{l+s+s2}{numjobs=1}
\PYG{l+s+s2}{runtime=30}
\PYG{l+s+s2}{group\PYGZus{}reporting}
\PYG{l+s+s2}{filename=}\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s2}{/random\PYGZus{}read.dat}
\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir}\PYG{p}{)}

        \PYG{n}{result} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{run\PYGZus{}fio\PYGZus{}test}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{random\PYGZus{}read}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{random\PYGZus{}read\PYGZus{}config}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{random\PYGZus{}read}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{result}

        \PYG{c+c1}{\PYGZsh{} Random write test}
        \PYG{n}{random\PYGZus{}write\PYGZus{}config} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{[random\PYGZus{}write]}
\PYG{l+s+s2}{ioengine=libaio}
\PYG{l+s+s2}{rw=randwrite}
\PYG{l+s+s2}{bs=4k}
\PYG{l+s+s2}{direct=1}
\PYG{l+s+s2}{size=100M}
\PYG{l+s+s2}{numjobs=1}
\PYG{l+s+s2}{runtime=30}
\PYG{l+s+s2}{group\PYGZus{}reporting}
\PYG{l+s+s2}{filename=}\PYG{l+s+si}{\PYGZob{}\PYGZcb{}}\PYG{l+s+s2}{/random\PYGZus{}write.dat}
\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir}\PYG{p}{)}

        \PYG{n}{result} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{run\PYGZus{}fio\PYGZus{}test}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{random\PYGZus{}write}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{random\PYGZus{}write\PYGZus{}config}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{random\PYGZus{}write}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{result}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{generate\PYGZus{}report}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Generate performance report\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{report\PYGZus{}file} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir} \PYG{o}{/} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{benchmark\PYGZus{}report.json}\PYG{l+s+s2}{\PYGZdq{}}

        \PYG{n}{report} \PYG{o}{=} \PYG{p}{\PYGZob{}}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{time}\PYG{o}{.}\PYG{n}{strftime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{Y\PYGZhy{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{m\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{H:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{M:}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test\PYGZus{}directory}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{system\PYGZus{}info}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{get\PYGZus{}system\PYGZus{}info}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
            \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{results}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results}
        \PYG{p}{\PYGZcb{}}

        \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{report\PYGZus{}file}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
            \PYG{n}{json}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{report}\PYG{p}{,} \PYG{n}{f}\PYG{p}{,} \PYG{n}{indent}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Generate human\PYGZhy{}readable summary}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{print\PYGZus{}summary}\PYG{p}{(}\PYG{p}{)}

        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{Detailed report saved to: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{report\PYGZus{}file}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{get\PYGZus{}system\PYGZus{}info}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Get system information\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{k}{try}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} Get CPU info}
            \PYG{n}{cpu\PYGZus{}info} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lscpu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{stdout}

            \PYG{c+c1}{\PYGZsh{} Get memory info}
            \PYG{n}{mem\PYGZus{}info} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{free}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}h}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{stdout}

            \PYG{c+c1}{\PYGZsh{} Get storage info}
            \PYG{n}{storage\PYGZus{}info} \PYG{o}{=} \PYG{n}{subprocess}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lsblk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{capture\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{text}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{stdout}

            \PYG{k}{return} \PYG{p}{\PYGZob{}}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cpu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{cpu\PYGZus{}info}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} First 10 lines}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{memory}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{mem\PYGZus{}info}\PYG{p}{,}
                \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{storage}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{storage\PYGZus{}info}
            \PYG{p}{\PYGZcb{}}
        \PYG{k}{except} \PYG{n+ne}{Exception}\PYG{p}{:}
            \PYG{k}{return} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Could not gather system info}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{print\PYGZus{}summary}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Print benchmark summary\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{*}\PYG{l+m+mi}{60}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{STORAGE BENCHMARK SUMMARY}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{o}{*}\PYG{l+m+mi}{60}\PYG{p}{)}

        \PYG{k}{for} \PYG{n}{test\PYGZus{}name}\PYG{p}{,} \PYG{n}{result} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{results}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}name}\PYG{o}{.}\PYG{n}{upper}\PYG{p}{(}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write\PYGZus{}speed}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{:}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Write Speed: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{result}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write\PYGZus{}speed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Read Speed:  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{result}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read\PYGZus{}speed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{k}{elif} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jobs}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{:}  \PYG{c+c1}{\PYGZsh{} FIO result}
                    \PYG{k}{for} \PYG{n}{job} \PYG{o+ow}{in} \PYG{n}{result}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jobs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{:}
                        \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{job}\PYG{p}{:}
                            \PYG{n}{iops} \PYG{o}{=} \PYG{n}{job}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iops}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                            \PYG{n}{bw} \PYG{o}{=} \PYG{n}{job}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{read}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Read IOPS:   }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{iops}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Read BW:     }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bw}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ KB/s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                        \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{job}\PYG{p}{:}
                            \PYG{n}{iops} \PYG{o}{=} \PYG{n}{job}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{iops}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                            \PYG{n}{bw} \PYG{o}{=} \PYG{n}{job}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{write}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bw}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N/A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Write IOPS:  }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{iops}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Write BW:    }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{bw}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ KB/s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{test\PYGZus{}name}\PYG{o}{.}\PYG{n}{upper}\PYG{p}{(}\PYG{p}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{: ERROR \PYGZhy{} }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{result}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{error}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

    \PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{run\PYGZus{}all\PYGZus{}tests}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
\PYG{+w}{        }\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run complete benchmark suite\PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Starting Storage Benchmark Suite}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{This may take several minutes...}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{run\PYGZus{}sequential\PYGZus{}tests}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{run\PYGZus{}random\PYGZus{}tests}\PYG{p}{(}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{generate\PYGZus{}report}\PYG{p}{(}\PYG{p}{)}

        \PYG{c+c1}{\PYGZsh{} Cleanup}
        \PYG{k}{for} \PYG{n}{file} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{test\PYGZus{}dir}\PYG{o}{.}\PYG{n}{glob}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{*.dat}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{file}\PYG{o}{.}\PYG{n}{unlink}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{1}\PYG{p}{:}
        \PYG{n}{test\PYGZus{}dir} \PYG{o}{=} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{argv}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{test\PYGZus{}dir} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/tmp/storage\PYGZus{}test}\PYG{l+s+s2}{\PYGZdq{}}

    \PYG{n}{benchmark} \PYG{o}{=} \PYG{n}{StorageBenchmark}\PYG{p}{(}\PYG{n}{test\PYGZus{}dir}\PYG{p}{)}
    \PYG{n}{benchmark}\PYG{o}{.}\PYG{n}{run\PYGZus{}all\PYGZus{}tests}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Installation and Usage Instructions}
\label{\detokenize{coding-examples:installation-and-usage-instructions}}

\subsection{Setting Up the Environment}
\label{\detokenize{coding-examples:setting-up-the-environment}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install required packages}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }python3\PYGZhy{}pip\PYG{+w}{ }smartmontools\PYG{+w}{ }fio

\PYG{c+c1}{\PYGZsh{} Install Python dependencies}
pip3\PYG{+w}{ }install\PYG{+w}{ }pyyaml

\PYG{c+c1}{\PYGZsh{} Make scripts executable}
chmod\PYG{+w}{ }+x\PYG{+w}{ }*.py\PYG{+w}{ }*.sh

\PYG{c+c1}{\PYGZsh{} Create necessary directories}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/var/log\PYG{+w}{ }/backup
\end{sphinxVerbatim}


\subsection{Script Configuration}
\label{\detokenize{coding-examples:script-configuration}}
\sphinxAtStartPar
\sphinxstylestrong{Storage Monitor Configuration:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set up cron job for automated monitoring}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 */6 * * * root /path/to/storage\PYGZhy{}monitor.py\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/crontab

\PYG{c+c1}{\PYGZsh{} Configure log rotation}
sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/logrotate.d/storage\PYGZhy{}monitor\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} EOF}
\PYG{l+s}{/var/log/storage\PYGZhy{}monitor.log \PYGZob{}}
\PYG{l+s}{    daily}
\PYG{l+s}{    rotate 30}
\PYG{l+s}{    compress}
\PYG{l+s}{    missingok}
\PYG{l+s}{    create 644 root root}
\PYG{l+s}{\PYGZcb{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{NFS Manager Setup:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install NFS utilities}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }nfs\PYGZhy{}common

\PYG{c+c1}{\PYGZsh{} Create configuration file}
sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/nfs\PYGZhy{}mounts.yaml\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} EOF}
\PYG{l+s}{mounts:}
\PYG{l+s}{  \PYGZhy{} server: \PYGZdq{}your\PYGZhy{}nfs\PYGZhy{}server.local\PYGZdq{}}
\PYG{l+s}{    export: \PYGZdq{}/export/data\PYGZdq{}}
\PYG{l+s}{    mountpoint: \PYGZdq{}/mnt/nfs\PYGZhy{}data\PYGZdq{}}
\PYG{l+s}{    options: \PYGZdq{}rw,sync,hard,intr\PYGZdq{}}
\PYG{l+s}{    auto\PYGZus{}mount: true}
\PYG{l+s}{timeout: 30}
\PYG{l+s}{retry\PYGZus{}count: 3}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\section{Integration Examples}
\label{\detokenize{coding-examples:integration-examples}}

\subsection{Systemd Service Integration}
\label{\detokenize{coding-examples:systemd-service-integration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} /etc/systemd/system/storage\PYGZhy{}monitor.service}
\PYG{k}{[Unit]}
\PYG{n+na}{Description}\PYG{o}{=}\PYG{l+s}{Storage Health Monitor}
\PYG{n+na}{After}\PYG{o}{=}\PYG{l+s}{multi\PYGZhy{}user.target}

\PYG{k}{[Service]}
\PYG{n+na}{Type}\PYG{o}{=}\PYG{l+s}{oneshot}
\PYG{n+na}{ExecStart}\PYG{o}{=}\PYG{l+s}{/usr/local/bin/storage\PYGZhy{}monitor.py}
\PYG{n+na}{User}\PYG{o}{=}\PYG{l+s}{root}

\PYG{k}{[Install]}
\PYG{n+na}{WantedBy}\PYG{o}{=}\PYG{l+s}{multi\PYGZhy{}user.target}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable and start the service}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }daemon\PYGZhy{}reload
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }storage\PYGZhy{}monitor.service
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }storage\PYGZhy{}monitor.service
\end{sphinxVerbatim}


\subsection{Custom Alerts Integration}
\label{\detokenize{coding-examples:custom-alerts-integration}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Email alert integration}
\PYG{k+kn}{import}\PYG{+w}{ }\PYG{n+nn}{smtplib}
\PYG{k+kn}{from}\PYG{+w}{ }\PYG{n+nn}{email}\PYG{n+nn}{.}\PYG{n+nn}{mime}\PYG{n+nn}{.}\PYG{n+nn}{text}\PYG{+w}{ }\PYG{k+kn}{import} \PYG{n}{MIMEText}

\PYG{k}{def}\PYG{+w}{ }\PYG{n+nf}{send\PYGZus{}alert}\PYG{p}{(}\PYG{n}{subject}\PYG{p}{,} \PYG{n}{message}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{msg} \PYG{o}{=} \PYG{n}{MIMEText}\PYG{p}{(}\PYG{n}{message}\PYG{p}{)}
    \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Subject}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{subject}
    \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{From}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{storage\PYGZhy{}monitor@yourserver.com}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{msg}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{To}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{admin@yourserver.com}\PYG{l+s+s1}{\PYGZsq{}}

    \PYG{n}{server} \PYG{o}{=} \PYG{n}{smtplib}\PYG{o}{.}\PYG{n}{SMTP}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{localhost}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{server}\PYG{o}{.}\PYG{n}{send\PYGZus{}message}\PYG{p}{(}\PYG{n}{msg}\PYG{p}{)}
    \PYG{n}{server}\PYG{o}{.}\PYG{n}{quit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
These scripts provide a comprehensive foundation for storage management automation on Ubuntu 22.04. They can be customized and extended based on specific requirements and integrated into larger system management frameworks.

\sphinxstepscope


\chapter{Troubleshooting Guide}
\label{\detokenize{troubleshooting:troubleshooting-guide}}\label{\detokenize{troubleshooting::doc}}
\sphinxAtStartPar
This comprehensive troubleshooting guide covers common storage\sphinxhyphen{}related issues on Ubuntu 22.04 and their solutions.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id1}}{\hyperref[\detokenize{troubleshooting:disk-and-partition-issues}]{\sphinxcrossref{Disk and Partition Issues}}} (\autopageref*{\detokenize{troubleshooting:disk-and-partition-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id2}}{\hyperref[\detokenize{troubleshooting:disk-not-detected}]{\sphinxcrossref{Disk Not Detected}}} (\autopageref*{\detokenize{troubleshooting:disk-not-detected}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id3}}{\hyperref[\detokenize{troubleshooting:partition-table-corruption}]{\sphinxcrossref{Partition Table Corruption}}} (\autopageref*{\detokenize{troubleshooting:partition-table-corruption}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id4}}{\hyperref[\detokenize{troubleshooting:boot-issues}]{\sphinxcrossref{Boot Issues}}} (\autopageref*{\detokenize{troubleshooting:boot-issues}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id5}}{\hyperref[\detokenize{troubleshooting:filesystem-issues}]{\sphinxcrossref{Filesystem Issues}}} (\autopageref*{\detokenize{troubleshooting:filesystem-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id6}}{\hyperref[\detokenize{troubleshooting:filesystem-corruption}]{\sphinxcrossref{Filesystem Corruption}}} (\autopageref*{\detokenize{troubleshooting:filesystem-corruption}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id7}}{\hyperref[\detokenize{troubleshooting:journal-issues}]{\sphinxcrossref{Journal Issues}}} (\autopageref*{\detokenize{troubleshooting:journal-issues}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id8}}{\hyperref[\detokenize{troubleshooting:full-disk-issues}]{\sphinxcrossref{Full Disk Issues}}} (\autopageref*{\detokenize{troubleshooting:full-disk-issues}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id9}}{\hyperref[\detokenize{troubleshooting:lvm-issues}]{\sphinxcrossref{LVM Issues}}} (\autopageref*{\detokenize{troubleshooting:lvm-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id10}}{\hyperref[\detokenize{troubleshooting:physical-volume-problems}]{\sphinxcrossref{Physical Volume Problems}}} (\autopageref*{\detokenize{troubleshooting:physical-volume-problems}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id11}}{\hyperref[\detokenize{troubleshooting:volume-group-issues}]{\sphinxcrossref{Volume Group Issues}}} (\autopageref*{\detokenize{troubleshooting:volume-group-issues}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id12}}{\hyperref[\detokenize{troubleshooting:logical-volume-problems}]{\sphinxcrossref{Logical Volume Problems}}} (\autopageref*{\detokenize{troubleshooting:logical-volume-problems}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id13}}{\hyperref[\detokenize{troubleshooting:raid-issues}]{\sphinxcrossref{RAID Issues}}} (\autopageref*{\detokenize{troubleshooting:raid-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id14}}{\hyperref[\detokenize{troubleshooting:software-raid-problems}]{\sphinxcrossref{Software RAID Problems}}} (\autopageref*{\detokenize{troubleshooting:software-raid-problems}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id15}}{\hyperref[\detokenize{troubleshooting:hardware-raid-issues}]{\sphinxcrossref{Hardware RAID Issues}}} (\autopageref*{\detokenize{troubleshooting:hardware-raid-issues}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id16}}{\hyperref[\detokenize{troubleshooting:network-storage-issues}]{\sphinxcrossref{Network Storage Issues}}} (\autopageref*{\detokenize{troubleshooting:network-storage-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id17}}{\hyperref[\detokenize{troubleshooting:nfs-mount-problems}]{\sphinxcrossref{NFS Mount Problems}}} (\autopageref*{\detokenize{troubleshooting:nfs-mount-problems}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id18}}{\hyperref[\detokenize{troubleshooting:samba-cifs-issues}]{\sphinxcrossref{Samba/CIFS Issues}}} (\autopageref*{\detokenize{troubleshooting:samba-cifs-issues}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id19}}{\hyperref[\detokenize{troubleshooting:performance-issues}]{\sphinxcrossref{Performance Issues}}} (\autopageref*{\detokenize{troubleshooting:performance-issues}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id20}}{\hyperref[\detokenize{troubleshooting:slow-disk-performance}]{\sphinxcrossref{Slow Disk Performance}}} (\autopageref*{\detokenize{troubleshooting:slow-disk-performance}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id21}}{\hyperref[\detokenize{troubleshooting:high-i-o-wait}]{\sphinxcrossref{High I/O Wait}}} (\autopageref*{\detokenize{troubleshooting:high-i-o-wait}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id22}}{\hyperref[\detokenize{troubleshooting:memory-and-cache-issues}]{\sphinxcrossref{Memory and Cache Issues}}} (\autopageref*{\detokenize{troubleshooting:memory-and-cache-issues}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id23}}{\hyperref[\detokenize{troubleshooting:recovery-procedures}]{\sphinxcrossref{Recovery Procedures}}} (\autopageref*{\detokenize{troubleshooting:recovery-procedures}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id24}}{\hyperref[\detokenize{troubleshooting:data-recovery}]{\sphinxcrossref{Data Recovery}}} (\autopageref*{\detokenize{troubleshooting:data-recovery}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id25}}{\hyperref[\detokenize{troubleshooting:system-recovery}]{\sphinxcrossref{System Recovery}}} (\autopageref*{\detokenize{troubleshooting:system-recovery}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id26}}{\hyperref[\detokenize{troubleshooting:emergency-procedures}]{\sphinxcrossref{Emergency Procedures}}} (\autopageref*{\detokenize{troubleshooting:emergency-procedures}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id27}}{\hyperref[\detokenize{troubleshooting:read-only-filesystem-recovery}]{\sphinxcrossref{Read\sphinxhyphen{}Only Filesystem Recovery}}} (\autopageref*{\detokenize{troubleshooting:read-only-filesystem-recovery}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id28}}{\hyperref[\detokenize{troubleshooting:disk-failure-emergency}]{\sphinxcrossref{Disk Failure Emergency}}} (\autopageref*{\detokenize{troubleshooting:disk-failure-emergency}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id29}}{\hyperref[\detokenize{troubleshooting:preventive-measures}]{\sphinxcrossref{Preventive Measures}}} (\autopageref*{\detokenize{troubleshooting:preventive-measures}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id30}}{\hyperref[\detokenize{troubleshooting:regular-health-checks}]{\sphinxcrossref{Regular Health Checks}}} (\autopageref*{\detokenize{troubleshooting:regular-health-checks}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id31}}{\hyperref[\detokenize{troubleshooting:backup-verification}]{\sphinxcrossref{Backup Verification}}} (\autopageref*{\detokenize{troubleshooting:backup-verification}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id32}}{\hyperref[\detokenize{troubleshooting:log-monitoring}]{\sphinxcrossref{Log Monitoring}}} (\autopageref*{\detokenize{troubleshooting:log-monitoring}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id33}}{\hyperref[\detokenize{troubleshooting:advanced-debugging}]{\sphinxcrossref{Advanced Debugging}}} (\autopageref*{\detokenize{troubleshooting:advanced-debugging}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id34}}{\hyperref[\detokenize{troubleshooting:kernel-debugging}]{\sphinxcrossref{Kernel Debugging}}} (\autopageref*{\detokenize{troubleshooting:kernel-debugging}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{troubleshooting:id35}}{\hyperref[\detokenize{troubleshooting:hardware-diagnostics}]{\sphinxcrossref{Hardware Diagnostics}}} (\autopageref*{\detokenize{troubleshooting:hardware-diagnostics}})

\end{itemize}

\end{itemize}
\end{sphinxcontents}


\section{Disk and Partition Issues}
\label{\detokenize{troubleshooting:disk-and-partition-issues}}

\subsection{Disk Not Detected}
\label{\detokenize{troubleshooting:disk-not-detected}}
\sphinxAtStartPar
\sphinxstylestrong{Symptoms:}
\sphinxhyphen{} New disk not showing up in \sphinxtitleref{lsblk} or \sphinxtitleref{fdisk \sphinxhyphen{}l}
\sphinxhyphen{} System doesn’t recognize additional storage

\sphinxAtStartPar
\sphinxstylestrong{Diagnosis Steps:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check if disk is physically detected}
sudo\PYG{+w}{ }dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}sd\PYGZbs{}|nvme\PYGZbs{}|ata\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Check SATA/NVMe connections}
lspci\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}sata\PYGZbs{}|nvme\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Rescan SCSI bus}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZhy{} \PYGZhy{} \PYGZhy{}\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/class/scsi\PYGZus{}host/host*/scan

\PYG{c+c1}{\PYGZsh{} Check disk health}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdX
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Solutions:}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Physical Connection Issues:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Power down and check connections}
sudo\PYG{+w}{ }shutdown\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }now
\PYG{c+c1}{\PYGZsh{} Check SATA/power cables}
\PYG{c+c1}{\PYGZsh{} Restart system}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Driver Issues:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Update system}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sudo\PYG{+w}{ }apt\PYG{+w}{ }upgrade

\PYG{c+c1}{\PYGZsh{} Install additional drivers if needed}
sudo\PYG{+w}{ }ubuntu\PYGZhy{}drivers\PYG{+w}{ }autoinstall
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{BIOS/UEFI Settings:}
\sphinxhyphen{} Enable AHCI mode
\sphinxhyphen{} Check storage controller settings
\sphinxhyphen{} Verify disk is detected in BIOS

\end{enumerate}


\subsection{Partition Table Corruption}
\label{\detokenize{troubleshooting:partition-table-corruption}}
\sphinxAtStartPar
\sphinxstylestrong{Symptoms:}
\sphinxhyphen{} “Invalid partition table” errors
\sphinxhyphen{} Disk shows as unallocated space
\sphinxhyphen{} Boot issues

\sphinxAtStartPar
\sphinxstylestrong{Diagnosis:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check partition table}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdX

\PYG{c+c1}{\PYGZsh{} Check for backup GPT}
sudo\PYG{+w}{ }gdisk\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdX

\PYG{c+c1}{\PYGZsh{} Verify filesystem}
sudo\PYG{+w}{ }file\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }/dev/sdX*
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Recovery Steps:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Backup current state}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/sdX\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/backup/disk\PYGZhy{}backup.img\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}\PYG{l+m}{512}\PYG{+w}{ }\PYG{n+nv}{count}\PYG{o}{=}\PYG{l+m}{2048}

\PYG{c+c1}{\PYGZsh{} Try to repair GPT}
sudo\PYG{+w}{ }gdisk\PYG{+w}{ }/dev/sdX
\PYG{c+c1}{\PYGZsh{} In gdisk: use \PYGZsq{}r\PYGZsq{} for recovery menu, then \PYGZsq{}b\PYGZsq{} to rebuild MBR}

\PYG{c+c1}{\PYGZsh{} For MBR partition tables}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }/dev/sdX
\PYG{c+c1}{\PYGZsh{} Use \PYGZsq{}p\PYGZsq{} to print, \PYGZsq{}w\PYGZsq{} to write if fixable}

\PYG{c+c1}{\PYGZsh{} Create new partition table if necessary}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mklabel\PYG{+w}{ }gpt
\end{sphinxVerbatim}


\subsection{Boot Issues}
\label{\detokenize{troubleshooting:boot-issues}}
\sphinxAtStartPar
\sphinxstylestrong{GRUB Boot Loader Problems:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Boot from Ubuntu Live USB}
\PYG{c+c1}{\PYGZsh{} Mount root filesystem}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX2\PYG{+w}{ }/mnt/boot\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} if separate boot partition}

\PYG{c+c1}{\PYGZsh{} Bind mount system directories}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/dev\PYG{+w}{ }/mnt/dev
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/proc\PYG{+w}{ }/mnt/proc
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/sys\PYG{+w}{ }/mnt/sys

\PYG{c+c1}{\PYGZsh{} Chroot into system}
sudo\PYG{+w}{ }chroot\PYG{+w}{ }/mnt

\PYG{c+c1}{\PYGZsh{} Reinstall GRUB}
grub\PYGZhy{}install\PYG{+w}{ }/dev/sdX
update\PYGZhy{}grub

\PYG{c+c1}{\PYGZsh{} Exit and reboot}
\PYG{n+nb}{exit}
sudo\PYG{+w}{ }umount\PYG{+w}{ }\PYGZhy{}R\PYG{+w}{ }/mnt
sudo\PYG{+w}{ }reboot
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Missing Boot Partition:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create new boot partition}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }1MiB\PYG{+w}{ }512MiB
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Mount and restore boot files}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt
sudo\PYG{+w}{ }cp\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }/boot/*\PYG{+w}{ }/mnt/

\PYG{c+c1}{\PYGZsh{} Update fstab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UUID=}\PYG{k}{\PYGZdl{}(}blkid\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }UUID\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }value\PYG{+w}{ }/dev/sdX1\PYG{k}{)}\PYG{l+s+s2}{ /boot ext4 defaults 0 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab
\end{sphinxVerbatim}


\section{Filesystem Issues}
\label{\detokenize{troubleshooting:filesystem-issues}}

\subsection{Filesystem Corruption}
\label{\detokenize{troubleshooting:filesystem-corruption}}
\sphinxAtStartPar
\sphinxstylestrong{Symptoms:}
\sphinxhyphen{} Read\sphinxhyphen{}only filesystem errors
\sphinxhyphen{} “Input/output error” messages
\sphinxhyphen{} Files disappearing or becoming inaccessible

\sphinxAtStartPar
\sphinxstylestrong{Emergency Recovery:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Remount filesystem as read\PYGZhy{}only}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,ro\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Backup critical data immediately}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/sdX1\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/backup/corrupted\PYGZhy{}fs.img\PYG{+w}{ }\PYG{n+nv}{conv}\PYG{o}{=}noerror,sync

\PYG{c+c1}{\PYGZsh{} Check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdX1
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Ext4 Filesystem Repair:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Unmount filesystem first}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Check and repair}
sudo\PYG{+w}{ }e2fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} If severely corrupted, try alternative superblock}
sudo\PYG{+w}{ }e2fsck\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+m}{32768}\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Force repair if needed}
sudo\PYG{+w}{ }e2fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }/dev/sdX1
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{XFS Filesystem Repair:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} XFS repair (filesystem must be unmounted)}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sdX1
sudo\PYG{+w}{ }xfs\PYGZus{}repair\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} If metadata is corrupted}
sudo\PYG{+w}{ }xfs\PYGZus{}repair\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }/dev/sdX1\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} This will clear the log}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Btrfs Filesystem Repair:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check Btrfs filesystem}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }check\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Repair if needed (dangerous, backup first)}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }check\PYG{+w}{ }\PYGZhy{}\PYGZhy{}repair\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Scrub for data integrity}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }scrub\PYG{+w}{ }start\PYG{+w}{ }/mnt/btrfs\PYGZhy{}mount
\end{sphinxVerbatim}


\subsection{Journal Issues}
\label{\detokenize{troubleshooting:journal-issues}}
\sphinxAtStartPar
\sphinxstylestrong{Ext4 Journal Problems:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check journal status}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }journal

\PYG{c+c1}{\PYGZsh{} Remove journal (converts to ext2)}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}O\PYG{+w}{ }\PYGZca{}has\PYGZus{}journal\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Add journal back}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}j\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Or recreate journal}
sudo\PYG{+w}{ }e2fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdX1
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}J\PYG{+w}{ }\PYG{n+nv}{size}\PYG{o}{=}\PYG{l+m}{128}\PYG{+w}{ }/dev/sdX1
\end{sphinxVerbatim}


\subsection{Full Disk Issues}
\label{\detokenize{troubleshooting:full-disk-issues}}
\sphinxAtStartPar
\sphinxstylestrong{Disk Space Exhaustion:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Find large files}
sudo\PYG{+w}{ }find\PYG{+w}{ }/\PYG{+w}{ }\PYGZhy{}xdev\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+100M\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null

\PYG{c+c1}{\PYGZsh{} Find large directories}
sudo\PYG{+w}{ }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYGZhy{}\PYGZhy{}max\PYGZhy{}depth\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }/\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr

\PYG{c+c1}{\PYGZsh{} Clean package cache}
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoremove
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoclean

\PYG{c+c1}{\PYGZsh{} Clean journal logs}
sudo\PYG{+w}{ }journalctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}vacuum\PYGZhy{}time\PYG{o}{=}3d

\PYG{c+c1}{\PYGZsh{} Clean temporary files}
sudo\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }/tmp/*
sudo\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }/var/tmp/*
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Inode Exhaustion:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check inode usage}
df\PYG{+w}{ }\PYGZhy{}i

\PYG{c+c1}{\PYGZsh{} Find directories with many files}
sudo\PYG{+w}{ }find\PYG{+w}{ }/\PYG{+w}{ }\PYGZhy{}xdev\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }sh\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}echo \PYGZdq{}\PYGZdl{}(ls \PYGZhy{}1 \PYGZdq{}\PYGZdl{}1\PYGZdq{} | wc \PYGZhy{}l) \PYGZdl{}1\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYGZus{}\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}20

\PYG{c+c1}{\PYGZsh{} Clean up small files}
sudo\PYG{+w}{ }find\PYG{+w}{ }/var/log\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*.log\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+100M\PYG{+w}{ }\PYGZhy{}delete
sudo\PYG{+w}{ }find\PYG{+w}{ }/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}atime\PYG{+w}{ }+7\PYG{+w}{ }\PYGZhy{}delete
\end{sphinxVerbatim}


\section{LVM Issues}
\label{\detokenize{troubleshooting:lvm-issues}}

\subsection{Physical Volume Problems}
\label{\detokenize{troubleshooting:physical-volume-problems}}
\sphinxAtStartPar
\sphinxstylestrong{PV Not Found:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Scan for PVs}
sudo\PYG{+w}{ }pvscan

\PYG{c+c1}{\PYGZsh{} Force rescan}
sudo\PYG{+w}{ }pvscan\PYG{+w}{ }\PYGZhy{}\PYGZhy{}cache

\PYG{c+c1}{\PYGZsh{} Check PV status}
sudo\PYG{+w}{ }pvdisplay\PYG{+w}{ }\PYGZhy{}v

\PYG{c+c1}{\PYGZsh{} Restore PV from backup}
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }\PYGZhy{}\PYGZhy{}restorefile\PYG{+w}{ }/etc/lvm/backup/vg\PYGZus{}name\PYG{+w}{ }\PYGZhy{}\PYGZhy{}uuid\PYG{+w}{ }PV\PYGZus{}UUID\PYG{+w}{ }/dev/sdX1
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Missing PV in VG:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check VG status}
sudo\PYG{+w}{ }vgdisplay
sudo\PYG{+w}{ }vgs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }+pv\PYGZus{}missing

\PYG{c+c1}{\PYGZsh{} Try to activate VG with missing PV}
sudo\PYG{+w}{ }vgchange\PYG{+w}{ }\PYGZhy{}ay\PYG{+w}{ }\PYGZhy{}\PYGZhy{}partial\PYG{+w}{ }volume\PYGZus{}group\PYGZus{}name

\PYG{c+c1}{\PYGZsh{} Remove missing PV}
sudo\PYG{+w}{ }vgreduce\PYG{+w}{ }\PYGZhy{}\PYGZhy{}removemissing\PYG{+w}{ }volume\PYGZus{}group\PYGZus{}name
\end{sphinxVerbatim}


\subsection{Volume Group Issues}
\label{\detokenize{troubleshooting:volume-group-issues}}
\sphinxAtStartPar
\sphinxstylestrong{VG Cannot Be Activated:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check VG metadata}
sudo\PYG{+w}{ }vgck\PYG{+w}{ }volume\PYGZus{}group\PYGZus{}name

\PYG{c+c1}{\PYGZsh{} Restore VG from backup}
sudo\PYG{+w}{ }vgcfgrestore\PYG{+w}{ }volume\PYGZus{}group\PYGZus{}name

\PYG{c+c1}{\PYGZsh{} Manual metadata restore}
sudo\PYG{+w}{ }vgcfgrestore\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/etc/lvm/backup/volume\PYGZus{}group\PYGZus{}name\PYG{+w}{ }volume\PYGZus{}group\PYGZus{}name
\end{sphinxVerbatim}


\subsection{Logical Volume Problems}
\label{\detokenize{troubleshooting:logical-volume-problems}}
\sphinxAtStartPar
\sphinxstylestrong{LV Won’t Mount:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check LV status}
sudo\PYG{+w}{ }lvdisplay
sudo\PYG{+w}{ }lvs\PYG{+w}{ }\PYGZhy{}a

\PYG{c+c1}{\PYGZsh{} Activate LV}
sudo\PYG{+w}{ }lvchange\PYG{+w}{ }\PYGZhy{}ay\PYG{+w}{ }/dev/volume\PYGZus{}group/logical\PYGZus{}volume

\PYG{c+c1}{\PYGZsh{} Check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }/dev/volume\PYGZus{}group/logical\PYGZus{}volume
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{LV Resize Issues:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check available space}
sudo\PYG{+w}{ }vgs

\PYG{c+c1}{\PYGZsh{} Extend LV}
sudo\PYG{+w}{ }lvextend\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }+1G\PYG{+w}{ }/dev/volume\PYGZus{}group/logical\PYGZus{}volume

\PYG{c+c1}{\PYGZsh{} Resize filesystem}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/volume\PYGZus{}group/logical\PYGZus{}volume\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} for ext4}
sudo\PYG{+w}{ }xfs\PYGZus{}growfs\PYG{+w}{ }/mount/point\PYG{+w}{                      }\PYG{c+c1}{\PYGZsh{} for XFS}
\end{sphinxVerbatim}


\section{RAID Issues}
\label{\detokenize{troubleshooting:raid-issues}}

\subsection{Software RAID Problems}
\label{\detokenize{troubleshooting:software-raid-problems}}
\sphinxAtStartPar
\sphinxstylestrong{Array Degraded:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check RAID status}
cat\PYG{+w}{ }/proc/mdstat

\PYG{c+c1}{\PYGZsh{} Check individual device status}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} Remove failed device}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}manage\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Add replacement device}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}manage\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/sdY1

\PYG{c+c1}{\PYGZsh{} Monitor rebuild}
watch\PYG{+w}{ }cat\PYG{+w}{ }/proc/mdstat
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Array Won’t Start:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Try to assemble array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}assemble\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sd\PYG{o}{[}abc\PYG{o}{]}\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Force assembly with missing device}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}assemble\PYG{+w}{ }\PYGZhy{}\PYGZhy{}force\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sd\PYG{o}{[}ab\PYG{o}{]}\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Scan and assemble all arrays}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}assemble\PYG{+w}{ }\PYGZhy{}\PYGZhy{}scan
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Superblock Issues:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check superblock}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}examine\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Zero superblock if corrupted}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}zero\PYGZhy{}superblock\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Recreate array (data loss!)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}create\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{2}\PYG{+w}{ }/dev/sda1\PYG{+w}{ }/dev/sdb1
\end{sphinxVerbatim}


\subsection{Hardware RAID Issues}
\label{\detokenize{troubleshooting:hardware-raid-issues}}
\sphinxAtStartPar
\sphinxstylestrong{Controller Detection:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check for RAID controllers}
lspci\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }raid

\PYG{c+c1}{\PYGZsh{} Install management tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }megacli\PYG{+w}{ }hpacucli\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} for MegaRAID and HP Smart Array}

\PYG{c+c1}{\PYGZsh{} Check controller status}
sudo\PYG{+w}{ }megacli\PYG{+w}{ }\PYGZhy{}AdpAllInfo\PYG{+w}{ }\PYGZhy{}aALL\PYG{+w}{      }\PYG{c+c1}{\PYGZsh{} MegaRAID}
sudo\PYG{+w}{ }hpacucli\PYG{+w}{ }ctrl\PYG{+w}{ }all\PYG{+w}{ }show\PYG{+w}{         }\PYG{c+c1}{\PYGZsh{} HP Smart Array}
\end{sphinxVerbatim}


\section{Network Storage Issues}
\label{\detokenize{troubleshooting:network-storage-issues}}

\subsection{NFS Mount Problems}
\label{\detokenize{troubleshooting:nfs-mount-problems}}
\sphinxAtStartPar
\sphinxstylestrong{Mount Fails:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check NFS server availability}
showmount\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip

\PYG{c+c1}{\PYGZsh{} Test network connectivity}
ping\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip
telnet\PYG{+w}{ }nfs\PYGZhy{}server\PYGZhy{}ip\PYG{+w}{ }\PYG{l+m}{2049}

\PYG{c+c1}{\PYGZsh{} Check NFS services}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }status\PYG{+w}{ }nfs\PYGZhy{}client.target
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }start\PYG{+w}{ }nfs\PYGZhy{}client.target

\PYG{c+c1}{\PYGZsh{} Debug mount}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }nfs\PYG{+w}{ }nfs\PYGZhy{}server:/export\PYG{+w}{ }/mnt/nfs
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Stale NFS Handles:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Force unmount}
sudo\PYG{+w}{ }umount\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/mnt/nfs

\PYG{c+c1}{\PYGZsh{} Lazy unmount}
sudo\PYG{+w}{ }umount\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/mnt/nfs

\PYG{c+c1}{\PYGZsh{} Clear stale handles}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount\PYG{+w}{ }/mnt/nfs
\end{sphinxVerbatim}


\subsection{Samba/CIFS Issues}
\label{\detokenize{troubleshooting:samba-cifs-issues}}
\sphinxAtStartPar
\sphinxstylestrong{Authentication Failures:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Test with different authentication}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }cifs\PYG{+w}{ }//server/share\PYG{+w}{ }/mnt/cifs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{username}\PYG{o}{=}user,password\PYG{o}{=}pass,vers\PYG{o}{=}\PYG{l+m}{3}.0

\PYG{c+c1}{\PYGZsh{} Check supported protocols}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }cifs\PYG{+w}{ }//server/share\PYG{+w}{ }/mnt/cifs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{username}\PYG{o}{=}user,vers\PYG{o}{=}\PYG{l+m}{1}.0

\PYG{c+c1}{\PYGZsh{} Use credentials file}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}username=user\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/cifs\PYGZhy{}credentials
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}password=pass\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/cifs\PYGZhy{}credentials
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYG{l+m}{600}\PYG{+w}{ }/etc/cifs\PYGZhy{}credentials
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }cifs\PYG{+w}{ }//server/share\PYG{+w}{ }/mnt/cifs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{credentials}\PYG{o}{=}/etc/cifs\PYGZhy{}credentials
\end{sphinxVerbatim}


\section{Performance Issues}
\label{\detokenize{troubleshooting:performance-issues}}

\subsection{Slow Disk Performance}
\label{\detokenize{troubleshooting:slow-disk-performance}}
\sphinxAtStartPar
\sphinxstylestrong{Diagnosis:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check I/O statistics}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{10}

\PYG{c+c1}{\PYGZsh{} Monitor disk activity}
iotop

\PYG{c+c1}{\PYGZsh{} Check for errors}
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}error\PYGZbs{}|fail\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} SMART health check}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdX
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Optimization:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check and optimize mount options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,noatime,nodiratime\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Adjust I/O scheduler}
\PYG{n+nb}{echo}\PYG{+w}{ }deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sdX/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Optimize for SSD}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sdX/queue/rotational
sudo\PYG{+w}{ }fstrim\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }/
\end{sphinxVerbatim}


\subsection{High I/O Wait}
\label{\detokenize{troubleshooting:high-i-o-wait}}
\sphinxAtStartPar
\sphinxstylestrong{Investigation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check system load}
uptime

\PYG{c+c1}{\PYGZsh{} Identify processes causing I/O}
iotop\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYGZhy{}o

\PYG{c+c1}{\PYGZsh{} Check for swap usage}
free\PYG{+w}{ }\PYGZhy{}h
swapon\PYG{+w}{ }\PYGZhy{}\PYGZhy{}show

\PYG{c+c1}{\PYGZsh{} Monitor I/O per process}
pidstat\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+m}{1}
\end{sphinxVerbatim}


\subsection{Memory and Cache Issues}
\label{\detokenize{troubleshooting:memory-and-cache-issues}}
\sphinxAtStartPar
\sphinxstylestrong{Clear Caches:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Drop caches safely}
sync
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{3}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/vm/drop\PYGZus{}caches

\PYG{c+c1}{\PYGZsh{} Adjust swappiness}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{10}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/vm/swappiness
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Check Memory Usage:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Detailed memory information}
cat\PYG{+w}{ }/proc/meminfo

\PYG{c+c1}{\PYGZsh{} Check for memory leaks}
ps\PYG{+w}{ }aux\PYG{+w}{ }\PYGZhy{}\PYGZhy{}sort\PYG{o}{=}\PYGZhy{}\PYGZpc{}mem\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}10
\end{sphinxVerbatim}


\section{Recovery Procedures}
\label{\detokenize{troubleshooting:recovery-procedures}}

\subsection{Data Recovery}
\label{\detokenize{troubleshooting:data-recovery}}
\sphinxAtStartPar
\sphinxstylestrong{File Recovery with TestDisk:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install TestDisk}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }testdisk

\PYG{c+c1}{\PYGZsh{} Run TestDisk for partition recovery}
sudo\PYG{+w}{ }testdisk

\PYG{c+c1}{\PYGZsh{} Use PhotoRec for file recovery}
sudo\PYG{+w}{ }photorec
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{DD Rescue for Damaged Disks:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install ddrescue}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }gddrescue

\PYG{c+c1}{\PYGZsh{} Create image of damaged disk}
sudo\PYG{+w}{ }ddrescue\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}r3\PYG{+w}{ }/dev/sdX\PYG{+w}{ }/path/to/rescue.img\PYG{+w}{ }/path/to/rescue.log

\PYG{c+c1}{\PYGZsh{} Continue rescue operation}
sudo\PYG{+w}{ }ddrescue\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}r3\PYG{+w}{ }/dev/sdX\PYG{+w}{ }/path/to/rescue.img\PYG{+w}{ }/path/to/rescue.log
\end{sphinxVerbatim}


\subsection{System Recovery}
\label{\detokenize{troubleshooting:system-recovery}}
\sphinxAtStartPar
\sphinxstylestrong{Boot from Live USB:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Mount root filesystem}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/system
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt/system

\PYG{c+c1}{\PYGZsh{} Mount other partitions}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX2\PYG{+w}{ }/mnt/system/boot
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdX3\PYG{+w}{ }/mnt/system/home

\PYG{c+c1}{\PYGZsh{} Chroot into system}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/dev\PYG{+w}{ }/mnt/system/dev
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/proc\PYG{+w}{ }/mnt/system/proc
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/sys\PYG{+w}{ }/mnt/system/sys
sudo\PYG{+w}{ }chroot\PYG{+w}{ }/mnt/system
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Backup Before Recovery:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create full system backup}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/sdX\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/backup/full\PYGZhy{}disk.img\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}64K\PYG{+w}{ }\PYG{n+nv}{conv}\PYG{o}{=}noerror,sync

\PYG{c+c1}{\PYGZsh{} Create compressed backup}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/sdX\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}64K\PYG{+w}{ }\PYG{n+nv}{conv}\PYG{o}{=}noerror,sync\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }gzip\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/backup/disk\PYGZhy{}backup.img.gz
\end{sphinxVerbatim}


\section{Emergency Procedures}
\label{\detokenize{troubleshooting:emergency-procedures}}

\subsection{Read\sphinxhyphen{}Only Filesystem Recovery}
\label{\detokenize{troubleshooting:read-only-filesystem-recovery}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check why filesystem is read\PYGZhy{}only}
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}50

\PYG{c+c1}{\PYGZsh{} Try to remount read\PYGZhy{}write}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,rw\PYG{+w}{ }/

\PYG{c+c1}{\PYGZsh{} If that fails, check filesystem}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Force filesystem check on next boot}
sudo\PYG{+w}{ }touch\PYG{+w}{ }/forcefsck
\end{sphinxVerbatim}


\subsection{Disk Failure Emergency}
\label{\detokenize{troubleshooting:disk-failure-emergency}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Immediate data backup}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/failing\PYGZus{}disk\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/backup/emergency.img\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}\PYG{l+m}{4096}\PYG{+w}{ }\PYG{n+nv}{conv}\PYG{o}{=}noerror,sync

\PYG{c+c1}{\PYGZsh{} Monitor SMART status}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }short\PYG{+w}{ }/dev/sdX
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sdX

\PYG{c+c1}{\PYGZsh{} Prepare replacement}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/new\PYGZus{}disk
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/backup/emergency.img\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/dev/new\PYGZus{}disk\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}\PYG{l+m}{4096}
\end{sphinxVerbatim}


\section{Preventive Measures}
\label{\detokenize{troubleshooting:preventive-measures}}

\subsection{Regular Health Checks}
\label{\detokenize{troubleshooting:regular-health-checks}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create monitoring script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/storage\PYGZhy{}health.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{\PYGZsh{} Check disk usage}
\PYG{l+s}{df \PYGZhy{}h | awk \PYGZsq{}\PYGZdl{}5+0 \PYGZgt{} 80 \PYGZob{}print \PYGZdq{}WARNING: \PYGZdq{} \PYGZdl{}0\PYGZcb{}\PYGZsq{}}

\PYG{l+s}{\PYGZsh{} Check SMART status}
\PYG{l+s}{for disk in /dev/sd[a\PYGZhy{}z]; do}
\PYG{l+s}{    if [ \PYGZhy{}e \PYGZdq{}\PYGZdl{}disk\PYGZdq{} ]; then}
\PYG{l+s}{        smartctl \PYGZhy{}H \PYGZdq{}\PYGZdl{}disk\PYGZdq{} | grep \PYGZhy{}q \PYGZdq{}PASSED\PYGZdq{} || echo \PYGZdq{}SMART FAILURE: \PYGZdl{}disk\PYGZdq{}}
\PYG{l+s}{    fi}
\PYG{l+s}{done}

\PYG{l+s}{\PYGZsh{} Check RAID status}
\PYG{l+s}{if [ \PYGZhy{}f /proc/mdstat ]; then}
\PYG{l+s}{    grep \PYGZhy{}q \PYGZdq{}\PYGZus{}\PYGZdq{} /proc/mdstat \PYGZam{}\PYGZam{} echo \PYGZdq{}RAID DEGRADED\PYGZdq{}}
\PYG{l+s}{fi}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/storage\PYGZhy{}health.sh

\PYG{c+c1}{\PYGZsh{} Add to crontab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 6 * * * root /usr/local/bin/storage\PYGZhy{}health.sh\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }/etc/crontab
\end{sphinxVerbatim}


\subsection{Backup Verification}
\label{\detokenize{troubleshooting:backup-verification}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Verify backup integrity}
md5sum\PYG{+w}{ }/backup/important\PYGZhy{}data.tar.gz\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/backup/checksums.md5

\PYG{c+c1}{\PYGZsh{} Test restore procedure}
tar\PYG{+w}{ }\PYGZhy{}tzf\PYG{+w}{ }/backup/important\PYGZhy{}data.tar.gz\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup OK\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Backup CORRUPTED\PYGZdq{}}
\end{sphinxVerbatim}


\subsection{Log Monitoring}
\label{\detokenize{troubleshooting:log-monitoring}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Monitor for storage errors}
tail\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/var/log/syslog\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}error\PYGZbs{}|fail\PYGZbs{}|critical\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Set up logwatch for storage events}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }logwatch
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}storage\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/logwatch/conf/services/storage.conf
\end{sphinxVerbatim}


\section{Advanced Debugging}
\label{\detokenize{troubleshooting:advanced-debugging}}

\subsection{Kernel Debugging}
\label{\detokenize{troubleshooting:kernel-debugging}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable kernel debugging}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/kernel/printk

\PYG{c+c1}{\PYGZsh{} Check kernel ring buffer}
dmesg\PYG{+w}{ }\PYGZhy{}T\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}storage\PYGZbs{}|disk\PYGZbs{}|ata\PYGZbs{}|scsi\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Enable block device debugging}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sdX/queue/iostats
\end{sphinxVerbatim}


\subsection{Hardware Diagnostics}
\label{\detokenize{troubleshooting:hardware-diagnostics}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check hardware information}
sudo\PYG{+w}{ }lshw\PYG{+w}{ }\PYGZhy{}class\PYG{+w}{ }disk
sudo\PYG{+w}{ }lspci\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }\PYG{l+m}{10}\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }storage

\PYG{c+c1}{\PYGZsh{} Test memory}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }memtest86+
\PYG{c+c1}{\PYGZsh{} Reboot and select memtest from GRUB menu}

\PYG{c+c1}{\PYGZsh{} CPU stress test}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }stress\PYGZhy{}ng
stress\PYGZhy{}ng\PYG{+w}{ }\PYGZhy{}\PYGZhy{}cpu\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}timeout\PYG{+w}{ }60s
\end{sphinxVerbatim}

\sphinxAtStartPar
This troubleshooting guide provides systematic approaches to diagnose and resolve storage issues on Ubuntu 22.04. Always backup critical data before attempting repairs, and consider professional data recovery services for valuable data on physically damaged drives.

\sphinxstepscope


\chapter{Best Practices and Guidelines}
\label{\detokenize{best-practices:best-practices-and-guidelines}}\label{\detokenize{best-practices::doc}}
\sphinxAtStartPar
This section outlines industry best practices and proven guidelines for storage management on Ubuntu 22.04.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id1}}{\hyperref[\detokenize{best-practices:storage-planning-and-design}]{\sphinxcrossref{Storage Planning and Design}}} (\autopageref*{\detokenize{best-practices:storage-planning-and-design}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id2}}{\hyperref[\detokenize{best-practices:capacity-planning}]{\sphinxcrossref{Capacity Planning}}} (\autopageref*{\detokenize{best-practices:capacity-planning}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id3}}{\hyperref[\detokenize{best-practices:filesystem-selection-guidelines}]{\sphinxcrossref{Filesystem Selection Guidelines}}} (\autopageref*{\detokenize{best-practices:filesystem-selection-guidelines}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id4}}{\hyperref[\detokenize{best-practices:partitioning-best-practices}]{\sphinxcrossref{Partitioning Best Practices}}} (\autopageref*{\detokenize{best-practices:partitioning-best-practices}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id5}}{\hyperref[\detokenize{best-practices:partition-layout-strategy}]{\sphinxcrossref{Partition Layout Strategy}}} (\autopageref*{\detokenize{best-practices:partition-layout-strategy}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id6}}{\hyperref[\detokenize{best-practices:alignment-and-performance}]{\sphinxcrossref{Alignment and Performance}}} (\autopageref*{\detokenize{best-practices:alignment-and-performance}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id7}}{\hyperref[\detokenize{best-practices:security-best-practices}]{\sphinxcrossref{Security Best Practices}}} (\autopageref*{\detokenize{best-practices:security-best-practices}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id8}}{\hyperref[\detokenize{best-practices:encryption-at-rest}]{\sphinxcrossref{Encryption at Rest}}} (\autopageref*{\detokenize{best-practices:encryption-at-rest}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id9}}{\hyperref[\detokenize{best-practices:access-control-and-permissions}]{\sphinxcrossref{Access Control and Permissions}}} (\autopageref*{\detokenize{best-practices:access-control-and-permissions}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id10}}{\hyperref[\detokenize{best-practices:backup-and-recovery-strategies}]{\sphinxcrossref{Backup and Recovery Strategies}}} (\autopageref*{\detokenize{best-practices:backup-and-recovery-strategies}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id11}}{\hyperref[\detokenize{best-practices:backup-strategy-framework}]{\sphinxcrossref{Backup Strategy Framework}}} (\autopageref*{\detokenize{best-practices:backup-strategy-framework}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id12}}{\hyperref[\detokenize{best-practices:recovery-planning}]{\sphinxcrossref{Recovery Planning}}} (\autopageref*{\detokenize{best-practices:recovery-planning}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id13}}{\hyperref[\detokenize{best-practices:performance-optimization}]{\sphinxcrossref{Performance Optimization}}} (\autopageref*{\detokenize{best-practices:performance-optimization}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id14}}{\hyperref[\detokenize{best-practices:i-o-optimization}]{\sphinxcrossref{I/O Optimization}}} (\autopageref*{\detokenize{best-practices:i-o-optimization}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id15}}{\hyperref[\detokenize{best-practices:memory-and-cache-optimization}]{\sphinxcrossref{Memory and Cache Optimization}}} (\autopageref*{\detokenize{best-practices:memory-and-cache-optimization}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id16}}{\hyperref[\detokenize{best-practices:monitoring-and-alerting}]{\sphinxcrossref{Monitoring and Alerting}}} (\autopageref*{\detokenize{best-practices:monitoring-and-alerting}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id17}}{\hyperref[\detokenize{best-practices:proactive-monitoring}]{\sphinxcrossref{Proactive Monitoring}}} (\autopageref*{\detokenize{best-practices:proactive-monitoring}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id18}}{\hyperref[\detokenize{best-practices:maintenance-procedures}]{\sphinxcrossref{Maintenance Procedures}}} (\autopageref*{\detokenize{best-practices:maintenance-procedures}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id19}}{\hyperref[\detokenize{best-practices:regular-maintenance-tasks}]{\sphinxcrossref{Regular Maintenance Tasks}}} (\autopageref*{\detokenize{best-practices:regular-maintenance-tasks}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id20}}{\hyperref[\detokenize{best-practices:documentation-and-change-management}]{\sphinxcrossref{Documentation and Change Management}}} (\autopageref*{\detokenize{best-practices:documentation-and-change-management}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{best-practices:id21}}{\hyperref[\detokenize{best-practices:documentation-standards}]{\sphinxcrossref{Documentation Standards}}} (\autopageref*{\detokenize{best-practices:documentation-standards}})

\end{itemize}

\end{itemize}
\end{sphinxcontents}


\section{Storage Planning and Design}
\label{\detokenize{best-practices:storage-planning-and-design}}

\subsection{Capacity Planning}
\label{\detokenize{best-practices:capacity-planning}}
\sphinxAtStartPar
\sphinxstylestrong{Growth Assessment:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Plan for 3\sphinxhyphen{}5 years of growth

\item {} 
\sphinxAtStartPar
Account for data growth rates: 20\sphinxhyphen{}40\% annually for typical business environments

\item {} 
\sphinxAtStartPar
Include overhead for snapshots, backups, and temporary files

\item {} 
\sphinxAtStartPar
Reserve 10\sphinxhyphen{}15\% free space for optimal performance

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Performance Requirements:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Benchmark current workload}
iotop\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }head\PYG{+w}{ }\PYGZhy{}20

\PYG{c+c1}{\PYGZsh{} Monitor I/O patterns}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{l+m}{60}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }io\PYGZhy{}analysis.log

\PYG{c+c1}{\PYGZsh{} Calculate IOPS requirements}
\PYG{c+c1}{\PYGZsh{} Sequential workloads: 100\PYGZhy{}500 IOPS}
\PYG{c+c1}{\PYGZsh{} Random workloads: 1000\PYGZhy{}10000+ IOPS}
\PYG{c+c1}{\PYGZsh{} Database workloads: 5000\PYGZhy{}50000+ IOPS}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Storage Hierarchy Design:}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hot Data} (frequently accessed)
\sphinxhyphen{} NVMe SSD for highest performance
\sphinxhyphen{} Direct attachment or high\sphinxhyphen{}speed SAN

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Warm Data} (regularly accessed)
\sphinxhyphen{} SATA SSD or high\sphinxhyphen{}performance HDD
\sphinxhyphen{} Network storage with good connectivity

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Cold Data} (archival/backup)
\sphinxhyphen{} High\sphinxhyphen{}capacity HDD
\sphinxhyphen{} Object storage or tape for long\sphinxhyphen{}term retention

\end{enumerate}


\subsection{Filesystem Selection Guidelines}
\label{\detokenize{best-practices:filesystem-selection-guidelines}}
\sphinxAtStartPar
\sphinxstylestrong{Ext4 \sphinxhyphen{} General Purpose:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Optimal for most workloads}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{n+nv}{stride}\PYG{o}{=}\PYG{l+m}{32},stripe\PYGZhy{}width\PYG{o}{=}\PYG{l+m}{64}\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Mount options for performance}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }noatime,nodiratime,data\PYG{o}{=}writeback\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstyleemphasis{Use Cases:} Boot partitions, general file storage, databases with simple requirements

\sphinxAtStartPar
\sphinxstylestrong{XFS \sphinxhyphen{} High Performance:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create with optimal settings}
sudo\PYG{+w}{ }mkfs.xfs\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{n+nv}{size}\PYG{o}{=}\PYG{l+m}{4096}\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{n+nv}{agcount}\PYG{o}{=}\PYG{l+m}{8}\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Mount with performance options}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }noatime,logbsize\PYG{o}{=}256k,largeio\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstyleemphasis{Use Cases:} Large files, high\sphinxhyphen{}throughput applications, media streaming

\sphinxAtStartPar
\sphinxstylestrong{Btrfs \sphinxhyphen{} Advanced Features:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create with metadata redundancy}
sudo\PYG{+w}{ }mkfs.btrfs\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }raid1\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }single\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/dev/sdX2

\PYG{c+c1}{\PYGZsh{} Enable compression}
mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{compress}\PYG{o}{=}zstd,noatime\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }/mnt
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstyleemphasis{Use Cases:} Development environments, systems requiring snapshots, data integrity critical applications

\sphinxAtStartPar
\sphinxstylestrong{ZFS \sphinxhyphen{} Enterprise Features:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install ZFS}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }zfsutils\PYGZhy{}linux

\PYG{c+c1}{\PYGZsh{} Create pool with redundancy}
sudo\PYG{+w}{ }zpool\PYG{+w}{ }create\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{ashift}\PYG{o}{=}\PYG{l+m}{12}\PYG{+w}{ }tank\PYG{+w}{ }raidz2\PYG{+w}{ }/dev/sd\PYG{o}{[}abcd\PYG{o}{]}\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Create filesystem with compression}
sudo\PYG{+w}{ }zfs\PYG{+w}{ }create\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }\PYG{n+nv}{compression}\PYG{o}{=}lz4\PYG{+w}{ }tank/data
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstyleemphasis{Use Cases:} Enterprise storage, virtualization, backup systems


\section{Partitioning Best Practices}
\label{\detokenize{best-practices:partitioning-best-practices}}

\subsection{Partition Layout Strategy}
\label{\detokenize{best-practices:partition-layout-strategy}}
\sphinxAtStartPar
\sphinxstylestrong{Standard Desktop/Server Layout:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create GPT partition table}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mklabel\PYG{+w}{ }gpt

\PYG{c+c1}{\PYGZsh{} UEFI boot partition (512MB)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }fat32\PYG{+w}{ }1MiB\PYG{+w}{ }513MiB
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }esp\PYG{+w}{ }on

\PYG{c+c1}{\PYGZsh{} Root partition (20\PYGZhy{}50GB minimum)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }513MiB\PYG{+w}{ }50GiB

\PYG{c+c1}{\PYGZsh{} Home partition (remaining space)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }50GiB\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Server Layout with Separate Partitions:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Boot partition (1GB)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }1MiB\PYG{+w}{ }1GiB

\PYG{c+c1}{\PYGZsh{} Root partition (20GB)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }1GiB\PYG{+w}{ }21GiB

\PYG{c+c1}{\PYGZsh{} Var partition (10GB minimum)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }21GiB\PYG{+w}{ }31GiB

\PYG{c+c1}{\PYGZsh{} Home partition (as needed)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }31GiB\PYG{+w}{ }131GiB

\PYG{c+c1}{\PYGZsh{} Tmp partition (5GB)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }131GiB\PYG{+w}{ }136GiB
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{LVM\sphinxhyphen{}based Layout:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create LVM partition}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }513MiB\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }\PYG{n+nb}{set}\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }lvm\PYG{+w}{ }on

\PYG{c+c1}{\PYGZsh{} Initialize LVM}
sudo\PYG{+w}{ }pvcreate\PYG{+w}{ }/dev/sdX2
sudo\PYG{+w}{ }vgcreate\PYG{+w}{ }vg0\PYG{+w}{ }/dev/sdX2

\PYG{c+c1}{\PYGZsh{} Create logical volumes}
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }20G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }root\PYG{+w}{ }vg0
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }10G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }var\PYG{+w}{ }vg0
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }50G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }home\PYG{+w}{ }vg0
sudo\PYG{+w}{ }lvcreate\PYG{+w}{ }\PYGZhy{}L\PYG{+w}{ }4G\PYG{+w}{ }\PYGZhy{}n\PYG{+w}{ }swap\PYG{+w}{ }vg0
\end{sphinxVerbatim}


\subsection{Alignment and Performance}
\label{\detokenize{best-practices:alignment-and-performance}}
\sphinxAtStartPar
\sphinxstylestrong{Sector Alignment:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check disk sector size}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l\PYG{+w}{ }/dev/sdX\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Sector size\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} For 4K sectors, align to 4096\PYGZhy{}byte boundaries}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }4096s\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} For SSDs, align to 1MiB boundaries}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdX\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }1MiB\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}
\end{sphinxVerbatim}


\section{Security Best Practices}
\label{\detokenize{best-practices:security-best-practices}}

\subsection{Encryption at Rest}
\label{\detokenize{best-practices:encryption-at-rest}}
\sphinxAtStartPar
\sphinxstylestrong{LUKS Full Disk Encryption:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Encrypt partition}
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksFormat\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Open encrypted device}
sudo\PYG{+w}{ }cryptsetup\PYG{+w}{ }luksOpen\PYG{+w}{ }/dev/sdX1\PYG{+w}{ }encrypted\PYGZus{}root

\PYG{c+c1}{\PYGZsh{} Format encrypted device}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/mapper/encrypted\PYGZus{}root

\PYG{c+c1}{\PYGZsh{} Add to crypttab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}encrypted\PYGZus{}root /dev/sdX1 none luks\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/crypttab
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Directory\sphinxhyphen{}level Encryption:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install eCryptfs}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }ecryptfs\PYGZhy{}utils

\PYG{c+c1}{\PYGZsh{} Encrypt home directory}
sudo\PYG{+w}{ }ecryptfs\PYGZhy{}migrate\PYGZhy{}home\PYG{+w}{ }\PYGZhy{}u\PYG{+w}{ }username

\PYG{c+c1}{\PYGZsh{} Or encrypt specific directories}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }ecryptfs\PYG{+w}{ }/secure\PYG{+w}{ }/secure
\end{sphinxVerbatim}


\subsection{Access Control and Permissions}
\label{\detokenize{best-practices:access-control-and-permissions}}
\sphinxAtStartPar
\sphinxstylestrong{Principle of Least Privilege:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set restrictive default permissions}
\PYG{n+nb}{umask}\PYG{+w}{ }\PYG{l+m}{027}

\PYG{c+c1}{\PYGZsh{} Use groups for shared access}
sudo\PYG{+w}{ }groupadd\PYG{+w}{ }storage\PYGZhy{}users
sudo\PYG{+w}{ }usermod\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYGZhy{}G\PYG{+w}{ }storage\PYGZhy{}users\PYG{+w}{ }username

\PYG{c+c1}{\PYGZsh{} Set group ownership and permissions}
sudo\PYG{+w}{ }chgrp\PYG{+w}{ }\PYGZhy{}R\PYG{+w}{ }storage\PYGZhy{}users\PYG{+w}{ }/shared/storage
sudo\PYG{+w}{ }chmod\PYG{+w}{ }\PYGZhy{}R\PYG{+w}{ }\PYG{l+m}{750}\PYG{+w}{ }/shared/storage
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{File System Extended Attributes:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable ACLs on filesystem}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,acl\PYG{+w}{ }/dev/sdX1

\PYG{c+c1}{\PYGZsh{} Set Access Control Lists}
setfacl\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }u:username:rw\PYG{+w}{ }/secure/file.txt
setfacl\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }g:groupname:r\PYG{+w}{ }/secure/directory

\PYG{c+c1}{\PYGZsh{} View ACLs}
getfacl\PYG{+w}{ }/secure/file.txt
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Immutable Files:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Make file immutable}
sudo\PYG{+w}{ }chattr\PYG{+w}{ }+i\PYG{+w}{ }/critical/config.file

\PYG{c+c1}{\PYGZsh{} Make file append\PYGZhy{}only}
sudo\PYG{+w}{ }chattr\PYG{+w}{ }+a\PYG{+w}{ }/var/log/audit.log

\PYG{c+c1}{\PYGZsh{} View attributes}
lsattr\PYG{+w}{ }/critical/config.file
\end{sphinxVerbatim}


\section{Backup and Recovery Strategies}
\label{\detokenize{best-practices:backup-and-recovery-strategies}}

\subsection{Backup Strategy Framework}
\label{\detokenize{best-practices:backup-strategy-framework}}
\sphinxAtStartPar
\sphinxstylestrong{3\sphinxhyphen{}2\sphinxhyphen{}1 Rule Implementation:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{3} copies of important data

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{2} different storage media types

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{1} copy stored off\sphinxhyphen{}site

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Backup Types and Schedule:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Full backup (weekly)}
tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }/backup/full\PYGZhy{}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}.tar.gz\PYG{+w}{ }/home\PYG{+w}{ }/etc\PYG{+w}{ }/var/log

\PYG{c+c1}{\PYGZsh{} Incremental backup (daily)}
rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}link\PYGZhy{}dest\PYG{o}{=}/backup/last\PYGZhy{}backup\PYG{+w}{ }/home/\PYG{+w}{ }/backup/incremental\PYGZhy{}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}/

\PYG{c+c1}{\PYGZsh{} Differential backup (daily)}
tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }/backup/diff\PYGZhy{}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYG{k}{)}.tar.gz\PYG{+w}{ }\PYGZhy{}\PYGZhy{}newer\PYGZhy{}mtime\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}1 day ago\PYGZdq{}}\PYG{+w}{ }/home
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Automated Backup Script:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} /usr/local/bin/backup\PYGZhy{}manager.sh}

\PYG{n+nv}{BACKUP\PYGZus{}ROOT}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/backup\PYGZdq{}}
\PYG{n+nv}{SOURCE\PYGZus{}DIRS}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/home /etc /var/log\PYGZdq{}}
\PYG{n+nv}{RETENTION\PYGZus{}DAYS}\PYG{o}{=}\PYG{l+m}{30}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/backup.log\PYGZdq{}}

log\PYGZus{}message\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}Y\PYGZhy{}\PYGZpc{}m\PYGZhy{}\PYGZpc{}d \PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

perform\PYGZus{}backup\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}ROOT}\PYG{l+s+s2}{/}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}type}\PYG{l+s+s2}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d\PYGZus{}\PYGZpc{}H\PYGZpc{}M\PYGZpc{}S\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}type}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}full\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{/system.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIRS}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{        }\PYG{l+s+s2}{\PYGZdq{}incremental\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{            }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{last\PYGZus{}backup}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}ROOT}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}incremental\PYGZhy{}*\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}1\PYG{k}{)}
\PYG{+w}{            }rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}link\PYGZhy{}dest\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}last\PYGZus{}backup}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIRS}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{esac}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create checksum}
\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }sha256sum\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{/checksums.sha256}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Backup completed: }\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

cleanup\PYGZus{}old\PYGZus{}backups\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }find\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BACKUP\PYGZus{}ROOT}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }d\PYG{+w}{ }\PYGZhy{}mtime\PYG{+w}{ }+\PYG{n+nv}{\PYGZdl{}RETENTION\PYGZus{}DAYS}\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}
\PYG{+w}{    }log\PYGZus{}message\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Cleaned up backups older than }\PYG{n+nv}{\PYGZdl{}RETENTION\PYGZus{}DAYS}\PYG{l+s+s2}{ days}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Run backup based on day of week}
\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}u\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}eq\PYG{+w}{ }\PYG{l+m}{7}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{    }perform\PYGZus{}backup\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}full\PYGZdq{}}
\PYG{k}{else}
\PYG{+w}{    }perform\PYGZus{}backup\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}incremental\PYGZdq{}}
\PYG{k}{fi}

cleanup\PYGZus{}old\PYGZus{}backups
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Backup Verification:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Verify backup integrity}
\PYG{c+c1}{\PYGZsh{}!/bin/bash}
verify\PYGZus{}backup\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{backup\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check checksums}
\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}backup\PYGZus{}dir}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }sha256sum\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }checksums.sha256

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Test archive extraction}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }system.tar.gz\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }tar\PYG{+w}{ }\PYGZhy{}tzf\PYG{+w}{ }system.tar.gz\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Archive OK\PYGZdq{}}\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Archive CORRUPTED\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Check file count}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{file\PYGZus{}count}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}find\PYG{+w}{ }.\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }wc\PYG{+w}{ }\PYGZhy{}l\PYG{k}{)}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Files in backup: }\PYG{n+nv}{\PYGZdl{}file\PYGZus{}count}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}
\end{sphinxVerbatim}


\subsection{Recovery Planning}
\label{\detokenize{best-practices:recovery-planning}}
\sphinxAtStartPar
\sphinxstylestrong{Recovery Time Objective (RTO) and Recovery Point Objective (RPO):}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Critical Systems:} RTO \textless{} 4 hours, RPO \textless{} 1 hour

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Important Systems:} RTO \textless{} 24 hours, RPO \textless{} 4 hours

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Standard Systems:} RTO \textless{} 72 hours, RPO \textless{} 24 hours

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Disaster Recovery Procedures:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create disaster recovery documentation}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/disaster\PYGZhy{}recovery.md\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{} Disaster Recovery Procedures}

\PYG{l+s}{\PYGZsh{}\PYGZsh{} Critical Information}
\PYG{l+s}{\PYGZhy{} Backup Location: /backup and remote://backup\PYGZhy{}server/}
\PYG{l+s}{\PYGZhy{} Recovery Media: Ubuntu 22.04 Live USB}
\PYG{l+s}{\PYGZhy{} Key Personnel: admin@company.com, +1\PYGZhy{}555\PYGZhy{}0123}

\PYG{l+s}{\PYGZsh{}\PYGZsh{} Recovery Steps}
\PYG{l+s}{1. Boot from recovery media}
\PYG{l+s}{2. Identify storage devices: `lsblk`}
\PYG{l+s}{3. Mount backup location}
\PYG{l+s}{4. Restore from most recent backup}
\PYG{l+s}{5. Verify system integrity}
\PYG{l+s}{6. Update disaster recovery log}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\section{Performance Optimization}
\label{\detokenize{best-practices:performance-optimization}}

\subsection{I/O Optimization}
\label{\detokenize{best-practices:i-o-optimization}}
\sphinxAtStartPar
\sphinxstylestrong{I/O Scheduler Tuning:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check current scheduler}
cat\PYG{+w}{ }/sys/block/sdX/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Set optimal scheduler per device type}
\PYG{c+c1}{\PYGZsh{} For SSDs}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/nvme0n1/queue/scheduler

\PYG{c+c1}{\PYGZsh{} For HDDs}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Make permanent}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}ACTION==\PYGZdq{}add|change\PYGZdq{}, KERNEL==\PYGZdq{}sd[a\PYGZhy{}z]*\PYGZdq{}, ATTR\PYGZob{}queue/rotational\PYGZcb{}==\PYGZdq{}0\PYGZdq{}, ATTR\PYGZob{}queue/scheduler\PYGZcb{}=\PYGZdq{}none\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/etc/udev/rules.d/60\PYGZhy{}ssd\PYGZhy{}scheduler.rules
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Read\sphinxhyphen{}ahead Optimization:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check current read\PYGZhy{}ahead}
sudo\PYG{+w}{ }blockdev\PYG{+w}{ }\PYGZhy{}\PYGZhy{}getra\PYG{+w}{ }/dev/sdX

\PYG{c+c1}{\PYGZsh{} Set read\PYGZhy{}ahead for sequential workloads}
sudo\PYG{+w}{ }blockdev\PYG{+w}{ }\PYGZhy{}\PYGZhy{}setra\PYG{+w}{ }\PYG{l+m}{4096}\PYG{+w}{ }/dev/sdX\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} For large files}
sudo\PYG{+w}{ }blockdev\PYG{+w}{ }\PYGZhy{}\PYGZhy{}setra\PYG{+w}{ }\PYG{l+m}{256}\PYG{+w}{ }/dev/sdX\PYG{+w}{   }\PYG{c+c1}{\PYGZsh{} For random access}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Mount Options for Performance:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} High\PYGZhy{}performance mount options}
\PYG{c+c1}{\PYGZsh{} /etc/fstab entries:}

\PYG{c+c1}{\PYGZsh{} For databases (ext4)}
/dev/mapper/db\PYGZhy{}data\PYG{+w}{ }/var/lib/mysql\PYG{+w}{ }ext4\PYG{+w}{ }noatime,nodiratime,data\PYG{o}{=}writeback,barrier\PYG{o}{=}\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{2}

\PYG{c+c1}{\PYGZsh{} For web servers (ext4)}
/dev/mapper/web\PYGZhy{}data\PYG{+w}{ }/var/www\PYG{+w}{ }ext4\PYG{+w}{ }noatime,nodiratime,data\PYG{o}{=}ordered\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{2}

\PYG{c+c1}{\PYGZsh{} For temporary files}
tmpfs\PYG{+w}{ }/tmp\PYG{+w}{ }tmpfs\PYG{+w}{ }defaults,noatime,size\PYG{o}{=}2G\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{l+m}{0}
\end{sphinxVerbatim}


\subsection{Memory and Cache Optimization}
\label{\detokenize{best-practices:memory-and-cache-optimization}}
\sphinxAtStartPar
\sphinxstylestrong{File System Cache Tuning:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Adjust dirty page writeback}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{5}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/vm/dirty\PYGZus{}ratio
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/vm/dirty\PYGZus{}background\PYGZus{}ratio

\PYG{c+c1}{\PYGZsh{} Reduce swappiness for database servers}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/proc/sys/vm/swappiness

\PYG{c+c1}{\PYGZsh{} Make changes permanent}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}vm.dirty\PYGZus{}ratio = 5\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/sysctl.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}vm.dirty\PYGZus{}background\PYGZus{}ratio = 2\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/sysctl.conf
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}vm.swappiness = 1\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/sysctl.conf
\end{sphinxVerbatim}


\section{Monitoring and Alerting}
\label{\detokenize{best-practices:monitoring-and-alerting}}

\subsection{Proactive Monitoring}
\label{\detokenize{best-practices:proactive-monitoring}}
\sphinxAtStartPar
\sphinxstylestrong{Key Metrics to Monitor:}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Storage Capacity:} Disk usage, inode usage, growth trends

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance:} IOPS, throughput, latency, queue depth

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Health:} SMART status, error rates, temperature

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Availability:} Mount status, filesystem errors, RAID status

\end{enumerate}

\sphinxAtStartPar
\sphinxstylestrong{Monitoring Script:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} /usr/local/bin/storage\PYGZhy{}monitor.sh}

\PYG{n+nv}{ALERT\PYGZus{}EMAIL}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}admin@company.com\PYGZdq{}}
\PYG{n+nv}{LOG\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/var/log/storage\PYGZhy{}monitor.log\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Thresholds}
\PYG{n+nv}{DISK\PYGZus{}USAGE\PYGZus{}WARN}\PYG{o}{=}\PYG{l+m}{80}
\PYG{n+nv}{DISK\PYGZus{}USAGE\PYGZus{}CRIT}\PYG{o}{=}\PYG{l+m}{90}
\PYG{n+nv}{INODE\PYGZus{}USAGE\PYGZus{}WARN}\PYG{o}{=}\PYG{l+m}{80}
\PYG{n+nv}{LOAD\PYGZus{}WARN}\PYG{o}{=}\PYG{l+m}{2}.0

send\PYGZus{}alert\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{subject}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{message}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}2}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}message}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}subject}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}ALERT\PYGZus{}EMAIL}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{: ALERT \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}subject}\PYG{l+s+s2}{ \PYGZhy{} }\PYG{n+nv}{\PYGZdl{}message}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZgt{}\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}LOG\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}disk\PYGZus{}usage\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }\PYG{k}{while}\PYG{+w}{ }\PYG{n+nb}{read}\PYG{+w}{ }filesystem\PYG{+w}{ }size\PYG{+w}{ }used\PYG{+w}{ }avail\PYG{+w}{ }percent\PYG{+w}{ }mountpoint\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}percent}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{=}\PYGZti{}\PYG{+w}{ }\PYG{o}{(}\PYG{o}{[}\PYG{l+m}{0}\PYGZhy{}9\PYG{o}{]}+\PYG{o}{)}\PYGZpc{}\PYG{+w}{ }\PYG{o}{]}\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nv}{usage}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BASH\PYGZus{}REMATCH}\PYG{p}{[1]}\PYG{l+s+si}{\PYGZcb{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}DISK\PYGZus{}USAGE\PYGZus{}CRIT}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }send\PYGZus{}alert\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}CRITICAL: Disk Usage\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{elif}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}usage}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}gt\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}DISK\PYGZus{}USAGE\PYGZus{}WARN}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }send\PYGZus{}alert\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}WARNING: Disk Usage\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}mountpoint}\PYG{l+s+s2}{ is }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{usage}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZpc{} full}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}smart\PYGZus{}status\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{+w}{ }/dev/nvme\PYG{o}{[}\PYG{l+m}{0}\PYGZhy{}9\PYG{o}{]}n\PYG{o}{[}\PYG{l+m}{0}\PYGZhy{}9\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}PASSED\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{                }send\PYGZus{}alert\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}CRITICAL: SMART Failure\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Device }\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{ failed SMART test}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{k}{fi}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}raid\PYGZus{}status\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/proc/mdstat\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}q\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZus{}\PYGZdq{}}\PYG{+w}{ }/proc/mdstat\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }send\PYGZus{}alert\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}WARNING: RAID Degraded\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Software RAID array is degraded\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Run checks}
check\PYGZus{}disk\PYGZus{}usage
check\PYGZus{}smart\PYGZus{}status
check\PYGZus{}raid\PYGZus{}status
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Automated Health Reports:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Daily storage health report}

\PYG{n+nv}{REPORT\PYGZus{}FILE}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/tmp/daily\PYGZhy{}storage\PYGZhy{}report.txt\PYGZdq{}}

\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Daily Storage Health Report \PYGZhy{} }\PYG{k}{\PYGZdl{}(}date\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}===========================================\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}DISK USAGE:\PYGZdq{}}
\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}h
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}INODE USAGE:\PYGZdq{}}
\PYG{+w}{    }df\PYG{+w}{ }\PYGZhy{}i
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SYSTEM LOAD:\PYGZdq{}}
\PYG{+w}{    }uptime
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}I/O STATISTICS (last hour):\PYGZdq{}}
\PYG{+w}{    }sar\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }\PYGZhy{}d\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}1 hour ago\PYGZsq{}}\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}+\PYGZpc{}H:\PYGZpc{}M:\PYGZpc{}S\PYGZsq{}}\PYG{k}{)}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }tail\PYG{+w}{ }\PYGZhy{}20
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}RAID STATUS:\PYGZdq{}}
\PYG{+w}{    }cat\PYG{+w}{ }/proc/mdstat\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}No software RAID detected\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}

\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}SMART STATUS:\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{: }\PYG{k}{\PYGZdl{}(}smartctl\PYG{+w}{ }\PYGZhy{}H\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }overall\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{done}

\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}REPORT\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Email report}
mail\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Daily Storage Report \PYGZhy{} }\PYG{k}{\PYGZdl{}(}hostname\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }admin@company.com\PYG{+w}{ }\PYGZlt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}REPORT\PYGZus{}FILE}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\section{Maintenance Procedures}
\label{\detokenize{best-practices:maintenance-procedures}}

\subsection{Regular Maintenance Tasks}
\label{\detokenize{best-practices:regular-maintenance-tasks}}
\sphinxAtStartPar
\sphinxstylestrong{Weekly Tasks:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Weekly maintenance script}

\PYG{c+c1}{\PYGZsh{} SMART tests}
\PYG{k}{for}\PYG{+w}{ }device\PYG{+w}{ }\PYG{k}{in}\PYG{+w}{ }/dev/sd\PYG{o}{[}a\PYGZhy{}z\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{do}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }smartctl\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }long\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}device}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{k}{done}

\PYG{c+c1}{\PYGZsh{} Filesystem checks}
find\PYG{+w}{ }/var/log\PYG{+w}{ }\PYGZhy{}name\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}*.log\PYGZdq{}}\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+100M\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }logrotate\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{};}

\PYG{c+c1}{\PYGZsh{} Clean temporary files}
find\PYG{+w}{ }/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}atime\PYG{+w}{ }+7\PYG{+w}{ }\PYGZhy{}delete
find\PYG{+w}{ }/var/tmp\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}atime\PYG{+w}{ }+30\PYG{+w}{ }\PYGZhy{}delete

\PYG{c+c1}{\PYGZsh{} Update package cache}
apt\PYG{+w}{ }update
apt\PYG{+w}{ }list\PYG{+w}{ }\PYGZhy{}\PYGZhy{}upgradable
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Monthly Tasks:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} Monthly maintenance script}

\PYG{c+c1}{\PYGZsh{} Full system backup verification}
/usr/local/bin/verify\PYGZhy{}backups.sh

\PYG{c+c1}{\PYGZsh{} Storage capacity planning}
/usr/local/bin/capacity\PYGZhy{}report.sh

\PYG{c+c1}{\PYGZsh{} Security updates}
apt\PYG{+w}{ }upgrade\PYG{+w}{ }\PYGZhy{}y

\PYG{c+c1}{\PYGZsh{} Performance baseline}
/usr/local/bin/performance\PYGZhy{}benchmark.sh
\end{sphinxVerbatim}


\section{Documentation and Change Management}
\label{\detokenize{best-practices:documentation-and-change-management}}

\subsection{Documentation Standards}
\label{\detokenize{best-practices:documentation-standards}}
\sphinxAtStartPar
\sphinxstylestrong{Storage Configuration Documentation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Create storage inventory}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/etc/storage\PYGZhy{}inventory.yaml\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{storage\PYGZus{}systems:}
\PYG{l+s}{  \PYGZhy{} name: \PYGZdq{}Primary Storage\PYGZdq{}}
\PYG{l+s}{    type: \PYGZdq{}LVM on RAID1\PYGZdq{}}
\PYG{l+s}{    devices: [\PYGZdq{}/dev/sda\PYGZdq{}, \PYGZdq{}/dev/sdb\PYGZdq{}]}
\PYG{l+s}{    capacity: \PYGZdq{}2TB\PYGZdq{}}
\PYG{l+s}{    filesystem: \PYGZdq{}ext4\PYGZdq{}}
\PYG{l+s}{    mount\PYGZus{}points:}
\PYG{l+s}{      \PYGZhy{} \PYGZdq{}/\PYGZdq{}: \PYGZdq{}50GB\PYGZdq{}}
\PYG{l+s}{      \PYGZhy{} \PYGZdq{}/home\PYGZdq{}: \PYGZdq{}1.5TB\PYGZdq{}}
\PYG{l+s}{      \PYGZhy{} \PYGZdq{}/var\PYGZdq{}: \PYGZdq{}200GB\PYGZdq{}}
\PYG{l+s}{    backup\PYGZus{}schedule: \PYGZdq{}Daily incremental, Weekly full\PYGZdq{}}

\PYG{l+s}{  \PYGZhy{} name: \PYGZdq{}Database Storage\PYGZdq{}}
\PYG{l+s}{    type: \PYGZdq{}Direct attach NVMe\PYGZdq{}}
\PYG{l+s}{    devices: [\PYGZdq{}/dev/nvme0n1\PYGZdq{}]}
\PYG{l+s}{    capacity: \PYGZdq{}1TB\PYGZdq{}}
\PYG{l+s}{    filesystem: \PYGZdq{}xfs\PYGZdq{}}
\PYG{l+s}{    mount\PYGZus{}points:}
\PYG{l+s}{      \PYGZhy{} \PYGZdq{}/var/lib/mysql\PYGZdq{}: \PYGZdq{}800GB\PYGZdq{}}
\PYG{l+s}{    backup\PYGZus{}schedule: \PYGZdq{}Hourly snapshots, Daily backup\PYGZdq{}}

\PYG{l+s}{network\PYGZus{}storage:}
\PYG{l+s}{  \PYGZhy{} name: \PYGZdq{}Archive NFS\PYGZdq{}}
\PYG{l+s}{    server: \PYGZdq{}nas.company.local\PYGZdq{}}
\PYG{l+s}{    export: \PYGZdq{}/export/archive\PYGZdq{}}
\PYG{l+s}{    mount\PYGZus{}point: \PYGZdq{}/mnt/archive\PYGZdq{}}
\PYG{l+s}{    options: \PYGZdq{}rw,soft,intr\PYGZdq{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Change Management Process:}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Document all changes} in \sphinxtitleref{/var/log/storage\sphinxhyphen{}changes.log}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Test changes} in development environment first

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Create rollback plan} before implementing

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monitor system} after changes for 24\sphinxhyphen{}48 hours

\end{enumerate}

\sphinxAtStartPar
These best practices provide a solid foundation for reliable, secure, and high\sphinxhyphen{}performing storage systems on Ubuntu 22.04. Regular review and updates of these practices ensure continued effectiveness as technology and requirements evolve.

\sphinxstepscope


\chapter{Glossary}
\label{\detokenize{glossary:glossary}}\label{\detokenize{glossary::doc}}
\sphinxAtStartPar
This glossary provides definitions for storage\sphinxhyphen{}related terms and concepts used throughout this documentation.
\begin{description}
\sphinxlineitem{AHCI\index{AHCI@\spxentry{AHCI}|spxpagem}\phantomsection\label{\detokenize{glossary:term-AHCI}}}
\sphinxAtStartPar
Advanced Host Controller Interface \sphinxhyphen{} A technical standard for SATA host controllers that allows software to communicate with storage devices.

\sphinxlineitem{Block Device\index{Block Device@\spxentry{Block Device}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Block-Device}}}
\sphinxAtStartPar
A type of device that provides buffered access to hardware devices, allowing data to be read and written in fixed\sphinxhyphen{}size blocks (typically 512 bytes or 4096 bytes).

\sphinxlineitem{Block Size\index{Block Size@\spxentry{Block Size}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Block-Size}}}
\sphinxAtStartPar
The minimum unit of data that a filesystem can allocate. Common block sizes are 4KB, 8KB, and 64KB. Larger block sizes are better for sequential access, while smaller block sizes are more efficient for random access.

\sphinxlineitem{BTRFS\index{BTRFS@\spxentry{BTRFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-BTRFS}}}
\sphinxAtStartPar
B\sphinxhyphen{}Tree File System \sphinxhyphen{} A modern filesystem for Linux that features snapshots, checksums, compression, and advanced volume management capabilities.

\sphinxlineitem{Cache\index{Cache@\spxentry{Cache}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Cache}}}
\sphinxAtStartPar
High\sphinxhyphen{}speed storage used to temporarily store frequently accessed data to improve performance. Can be implemented in hardware (disk cache) or software (filesystem cache).

\sphinxlineitem{CIFS\index{CIFS@\spxentry{CIFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-CIFS}}}
\sphinxAtStartPar
Common Internet File System \sphinxhyphen{} A network protocol used for sharing files, printers, and other resources between systems, primarily used with Windows networks.

\sphinxlineitem{DAS\index{DAS@\spxentry{DAS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-DAS}}}
\sphinxAtStartPar
Direct\sphinxhyphen{}Attached Storage \sphinxhyphen{} Storage devices directly connected to a single computer without a network connection, such as internal hard drives or external USB drives.

\sphinxlineitem{Defragmentation\index{Defragmentation@\spxentry{Defragmentation}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Defragmentation}}}
\sphinxAtStartPar
The process of reorganizing data on a storage device to reduce fragmentation and improve performance. Less relevant for modern filesystems and SSDs.

\sphinxlineitem{Device Mapper\index{Device Mapper@\spxentry{Device Mapper}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Device-Mapper}}}
\sphinxAtStartPar
A Linux kernel framework that provides a generic way to create virtual layers on top of block devices, used by LVM and device encryption.

\sphinxlineitem{Dirty Pages\index{Dirty Pages@\spxentry{Dirty Pages}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Dirty-Pages}}}
\sphinxAtStartPar
Memory pages that have been modified but not yet written to storage. The kernel manages when these pages are flushed to disk.

\sphinxlineitem{DM\sphinxhyphen{}Crypt\index{DM\sphinxhyphen{}Crypt@\spxentry{DM\sphinxhyphen{}Crypt}|spxpagem}\phantomsection\label{\detokenize{glossary:term-DM-Crypt}}}
\sphinxAtStartPar
Device\sphinxhyphen{}mapper crypt target \sphinxhyphen{} A Linux kernel module that provides transparent encryption of block devices using the device mapper infrastructure.

\sphinxlineitem{ECC\index{ECC@\spxentry{ECC}|spxpagem}\phantomsection\label{\detokenize{glossary:term-ECC}}}
\sphinxAtStartPar
Error\sphinxhyphen{}Correcting Code \sphinxhyphen{} Technology that detects and corrects data corruption errors in memory and storage systems.

\sphinxlineitem{Ext4\index{Ext4@\spxentry{Ext4}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Ext4}}}
\sphinxAtStartPar
Fourth Extended Filesystem \sphinxhyphen{} The default filesystem for many Linux distributions, offering journaling, large file support, and backward compatibility.

\sphinxlineitem{Filesystem\index{Filesystem@\spxentry{Filesystem}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Filesystem}}}
\sphinxAtStartPar
A method of organizing and storing data on storage devices. Examples include ext4, XFS, NTFS, and APFS.

\sphinxlineitem{FSTAB\index{FSTAB@\spxentry{FSTAB}|spxpagem}\phantomsection\label{\detokenize{glossary:term-FSTAB}}}
\sphinxAtStartPar
File Systems Table \sphinxhyphen{} A configuration file (/etc/fstab) that defines how disk partitions and storage devices should be mounted at boot time.

\sphinxlineitem{GPT\index{GPT@\spxentry{GPT}|spxpagem}\phantomsection\label{\detokenize{glossary:term-GPT}}}
\sphinxAtStartPar
GUID Partition Table \sphinxhyphen{} A modern partitioning scheme that replaces MBR, supporting larger disks and more partitions.

\sphinxlineitem{HDD\index{HDD@\spxentry{HDD}|spxpagem}\phantomsection\label{\detokenize{glossary:term-HDD}}}
\sphinxAtStartPar
Hard Disk Drive \sphinxhyphen{} Traditional storage device using spinning magnetic disks and mechanical read/write heads.

\sphinxlineitem{Hot Spare\index{Hot Spare@\spxentry{Hot Spare}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Hot-Spare}}}
\sphinxAtStartPar
A standby disk in a RAID array that automatically replaces a failed disk without manual intervention.

\sphinxlineitem{I/O\index{I/O@\spxentry{I/O}|spxpagem}\phantomsection\label{\detokenize{glossary:term-I-O}}}
\sphinxAtStartPar
Input/Output \sphinxhyphen{} Operations that transfer data between the computer and storage devices or other external systems.

\sphinxlineitem{Inode\index{Inode@\spxentry{Inode}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Inode}}}
\sphinxAtStartPar
Index node \sphinxhyphen{} A data structure that stores metadata about files and directories in Unix\sphinxhyphen{}like filesystems, including permissions, timestamps, and pointers to data blocks.

\sphinxlineitem{IOPS\index{IOPS@\spxentry{IOPS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-IOPS}}}
\sphinxAtStartPar
Input/Output Operations Per Second \sphinxhyphen{} A performance measurement indicating how many read/write operations a storage device can perform per second.

\sphinxlineitem{iSCSI\index{iSCSI@\spxentry{iSCSI}|spxpagem}\phantomsection\label{\detokenize{glossary:term-iSCSI}}}
\sphinxAtStartPar
Internet Small Computer Systems Interface \sphinxhyphen{} A protocol that allows SCSI commands to be sent over IP networks, enabling network\sphinxhyphen{}attached storage.

\sphinxlineitem{Journal\index{Journal@\spxentry{Journal}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Journal}}}
\sphinxAtStartPar
A log of filesystem changes used for crash recovery. Journaling filesystems can quickly recover from unexpected shutdowns by replaying the journal.

\sphinxlineitem{JBOD\index{JBOD@\spxentry{JBOD}|spxpagem}\phantomsection\label{\detokenize{glossary:term-JBOD}}}
\sphinxAtStartPar
Just a Bunch of Disks \sphinxhyphen{} A storage configuration where multiple disks are used independently without RAID redundancy.

\sphinxlineitem{LBA\index{LBA@\spxentry{LBA}|spxpagem}\phantomsection\label{\detokenize{glossary:term-LBA}}}
\sphinxAtStartPar
Logical Block Addressing \sphinxhyphen{} A method of addressing data blocks on storage devices using a linear sequence of block numbers.

\sphinxlineitem{Logical Volume\index{Logical Volume@\spxentry{Logical Volume}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Logical-Volume}}}
\sphinxAtStartPar
A virtual storage device created by LVM that can span multiple physical devices and be resized dynamically.

\sphinxlineitem{LUKS\index{LUKS@\spxentry{LUKS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-LUKS}}}
\sphinxAtStartPar
Linux Unified Key Setup \sphinxhyphen{} A disk encryption specification and reference implementation for Linux that provides a standard format for encrypted storage.

\sphinxlineitem{LUN\index{LUN@\spxentry{LUN}|spxpagem}\phantomsection\label{\detokenize{glossary:term-LUN}}}
\sphinxAtStartPar
Logical Unit Number \sphinxhyphen{} A number used to identify individual devices or logical units within a SCSI target.

\sphinxlineitem{LVM\index{LVM@\spxentry{LVM}|spxpagem}\phantomsection\label{\detokenize{glossary:term-LVM}}}
\sphinxAtStartPar
Logical Volume Manager \sphinxhyphen{} A system for managing disk space that provides volume management capabilities including resizing, snapshots, and spanning multiple devices.

\sphinxlineitem{MBR\index{MBR@\spxentry{MBR}|spxpagem}\phantomsection\label{\detokenize{glossary:term-MBR}}}
\sphinxAtStartPar
Master Boot Record \sphinxhyphen{} An older partitioning scheme limited to 2TB disks and 4 primary partitions.

\sphinxlineitem{mdadm\index{mdadm@\spxentry{mdadm}|spxpagem}\phantomsection\label{\detokenize{glossary:term-mdadm}}}
\sphinxAtStartPar
Multiple Device Administration \sphinxhyphen{} A Linux utility for managing software RAID arrays.

\sphinxlineitem{Mount Point\index{Mount Point@\spxentry{Mount Point}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Mount-Point}}}
\sphinxAtStartPar
A directory in the filesystem hierarchy where a storage device or filesystem is attached and made accessible.

\sphinxlineitem{NAS\index{NAS@\spxentry{NAS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-NAS}}}
\sphinxAtStartPar
Network\sphinxhyphen{}Attached Storage \sphinxhyphen{} File\sphinxhyphen{}level storage accessible over a network, typically using protocols like NFS or SMB/CIFS.

\sphinxlineitem{NFS\index{NFS@\spxentry{NFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-NFS}}}
\sphinxAtStartPar
Network File System \sphinxhyphen{} A protocol for sharing files over a network, allowing remote directories to be mounted as if they were local.

\sphinxlineitem{NVME\index{NVME@\spxentry{NVME}|spxpagem}\phantomsection\label{\detokenize{glossary:term-NVME}}}
\sphinxAtStartPar
Non\sphinxhyphen{}Volatile Memory Express \sphinxhyphen{} A high\sphinxhyphen{}performance interface for SSDs that connects directly to the CPU via PCIe lanes.

\sphinxlineitem{Partition\index{Partition@\spxentry{Partition}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Partition}}}
\sphinxAtStartPar
A logical division of a storage device that appears to the operating system as a separate device.

\sphinxlineitem{Physical Extent\index{Physical Extent@\spxentry{Physical Extent}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Physical-Extent}}}
\sphinxAtStartPar
The smallest unit of space allocation in LVM, typically 4MB in size.

\sphinxlineitem{Physical Volume\index{Physical Volume@\spxentry{Physical Volume}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Physical-Volume}}}
\sphinxAtStartPar
A storage device or partition that has been initialized for use with LVM.

\sphinxlineitem{RAID\index{RAID@\spxentry{RAID}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID}}}
\sphinxAtStartPar
Redundant Array of Independent Disks \sphinxhyphen{} A technology that combines multiple physical disks into logical units for redundancy, performance, or both.

\sphinxlineitem{RAID 0\index{RAID 0@\spxentry{RAID 0}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-0}}}
\sphinxAtStartPar
Disk striping without redundancy \sphinxhyphen{} improves performance but provides no fault tolerance.

\sphinxlineitem{RAID 1\index{RAID 1@\spxentry{RAID 1}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-1}}}
\sphinxAtStartPar
Disk mirroring \sphinxhyphen{} provides redundancy by maintaining identical copies of data on multiple disks.

\sphinxlineitem{RAID 5\index{RAID 5@\spxentry{RAID 5}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-5}}}
\sphinxAtStartPar
Distributed parity \sphinxhyphen{} requires minimum 3 disks, provides redundancy and improved read performance.

\sphinxlineitem{RAID 6\index{RAID 6@\spxentry{RAID 6}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-6}}}
\sphinxAtStartPar
Double distributed parity \sphinxhyphen{} requires minimum 4 disks, can tolerate failure of any two disks.

\sphinxlineitem{RAID 10\index{RAID 10@\spxentry{RAID 10}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-10}}}
\sphinxAtStartPar
Combination of RAID 1 and RAID 0 \sphinxhyphen{} provides both redundancy and performance improvements.

\sphinxlineitem{RPO\index{RPO@\spxentry{RPO}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RPO}}}
\sphinxAtStartPar
Recovery Point Objective \sphinxhyphen{} The maximum acceptable amount of data loss measured in time (e.g., 1 hour RPO means losing at most 1 hour of data).

\sphinxlineitem{RTO\index{RTO@\spxentry{RTO}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RTO}}}
\sphinxAtStartPar
Recovery Time Objective \sphinxhyphen{} The maximum acceptable time to restore service after a failure (e.g., 4 hour RTO means service must be restored within 4 hours).

\sphinxlineitem{SAN\index{SAN@\spxentry{SAN}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SAN}}}
\sphinxAtStartPar
Storage Area Network \sphinxhyphen{} A dedicated high\sphinxhyphen{}speed network that provides block\sphinxhyphen{}level access to storage devices.

\sphinxlineitem{SATA\index{SATA@\spxentry{SATA}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SATA}}}
\sphinxAtStartPar
Serial Advanced Technology Attachment \sphinxhyphen{} A computer bus interface for connecting storage devices like hard drives and SSDs.

\sphinxlineitem{SCSI\index{SCSI@\spxentry{SCSI}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SCSI}}}
\sphinxAtStartPar
Small Computer System Interface \sphinxhyphen{} A set of standards for connecting and transferring data between computers and storage devices.

\sphinxlineitem{Sector\index{Sector@\spxentry{Sector}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Sector}}}
\sphinxAtStartPar
The smallest addressable unit on a storage device, traditionally 512 bytes but increasingly 4096 bytes (4K sectors).

\sphinxlineitem{SMART\index{SMART@\spxentry{SMART}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SMART}}}
\sphinxAtStartPar
Self\sphinxhyphen{}Monitoring, Analysis and Reporting Technology \sphinxhyphen{} A monitoring system for storage devices that detects and reports various reliability indicators.

\sphinxlineitem{Snapshot\index{Snapshot@\spxentry{Snapshot}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Snapshot}}}
\sphinxAtStartPar
A point\sphinxhyphen{}in\sphinxhyphen{}time copy of a filesystem or volume that captures the state of data at a specific moment, useful for backups and recovery.

\sphinxlineitem{SSD\index{SSD@\spxentry{SSD}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SSD}}}
\sphinxAtStartPar
Solid State Drive \sphinxhyphen{} Storage device using NAND flash memory with no moving parts, offering better performance and reliability than HDDs.

\sphinxlineitem{Swap\index{Swap@\spxentry{Swap}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Swap}}}
\sphinxAtStartPar
Virtual memory space on storage devices used when physical RAM is insufficient. Also called a page file.

\sphinxlineitem{Throughput\index{Throughput@\spxentry{Throughput}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Throughput}}}
\sphinxAtStartPar
The amount of data transferred per unit of time, typically measured in MB/s or GB/s.

\sphinxlineitem{TRIM\index{TRIM@\spxentry{TRIM}|spxpagem}\phantomsection\label{\detokenize{glossary:term-TRIM}}}
\sphinxAtStartPar
A command that informs SSDs which data blocks are no longer needed, allowing the drive to optimize performance and wear leveling.

\sphinxlineitem{UUID\index{UUID@\spxentry{UUID}|spxpagem}\phantomsection\label{\detokenize{glossary:term-UUID}}}
\sphinxAtStartPar
Universally Unique Identifier \sphinxhyphen{} A 128\sphinxhyphen{}bit identifier used to uniquely identify storage devices and filesystems.

\sphinxlineitem{Volume Group\index{Volume Group@\spxentry{Volume Group}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Volume-Group}}}
\sphinxAtStartPar
A collection of physical volumes in LVM that provides a pool of storage space for creating logical volumes.

\sphinxlineitem{Wear Leveling\index{Wear Leveling@\spxentry{Wear Leveling}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Wear-Leveling}}}
\sphinxAtStartPar
A technique used in SSDs to distribute write operations evenly across memory cells to maximize device lifespan.

\sphinxlineitem{XFS\index{XFS@\spxentry{XFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-XFS}}}
\sphinxAtStartPar
A high\sphinxhyphen{}performance journaling filesystem originally developed for IRIX, known for excellent scalability and large file support.

\sphinxlineitem{ZFS\index{ZFS@\spxentry{ZFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-ZFS}}}
\sphinxAtStartPar
Zettabyte File System \sphinxhyphen{} An advanced filesystem and volume manager that provides features like checksums, compression, snapshots, and data deduplication.

\end{description}


\chapter{Common Command Abbreviations}
\label{\detokenize{glossary:common-command-abbreviations}}\begin{description}
\sphinxlineitem{blkid\index{blkid@\spxentry{blkid}|spxpagem}\phantomsection\label{\detokenize{glossary:term-blkid}}}
\sphinxAtStartPar
Block device identifier \sphinxhyphen{} Command to display information about block devices and their attributes.

\sphinxlineitem{dd\index{dd@\spxentry{dd}|spxpagem}\phantomsection\label{\detokenize{glossary:term-dd}}}
\sphinxAtStartPar
Data duplicator (historically “disk dump”) \sphinxhyphen{} Command for copying and converting raw data between devices.

\sphinxlineitem{df\index{df@\spxentry{df}|spxpagem}\phantomsection\label{\detokenize{glossary:term-df}}}
\sphinxAtStartPar
Disk free \sphinxhyphen{} Command to display filesystem disk space usage.

\sphinxlineitem{du\index{du@\spxentry{du}|spxpagem}\phantomsection\label{\detokenize{glossary:term-du}}}
\sphinxAtStartPar
Disk usage \sphinxhyphen{} Command to display directory space usage.

\sphinxlineitem{fdisk\index{fdisk@\spxentry{fdisk}|spxpagem}\phantomsection\label{\detokenize{glossary:term-fdisk}}}
\sphinxAtStartPar
Fixed disk \sphinxhyphen{} Partition table manipulator for MBR partitions.

\sphinxlineitem{fsck\index{fsck@\spxentry{fsck}|spxpagem}\phantomsection\label{\detokenize{glossary:term-fsck}}}
\sphinxAtStartPar
File system check \sphinxhyphen{} Command to check and repair filesystem errors.

\sphinxlineitem{gdisk\index{gdisk@\spxentry{gdisk}|spxpagem}\phantomsection\label{\detokenize{glossary:term-gdisk}}}
\sphinxAtStartPar
GPT fdisk \sphinxhyphen{} Partition table manipulator for GPT partitions.

\sphinxlineitem{lsblk\index{lsblk@\spxentry{lsblk}|spxpagem}\phantomsection\label{\detokenize{glossary:term-lsblk}}}
\sphinxAtStartPar
List block devices \sphinxhyphen{} Command to display block device information in tree format.

\sphinxlineitem{mount\index{mount@\spxentry{mount}|spxpagem}\phantomsection\label{\detokenize{glossary:term-mount}}}
\sphinxAtStartPar
Mount filesystem \sphinxhyphen{} Command to attach filesystems to the directory tree.

\sphinxlineitem{parted\index{parted@\spxentry{parted}|spxpagem}\phantomsection\label{\detokenize{glossary:term-parted}}}
\sphinxAtStartPar
Partition editor \sphinxhyphen{} Command\sphinxhyphen{}line tool for creating and manipulating partition tables.

\sphinxlineitem{rsync\index{rsync@\spxentry{rsync}|spxpagem}\phantomsection\label{\detokenize{glossary:term-rsync}}}
\sphinxAtStartPar
Remote sync \sphinxhyphen{} Command for efficiently synchronizing files and directories.

\sphinxlineitem{umount\index{umount@\spxentry{umount}|spxpagem}\phantomsection\label{\detokenize{glossary:term-umount}}}
\sphinxAtStartPar
Unmount filesystem \sphinxhyphen{} Command to detach filesystems from the directory tree.

\end{description}


\chapter{Storage Unit Definitions}
\label{\detokenize{glossary:storage-unit-definitions}}\begin{description}
\sphinxlineitem{Byte\index{Byte@\spxentry{Byte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Byte}}}
\sphinxAtStartPar
The basic unit of digital information, consisting of 8 bits.

\sphinxlineitem{KB (Kilobyte)\index{KB (Kilobyte)@\spxentry{KB}\spxextra{Kilobyte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-KB-Kilobyte}}}
\sphinxAtStartPar
1,000 bytes (decimal) or 1,024 bytes (binary, more precisely called KiB).

\sphinxlineitem{MB (Megabyte)\index{MB (Megabyte)@\spxentry{MB}\spxextra{Megabyte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-MB-Megabyte}}}
\sphinxAtStartPar
1,000,000 bytes (decimal) or 1,048,576 bytes (binary, more precisely called MiB).

\sphinxlineitem{GB (Gigabyte)\index{GB (Gigabyte)@\spxentry{GB}\spxextra{Gigabyte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-GB-Gigabyte}}}
\sphinxAtStartPar
1,000,000,000 bytes (decimal) or 1,073,741,824 bytes (binary, more precisely called GiB).

\sphinxlineitem{TB (Terabyte)\index{TB (Terabyte)@\spxentry{TB}\spxextra{Terabyte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-TB-Terabyte}}}
\sphinxAtStartPar
1,000,000,000,000 bytes (decimal) or 1,099,511,627,776 bytes (binary, more precisely called TiB).

\sphinxlineitem{PB (Petabyte)\index{PB (Petabyte)@\spxentry{PB}\spxextra{Petabyte}|spxpagem}\phantomsection\label{\detokenize{glossary:term-PB-Petabyte}}}
\sphinxAtStartPar
1,000,000,000,000,000 bytes (decimal) or 1,125,899,906,842,624 bytes (binary, more precisely called PiB).

\end{description}


\chapter{Performance Metrics}
\label{\detokenize{glossary:performance-metrics}}\begin{description}
\sphinxlineitem{Bandwidth\index{Bandwidth@\spxentry{Bandwidth}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Bandwidth}}}
\sphinxAtStartPar
The maximum data transfer rate of a storage system, typically measured in MB/s or GB/s.

\sphinxlineitem{Latency\index{Latency@\spxentry{Latency}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Latency}}}
\sphinxAtStartPar
The time delay between when a storage operation is requested and when it begins, typically measured in milliseconds.

\sphinxlineitem{Queue Depth\index{Queue Depth@\spxentry{Queue Depth}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Queue-Depth}}}
\sphinxAtStartPar
The number of pending I/O operations that can be queued for processing by a storage device.

\sphinxlineitem{Random I/O\index{Random I/O@\spxentry{Random I/O}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Random-I-O}}}
\sphinxAtStartPar
Storage operations that access data at non\sphinxhyphen{}sequential locations, typically slower than sequential I/O.

\sphinxlineitem{Sequential I/O\index{Sequential I/O@\spxentry{Sequential I/O}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Sequential-I-O}}}
\sphinxAtStartPar
Storage operations that access data in a continuous, ordered manner, typically faster than random I/O.

\sphinxlineitem{Sustained Transfer Rate\index{Sustained Transfer Rate@\spxentry{Sustained Transfer Rate}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Sustained-Transfer-Rate}}}
\sphinxAtStartPar
The average data transfer rate over an extended period, excluding burst performance.

\end{description}


\chapter{RAID Levels Reference}
\label{\detokenize{glossary:raid-levels-reference}}\begin{description}
\sphinxlineitem{RAID 0\index{RAID 0@\spxentry{RAID 0}|spxpagem}\phantomsection\label{\detokenize{glossary:term-0}}}
\sphinxAtStartPar
Striping \sphinxhyphen{} Data is split across multiple drives for improved performance. No redundancy. Minimum 2 drives.

\sphinxlineitem{RAID 1\index{RAID 1@\spxentry{RAID 1}|spxpagem}\phantomsection\label{\detokenize{glossary:term-1}}}
\sphinxAtStartPar
Mirroring \sphinxhyphen{} Data is duplicated across drives for redundancy. 50\% storage efficiency. Minimum 2 drives.

\sphinxlineitem{RAID 5\index{RAID 5@\spxentry{RAID 5}|spxpagem}\phantomsection\label{\detokenize{glossary:term-2}}}
\sphinxAtStartPar
Distributed parity \sphinxhyphen{} Data and parity information spread across all drives. Can lose 1 drive. Minimum 3 drives.

\sphinxlineitem{RAID 6\index{RAID 6@\spxentry{RAID 6}|spxpagem}\phantomsection\label{\detokenize{glossary:term-3}}}
\sphinxAtStartPar
Double parity \sphinxhyphen{} Two parity blocks per stripe. Can lose 2 drives. Minimum 4 drives.

\sphinxlineitem{RAID 10\index{RAID 10@\spxentry{RAID 10}|spxpagem}\phantomsection\label{\detokenize{glossary:term-4}}}
\sphinxAtStartPar
Mirror of stripes \sphinxhyphen{} Combines RAID 1 and RAID 0. High performance and redundancy. Minimum 4 drives.

\sphinxlineitem{RAID 50\index{RAID 50@\spxentry{RAID 50}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-50}}}
\sphinxAtStartPar
Striped RAID 5 \sphinxhyphen{} Multiple RAID 5 arrays striped together. Minimum 6 drives.

\sphinxlineitem{RAID 60\index{RAID 60@\spxentry{RAID 60}|spxpagem}\phantomsection\label{\detokenize{glossary:term-RAID-60}}}
\sphinxAtStartPar
Striped RAID 6 \sphinxhyphen{} Multiple RAID 6 arrays striped together. Minimum 8 drives.

\end{description}


\chapter{Network Storage Protocols}
\label{\detokenize{glossary:network-storage-protocols}}\begin{description}
\sphinxlineitem{AFP\index{AFP@\spxentry{AFP}|spxpagem}\phantomsection\label{\detokenize{glossary:term-AFP}}}
\sphinxAtStartPar
Apple Filing Protocol \sphinxhyphen{} Network protocol for file sharing used primarily by Apple devices.

\sphinxlineitem{FTP\index{FTP@\spxentry{FTP}|spxpagem}\phantomsection\label{\detokenize{glossary:term-FTP}}}
\sphinxAtStartPar
File Transfer Protocol \sphinxhyphen{} Standard protocol for transferring files over networks.

\sphinxlineitem{HTTP/HTTPS\index{HTTP/HTTPS@\spxentry{HTTP/HTTPS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-HTTP-HTTPS}}}
\sphinxAtStartPar
Hypertext Transfer Protocol \sphinxhyphen{} Web protocol that can also be used for file access via WebDAV.

\sphinxlineitem{NFS v3\index{NFS v3@\spxentry{NFS v3}|spxpagem}\phantomsection\label{\detokenize{glossary:term-NFS-v3}}}
\sphinxAtStartPar
Network File System version 3 \sphinxhyphen{} Stateless file sharing protocol, widely supported.

\sphinxlineitem{NFS v4\index{NFS v4@\spxentry{NFS v4}|spxpagem}\phantomsection\label{\detokenize{glossary:term-NFS-v4}}}
\sphinxAtStartPar
Network File System version 4 \sphinxhyphen{} Stateful protocol with improved security and features.

\sphinxlineitem{SFTP\index{SFTP@\spxentry{SFTP}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SFTP}}}
\sphinxAtStartPar
SSH File Transfer Protocol \sphinxhyphen{} Secure file transfer protocol that operates over SSH.

\sphinxlineitem{SMB/CIFS\index{SMB/CIFS@\spxentry{SMB/CIFS}|spxpagem}\phantomsection\label{\detokenize{glossary:term-SMB-CIFS}}}
\sphinxAtStartPar
Server Message Block / Common Internet File System \sphinxhyphen{} File sharing protocol used primarily in Windows environments.

\sphinxlineitem{WebDAV\index{WebDAV@\spxentry{WebDAV}|spxpagem}\phantomsection\label{\detokenize{glossary:term-WebDAV}}}
\sphinxAtStartPar
Web Distributed Authoring and Versioning \sphinxhyphen{} Extension to HTTP for collaborative file management.

\end{description}


\chapter{File System Features}
\label{\detokenize{glossary:file-system-features}}\begin{description}
\sphinxlineitem{Compression\index{Compression@\spxentry{Compression}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Compression}}}
\sphinxAtStartPar
Feature that reduces file size by encoding data more efficiently, saving storage space at the cost of CPU overhead.

\sphinxlineitem{Copy\sphinxhyphen{}on\sphinxhyphen{}Write\index{Copy\sphinxhyphen{}on\sphinxhyphen{}Write@\spxentry{Copy\sphinxhyphen{}on\sphinxhyphen{}Write}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Copy-on-Write}}}
\sphinxAtStartPar
Technique where data is not physically copied until it is modified, used in snapshots and some filesystems.

\sphinxlineitem{Deduplication\index{Deduplication@\spxentry{Deduplication}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Deduplication}}}
\sphinxAtStartPar
Process of eliminating duplicate data to reduce storage requirements.

\sphinxlineitem{Encryption\index{Encryption@\spxentry{Encryption}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Encryption}}}
\sphinxAtStartPar
Process of encoding data to prevent unauthorized access, can be implemented at filesystem or block device level.

\sphinxlineitem{Journaling\index{Journaling@\spxentry{Journaling}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Journaling}}}
\sphinxAtStartPar
Technique that logs filesystem changes before committing them, enabling fast recovery after crashes.

\sphinxlineitem{Quotas\index{Quotas@\spxentry{Quotas}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Quotas}}}
\sphinxAtStartPar
Limits placed on storage usage by users or groups to prevent overconsumption of disk space.

\sphinxlineitem{Snapshots\index{Snapshots@\spxentry{Snapshots}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Snapshots}}}
\sphinxAtStartPar
Point\sphinxhyphen{}in\sphinxhyphen{}time copies of filesystem state that can be used for backups or recovery.

\sphinxlineitem{Sparse Files\index{Sparse Files@\spxentry{Sparse Files}|spxpagem}\phantomsection\label{\detokenize{glossary:term-Sparse-Files}}}
\sphinxAtStartPar
Files that contain large blocks of zero bytes that are not actually stored on disk, saving space.

\end{description}

\sphinxAtStartPar
This glossary provides essential terminology for understanding storage concepts in Ubuntu 22.04 and serves as a quick reference for technical terms used throughout the documentation.

\sphinxstepscope


\chapter{Frequently Asked Questions}
\label{\detokenize{faq:frequently-asked-questions}}\label{\detokenize{faq::doc}}

\section{Storage Fundamentals}
\label{\detokenize{faq:storage-fundamentals}}

\subsection{Q: What’s the difference between storage and memory?}
\label{\detokenize{faq:q-what-s-the-difference-between-storage-and-memory}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Memory (RAM) is volatile storage that loses data when power is removed, while storage is non\sphinxhyphen{}volatile and retains data permanently. Memory provides temporary workspace for active programs, while storage provides long\sphinxhyphen{}term data retention.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check memory usage}
free\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Check storage usage}
df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Show memory and storage together}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Memory:\PYGZdq{}}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }free\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZbs{}\PYGZbs{}nStorage:\PYGZdq{}}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }df\PYG{+w}{ }\PYGZhy{}h
\end{sphinxVerbatim}


\subsection{Q: How do I determine what type of storage device I have?}
\label{\detokenize{faq:q-how-do-i-determine-what-type-of-storage-device-i-have}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these commands to identify your storage devices:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} List all block devices}
lsblk

\PYG{c+c1}{\PYGZsh{} Check if SSD or HDD}
cat\PYG{+w}{ }/sys/block/sda/queue/rotational
\PYG{c+c1}{\PYGZsh{} 0 = SSD, 1 = HDD}

\PYG{c+c1}{\PYGZsh{} Get detailed device information}
sudo\PYG{+w}{ }lshw\PYG{+w}{ }\PYGZhy{}class\PYG{+w}{ }disk

\PYG{c+c1}{\PYGZsh{} Check device specifications}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}I\PYG{+w}{ }/dev/sda\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(Model|Serial|LBA)\PYGZdq{}}
\end{sphinxVerbatim}


\subsection{Q: What filesystem should I use for different purposes?}
\label{\detokenize{faq:q-what-filesystem-should-i-use-for-different-purposes}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Choose based on your specific needs:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Purpose                | Recommended Filesystem | Reason
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Ubuntu root partition | ext4                   | Stable, well\PYGZhy{}tested
Large files (\PYGZgt{}4GB)    | XFS or ext4           | Better large file support
Snapshots needed       | Btrfs                 | Built\PYGZhy{}in snapshot capability
Windows compatibility  | NTFS                  | Cross\PYGZhy{}platform support
USB drives            | exFAT                 | Universal compatibility
Network shares        | ext4 or XFS           | Good network performance
\end{sphinxVerbatim}


\section{File System Management}
\label{\detokenize{faq:file-system-management}}

\subsection{Q: How do I safely resize a partition without losing data?}
\label{\detokenize{faq:q-how-do-i-safely-resize-a-partition-without-losing-data}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Follow these steps (ALWAYS backup first):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. BACKUP YOUR DATA FIRST!}

\PYG{c+c1}{\PYGZsh{} 2. Unmount the partition}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} 3. Check filesystem integrity}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} 4. Resize partition (using parted)}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sda\PYG{+w}{ }resizepart\PYG{+w}{ }\PYG{l+m}{2}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} 5. Resize filesystem to match partition}
sudo\PYG{+w}{ }resize2fs\PYG{+w}{ }/dev/sda2

\PYG{c+c1}{\PYGZsh{} 6. Mount and verify}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sda2\PYG{+w}{ }/mnt/test
df\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }/mnt/test
\end{sphinxVerbatim}


\subsection{Q: How can I recover deleted files?}
\label{\detokenize{faq:q-how-can-i-recover-deleted-files}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Recovery depends on how quickly you act and the filesystem type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install recovery tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }testdisk\PYG{+w}{ }photorec\PYG{+w}{ }extundelete

\PYG{c+c1}{\PYGZsh{} For ext4 filesystems (must act quickly)}
sudo\PYG{+w}{ }extundelete\PYG{+w}{ }/dev/sda1\PYG{+w}{ }\PYGZhy{}\PYGZhy{}restore\PYGZhy{}file\PYG{+w}{ }/path/to/deleted/file

\PYG{c+c1}{\PYGZsh{} For general file recovery}
sudo\PYG{+w}{ }photorec\PYG{+w}{ }/dev/sda1

\PYG{c+c1}{\PYGZsh{} For partition recovery}
sudo\PYG{+w}{ }testdisk\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Emergency: Stop using the drive immediately}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,ro\PYG{+w}{ }/dev/sda1
\end{sphinxVerbatim}


\subsection{Q: How do I check and repair filesystem errors?}
\label{\detokenize{faq:q-how-do-i-check-and-repair-filesystem-errors}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use appropriate tools for each filesystem type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For ext4 filesystems}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }/dev/sda1\PYG{+w}{     }\PYG{c+c1}{\PYGZsh{} Force check}
sudo\PYG{+w}{ }fsck.ext4\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }/dev/sda1\PYG{+w}{     }\PYG{c+c1}{\PYGZsh{} Automatic repair}

\PYG{c+c1}{\PYGZsh{} For XFS filesystems}
sudo\PYG{+w}{ }xfs\PYGZus{}check\PYG{+w}{ }/dev/sda1\PYG{+w}{        }\PYG{c+c1}{\PYGZsh{} Check only}
sudo\PYG{+w}{ }xfs\PYGZus{}repair\PYG{+w}{ }/dev/sda1\PYG{+w}{       }\PYG{c+c1}{\PYGZsh{} Repair}

\PYG{c+c1}{\PYGZsh{} For Btrfs filesystems}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }check\PYG{+w}{ }/dev/sda1\PYG{+w}{      }\PYG{c+c1}{\PYGZsh{} Check}
sudo\PYG{+w}{ }btrfs\PYG{+w}{ }check\PYG{+w}{ }\PYGZhy{}\PYGZhy{}repair\PYG{+w}{ }/dev/sda1\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Repair}

\PYG{c+c1}{\PYGZsh{} Check all filesystems in fstab}
sudo\PYG{+w}{ }fsck\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }\PYGZhy{}f
\end{sphinxVerbatim}


\section{Disk Management}
\label{\detokenize{faq:disk-management}}

\subsection{Q: How do I add a new hard drive to my Ubuntu system?}
\label{\detokenize{faq:q-how-do-i-add-a-new-hard-drive-to-my-ubuntu-system}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Follow this complete process:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Identify the new drive}
sudo\PYG{+w}{ }fdisk\PYG{+w}{ }\PYGZhy{}l
lsblk

\PYG{c+c1}{\PYGZsh{} 2. Create partition table}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mklabel\PYG{+w}{ }gpt

\PYG{c+c1}{\PYGZsh{} 3. Create partition}
sudo\PYG{+w}{ }parted\PYG{+w}{ }/dev/sdb\PYG{+w}{ }mkpart\PYG{+w}{ }primary\PYG{+w}{ }ext4\PYG{+w}{ }\PYG{l+m}{0}\PYGZpc{}\PYG{+w}{ }\PYG{l+m}{100}\PYGZpc{}

\PYG{c+c1}{\PYGZsh{} 4. Format the partition}
sudo\PYG{+w}{ }mkfs.ext4\PYG{+w}{ }/dev/sdb1

\PYG{c+c1}{\PYGZsh{} 5. Create mount point}
sudo\PYG{+w}{ }mkdir\PYG{+w}{ }/mnt/newdrive

\PYG{c+c1}{\PYGZsh{} 6. Mount temporarily}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sdb1\PYG{+w}{ }/mnt/newdrive

\PYG{c+c1}{\PYGZsh{} 7. Add to fstab for permanent mounting}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UUID=}\PYG{k}{\PYGZdl{}(}sudo\PYG{+w}{ }blkid\PYG{+w}{ }\PYGZhy{}s\PYG{+w}{ }UUID\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }value\PYG{+w}{ }/dev/sdb1\PYG{k}{)}\PYG{l+s+s2}{ /mnt/newdrive ext4 defaults 0 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} 8. Test fstab entry}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/mnt/newdrive
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}a
\end{sphinxVerbatim}


\subsection{Q: How can I improve disk performance?}
\label{\detokenize{faq:q-how-can-i-improve-disk-performance}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Several optimization techniques:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable TRIM for SSDs}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Optimize I/O scheduler}
\PYG{c+c1}{\PYGZsh{} For SSDs}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} For HDDs}
\PYG{n+nb}{echo}\PYG{+w}{ }mq\PYGZhy{}deadline\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Optimize mount options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,noatime,discard\PYG{+w}{ }/dev/sda1

\PYG{c+c1}{\PYGZsh{} Disable swap if you have enough RAM}
sudo\PYG{+w}{ }swapoff\PYG{+w}{ }\PYGZhy{}a
\PYG{c+c1}{\PYGZsh{} Comment out swap in /etc/fstab}

\PYG{c+c1}{\PYGZsh{} Optimize filesystem}
sudo\PYG{+w}{ }tune2fs\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }discard\PYG{+w}{ }/dev/sda1
\end{sphinxVerbatim}


\subsection{Q: What should I do if my disk is failing?}
\label{\detokenize{faq:q-what-should-i-do-if-my-disk-is-failing}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Take immediate action to protect your data:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Check SMART status}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} 2. If drive is still accessible, backup immediately}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/dev/sda\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/backup/disk\PYGZus{}image.img\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{n+nv}{status}\PYG{o}{=}progress

\PYG{c+c1}{\PYGZsh{} 3. Or use ddrescue for damaged drives}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }gddrescue
sudo\PYG{+w}{ }ddrescue\PYG{+w}{ }/dev/sda\PYG{+w}{ }/backup/disk\PYGZus{}image.img\PYG{+w}{ }/backup/rescue.log

\PYG{c+c1}{\PYGZsh{} 4. Stop using the drive immediately}
sudo\PYG{+w}{ }umount\PYG{+w}{ }/dev/sda1

\PYG{c+c1}{\PYGZsh{} 5. Replace the drive and restore from backup}
\end{sphinxVerbatim}


\section{RAID Configuration}
\label{\detokenize{faq:raid-configuration}}

\subsection{Q: Which RAID level should I choose?}
\label{\detokenize{faq:q-which-raid-level-should-i-choose}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Choose based on your priorities:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Priority              | RAID Level | Min Disks | Capacity Loss | Performance
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Performance Only      | RAID 0     | 2         | None          | Excellent
Basic Redundancy      | RAID 1     | 2         | 50\PYGZpc{}           | Good Read
Balanced Performance  | RAID 5     | 3         | 1 disk        | Good
High Fault Tolerance  | RAID 6     | 4         | 2 disks       | Moderate
Performance + Safety  | RAID 10    | 4         | 50\PYGZpc{}           | Excellent
\end{sphinxVerbatim}


\subsection{Q: How do I replace a failed disk in a RAID array?}
\label{\detokenize{faq:q-how-do-i-replace-a-failed-disk-in-a-raid-array}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Steps for replacing a failed RAID disk:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 1. Identify failed disk}
cat\PYG{+w}{ }/proc/mdstat
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}detail\PYG{+w}{ }/dev/md0

\PYG{c+c1}{\PYGZsh{} 2. Mark disk as failed (if not auto\PYGZhy{}detected)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}fail\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} 3. Remove failed disk from array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}remove\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} 4. Physically replace the disk}
\PYG{c+c1}{\PYGZsh{} Power down system if hot\PYGZhy{}swap not supported}

\PYG{c+c1}{\PYGZsh{} 5. Add new disk to array}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdb

\PYG{c+c1}{\PYGZsh{} 6. Monitor rebuild progress}
watch\PYG{+w}{ }cat\PYG{+w}{ }/proc/mdstat
\end{sphinxVerbatim}


\subsection{Q: Can I convert between RAID levels?}
\label{\detokenize{faq:q-can-i-convert-between-raid-levels}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Yes, but with limitations and requirements:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} RAID 1 to RAID 5 (requires adding a disk first)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sdd
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{5}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{3}

\PYG{c+c1}{\PYGZsh{} RAID 5 to RAID 6 (requires adding a disk)}
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}add\PYG{+w}{ }/dev/md0\PYG{+w}{ }/dev/sde
sudo\PYG{+w}{ }mdadm\PYG{+w}{ }\PYGZhy{}\PYGZhy{}grow\PYG{+w}{ }/dev/md0\PYG{+w}{ }\PYGZhy{}\PYGZhy{}level\PYG{o}{=}\PYG{l+m}{6}\PYG{+w}{ }\PYGZhy{}\PYGZhy{}raid\PYGZhy{}devices\PYG{o}{=}\PYG{l+m}{4}

\PYG{c+c1}{\PYGZsh{} Note: ALWAYS backup data before conversion}
\PYG{c+c1}{\PYGZsh{} Some conversions may not be possible}

\PYG{c+c1}{\PYGZsh{} Check conversion progress}
cat\PYG{+w}{ }/proc/mdstat
\end{sphinxVerbatim}


\section{Network Storage}
\label{\detokenize{faq:network-storage}}

\subsection{Q: Should I use NFS or SMB for file sharing?}
\label{\detokenize{faq:q-should-i-use-nfs-or-smb-for-file-sharing}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Choose based on your environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Scenario                    | Recommended | Reason
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}|\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
Linux\PYGZhy{}only environment     | NFS         | Better performance, native
Mixed OS (Linux/Windows/Mac)| SMB/CIFS    | Universal compatibility
High\PYGZhy{}performance computing  | NFS         | Lower overhead
Simple file sharing         | SMB/CIFS    | Easier to configure
Security\PYGZhy{}critical          | NFS + Kerberos | Better authentication
\end{sphinxVerbatim}


\subsection{Q: How do I troubleshoot slow network storage?}
\label{\detokenize{faq:q-how-do-i-troubleshoot-slow-network-storage}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Diagnose and optimize network storage performance:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Check network connectivity}
ping\PYG{+w}{ }storage\PYGZhy{}server
traceroute\PYG{+w}{ }storage\PYGZhy{}server

\PYG{c+c1}{\PYGZsh{} Test network bandwidth}
iperf3\PYG{+w}{ }\PYGZhy{}c\PYG{+w}{ }storage\PYGZhy{}server

\PYG{c+c1}{\PYGZsh{} Check mount options}
mount\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}(nfs|cifs)\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Optimize NFS mount options}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}o\PYG{+w}{ }remount,rsize\PYG{o}{=}\PYG{l+m}{32768},wsize\PYG{o}{=}\PYG{l+m}{32768},hard,intr\PYG{+w}{ }/mnt/nfs

\PYG{c+c1}{\PYGZsh{} Monitor network I/O}
iftop\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }eth0
nethogs

\PYG{c+c1}{\PYGZsh{} Check for packet loss}
mtr\PYG{+w}{ }storage\PYGZhy{}server
\end{sphinxVerbatim}


\subsection{Q: How do I set up automatic mounting for network drives?}
\label{\detokenize{faq:q-how-do-i-set-up-automatic-mounting-for-network-drives}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Configure persistent network mounts:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} For NFS shares}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}nfs\PYGZhy{}server:/path/to/share /mnt/nfs nfs defaults,\PYGZus{}netdev 0 0\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} For SMB/CIFS shares with credentials}
\PYG{c+c1}{\PYGZsh{} Create credentials file}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYGZti{}/.smbcredentials\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} EOF}
\PYG{l+s}{username=myuser}
\PYG{l+s}{password=mypassword}
\PYG{l+s}{domain=mydomain}
\PYG{l+s}{EOF}
chmod\PYG{+w}{ }\PYG{l+m}{600}\PYG{+w}{ }\PYGZti{}/.smbcredentials

\PYG{c+c1}{\PYGZsh{} Add to fstab}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}//server/share /mnt/smb cifs credentials=/home/user/.smbcredentials,uid=1000,gid=1000,\PYGZus{}netdev 0 0\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} Test automatic mounting}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}a
\end{sphinxVerbatim}


\section{Backup and Recovery}
\label{\detokenize{faq:backup-and-recovery}}

\subsection{Q: What’s the best backup strategy for Ubuntu?}
\label{\detokenize{faq:q-what-s-the-best-backup-strategy-for-ubuntu}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Implement the 3\sphinxhyphen{}2\sphinxhyphen{}1 backup rule:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} 3\PYGZhy{}2\PYGZhy{}1 Rule: 3 copies, 2 different media types, 1 offsite}

\PYG{c+c1}{\PYGZsh{} Local backup with rsync}
rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}delete\PYG{+w}{ }/home/user/\PYG{+w}{ }/backup/local/

\PYG{c+c1}{\PYGZsh{} External drive backup}
rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }\PYGZhy{}\PYGZhy{}delete\PYG{+w}{ }/home/user/\PYG{+w}{ }/media/external/backup/

\PYG{c+c1}{\PYGZsh{} Cloud backup with rclone}
rclone\PYG{+w}{ }sync\PYG{+w}{ }/home/user/\PYG{+w}{ }cloud:backup/

\PYG{c+c1}{\PYGZsh{} System backup script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/backup.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}
\PYG{l+s}{\PYGZsh{} Comprehensive backup script}

\PYG{l+s}{\PYGZsh{} Backup user data}
\PYG{l+s}{rsync \PYGZhy{}av /home/ /backup/home/}

\PYG{l+s}{\PYGZsh{} Backup system configuration}
\PYG{l+s}{tar \PYGZhy{}czf /backup/system\PYGZhy{}\PYGZdl{}(date +\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d).tar.gz /etc /var/lib/dpkg}

\PYG{l+s}{\PYGZsh{} Create disk image of root partition}
\PYG{l+s}{dd if=/dev/sda1 of=/backup/root\PYGZhy{}\PYGZdl{}(date +\PYGZpc{}Y\PYGZpc{}m\PYGZpc{}d).img bs=1M}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}


\subsection{Q: How do I restore from a backup?}
\label{\detokenize{faq:q-how-do-i-restore-from-a-backup}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Restoration process depends on backup type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Restore from rsync backup}
rsync\PYG{+w}{ }\PYGZhy{}av\PYG{+w}{ }/backup/home/\PYG{+w}{ }/home/

\PYG{c+c1}{\PYGZsh{} Restore from tar archive}
\PYG{n+nb}{cd}\PYG{+w}{ }/
sudo\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}xzf\PYG{+w}{ }/backup/system\PYGZhy{}20240101.tar.gz

\PYG{c+c1}{\PYGZsh{} Restore from disk image}
sudo\PYG{+w}{ }dd\PYG{+w}{ }\PYG{k}{if}\PYG{o}{=}/backup/root\PYGZhy{}20240101.img\PYG{+w}{ }\PYG{n+nv}{of}\PYG{o}{=}/dev/sda1\PYG{+w}{ }\PYG{n+nv}{bs}\PYG{o}{=}1M\PYG{+w}{ }\PYG{n+nv}{status}\PYG{o}{=}progress

\PYG{c+c1}{\PYGZsh{} Restore specific files}
sudo\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}xzf\PYG{+w}{ }/backup/system.tar.gz\PYG{+w}{ }\PYGZhy{}C\PYG{+w}{ }/\PYG{+w}{ }specific/file/path
\end{sphinxVerbatim}


\section{Troubleshooting}
\label{\detokenize{faq:troubleshooting}}

\subsection{Q: My system won’t boot after storage changes. How do I fix it?}
\label{\detokenize{faq:q-my-system-won-t-boot-after-storage-changes-how-do-i-fix-it}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Boot from Ubuntu live USB and repair:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Boot from Ubuntu live USB}

\PYG{c+c1}{\PYGZsh{} Mount root partition}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sda2\PYG{+w}{ }/mnt

\PYG{c+c1}{\PYGZsh{} Mount other partitions}
sudo\PYG{+w}{ }mount\PYG{+w}{ }/dev/sda1\PYG{+w}{ }/mnt/boot/efi\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} EFI partition}

\PYG{c+c1}{\PYGZsh{} Bind mount system directories}
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/dev\PYG{+w}{ }/mnt/dev
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/proc\PYG{+w}{ }/mnt/proc
sudo\PYG{+w}{ }mount\PYG{+w}{ }\PYGZhy{}\PYGZhy{}bind\PYG{+w}{ }/sys\PYG{+w}{ }/mnt/sys

\PYG{c+c1}{\PYGZsh{} Chroot into system}
sudo\PYG{+w}{ }chroot\PYG{+w}{ }/mnt

\PYG{c+c1}{\PYGZsh{} Repair GRUB}
grub\PYGZhy{}install\PYG{+w}{ }/dev/sda
update\PYGZhy{}grub

\PYG{c+c1}{\PYGZsh{} Fix fstab if needed}
nano\PYG{+w}{ }/etc/fstab

\PYG{c+c1}{\PYGZsh{} Exit and reboot}
\PYG{n+nb}{exit}
sudo\PYG{+w}{ }reboot
\end{sphinxVerbatim}


\subsection{Q: How do I diagnose storage performance issues?}
\label{\detokenize{faq:q-how-do-i-diagnose-storage-performance-issues}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Use these diagnostic tools:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Monitor I/O in real\PYGZhy{}time}
sudo\PYG{+w}{ }iotop\PYG{+w}{ }\PYGZhy{}o

\PYG{c+c1}{\PYGZsh{} Check I/O statistics}
iostat\PYG{+w}{ }\PYGZhy{}x\PYG{+w}{ }\PYG{l+m}{1}

\PYG{c+c1}{\PYGZsh{} Monitor disk usage}
watch\PYG{+w}{ }df\PYG{+w}{ }\PYGZhy{}h

\PYG{c+c1}{\PYGZsh{} Check for high I/O wait}
top\PYG{+w}{  }\PYG{c+c1}{\PYGZsh{} Look for high \PYGZpc{}wa (I/O wait)}

\PYG{c+c1}{\PYGZsh{} Test disk speed}
sudo\PYG{+w}{ }hdparm\PYG{+w}{ }\PYGZhy{}Tt\PYG{+w}{ }/dev/sda

\PYG{c+c1}{\PYGZsh{} Check for filesystem errors}
dmesg\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }grep\PYG{+w}{ }\PYGZhy{}i\PYG{+w}{ }error

\PYG{c+c1}{\PYGZsh{} Monitor SMART attributes}
sudo\PYG{+w}{ }smartctl\PYG{+w}{ }\PYGZhy{}A\PYG{+w}{ }/dev/sda
\end{sphinxVerbatim}


\subsection{Q: What should I do if I’m running out of disk space?}
\label{\detokenize{faq:q-what-should-i-do-if-i-m-running-out-of-disk-space}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Free up space systematically:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Find large files}
sudo\PYG{+w}{ }find\PYG{+w}{ }/\PYG{+w}{ }\PYGZhy{}type\PYG{+w}{ }f\PYG{+w}{ }\PYGZhy{}size\PYG{+w}{ }+100M\PYG{+w}{ }\PYGZhy{}exec\PYG{+w}{ }ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }\PYG{o}{\PYGZob{}}\PYG{o}{\PYGZcb{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}\PYGZbs{}}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m}{2}\PYGZgt{}/dev/null

\PYG{c+c1}{\PYGZsh{} Check directory sizes}
sudo\PYG{+w}{ }du\PYG{+w}{ }\PYGZhy{}h\PYG{+w}{ }\PYGZhy{}\PYGZhy{}max\PYGZhy{}depth\PYG{o}{=}\PYG{l+m}{1}\PYG{+w}{ }/\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sort\PYG{+w}{ }\PYGZhy{}hr

\PYG{c+c1}{\PYGZsh{} Clean package cache}
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoclean
sudo\PYG{+w}{ }apt\PYG{+w}{ }autoremove

\PYG{c+c1}{\PYGZsh{} Clean system logs}
sudo\PYG{+w}{ }journalctl\PYG{+w}{ }\PYGZhy{}\PYGZhy{}vacuum\PYGZhy{}time\PYG{o}{=}3d

\PYG{c+c1}{\PYGZsh{} Clean user caches}
rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYGZti{}/.cache/*
rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYGZti{}/.thumbnails/*

\PYG{c+c1}{\PYGZsh{} Find and remove duplicate files}
fdupes\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }/home/user\PYG{+w}{ }\PYGZhy{}d

\PYG{c+c1}{\PYGZsh{} Move large files to external storage}
mv\PYG{+w}{ }/home/user/large\PYGZus{}files/\PYG{+w}{ }/mnt/external/
\end{sphinxVerbatim}


\section{Performance Optimization}
\label{\detokenize{faq:performance-optimization}}

\subsection{Q: How can I optimize Ubuntu for SSD storage?}
\label{\detokenize{faq:q-how-can-i-optimize-ubuntu-for-ssd-storage}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Apply SSD\sphinxhyphen{}specific optimizations:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Enable TRIM}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }fstrim.timer

\PYG{c+c1}{\PYGZsh{} Set I/O scheduler to none}
\PYG{n+nb}{echo}\PYG{+w}{ }none\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }/sys/block/sda/queue/scheduler

\PYG{c+c1}{\PYGZsh{} Update fstab with SSD\PYGZhy{}optimized options}
\PYG{c+c1}{\PYGZsh{} Add noatime,discard to mount options}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/fstab
\PYG{c+c1}{\PYGZsh{} Example: UUID=xxx / ext4 defaults,noatime,discard 0 1}

\PYG{c+c1}{\PYGZsh{} Reduce swappiness}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}vm.swappiness=1\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/sysctl.conf

\PYG{c+c1}{\PYGZsh{} Move temporary files to RAM}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}tmpfs /tmp tmpfs defaults,noatime,mode=1777 0 0\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }tee\PYG{+w}{ }\PYGZhy{}a\PYG{+w}{ }/etc/fstab
\end{sphinxVerbatim}


\subsection{Q: How do I monitor storage health proactively?}
\label{\detokenize{faq:q-how-do-i-monitor-storage-health-proactively}}
\sphinxAtStartPar
\sphinxstylestrong{A:} Set up comprehensive monitoring:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install monitoring tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }smartmontools\PYG{+w}{ }sysstat

\PYG{c+c1}{\PYGZsh{} Enable SMART monitoring}
sudo\PYG{+w}{ }systemctl\PYG{+w}{ }\PYG{n+nb}{enable}\PYG{+w}{ }smartd

\PYG{c+c1}{\PYGZsh{} Configure email alerts}
sudo\PYG{+w}{ }nano\PYG{+w}{ }/etc/smartd.conf
\PYG{c+c1}{\PYGZsh{} Add: /dev/sda \PYGZhy{}a \PYGZhy{}o on \PYGZhy{}S on \PYGZhy{}s (S/../.././02|L/../../6/03) \PYGZhy{}m admin@example.com}

\PYG{c+c1}{\PYGZsh{} Create monitoring script}
cat\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/usr/local/bin/storage\PYGZus{}health.sh\PYG{+w}{ }\PYG{l+s}{\PYGZlt{}\PYGZlt{} \PYGZsq{}EOF\PYGZsq{}}
\PYG{l+s}{\PYGZsh{}!/bin/bash}

\PYG{l+s}{\PYGZsh{} Check disk usage}
\PYG{l+s}{df \PYGZhy{}h | awk \PYGZsq{}NR\PYGZgt{}1 \PYGZob{}if(\PYGZdl{}5+0 \PYGZgt{} 85) print \PYGZdl{}0\PYGZcb{}\PYGZsq{} | mail \PYGZhy{}s \PYGZdq{}Disk Usage Alert\PYGZdq{} admin@example.com}

\PYG{l+s}{\PYGZsh{} Check SMART status}
\PYG{l+s}{for disk in /dev/sd[a\PYGZhy{}z]; do}
\PYG{l+s}{    if [ \PYGZhy{}b \PYGZdq{}\PYGZdl{}disk\PYGZdq{} ]; then}
\PYG{l+s}{        if ! smartctl \PYGZhy{}H \PYGZdq{}\PYGZdl{}disk\PYGZdq{} | grep \PYGZhy{}q PASSED; then}
\PYG{l+s}{            echo \PYGZdq{}SMART failure on \PYGZdl{}disk\PYGZdq{} | mail \PYGZhy{}s \PYGZdq{}SMART Alert\PYGZdq{} admin@example.com}
\PYG{l+s}{        fi}
\PYG{l+s}{    fi}
\PYG{l+s}{done}
\PYG{l+s}{EOF}

chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/storage\PYGZus{}health.sh

\PYG{c+c1}{\PYGZsh{} Schedule regular checks}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}0 6 * * * /usr/local/bin/storage\PYGZus{}health.sh\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sudo\PYG{+w}{ }crontab\PYG{+w}{ }\PYGZhy{}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Downloads and Resources}
\label{\detokenize{downloads:downloads-and-resources}}\label{\detokenize{downloads::doc}}
\sphinxAtStartPar
This section provides information on how to generate and download the documentation in various formats, along with additional resources for storage management on Ubuntu 22.04.

\begin{sphinxcontents}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id1}}{\hyperref[\detokenize{downloads:documentation-formats}]{\sphinxcrossref{Documentation Formats}}} (\autopageref*{\detokenize{downloads:documentation-formats}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id2}}{\hyperref[\detokenize{downloads:building-the-documentation}]{\sphinxcrossref{Building the Documentation}}} (\autopageref*{\detokenize{downloads:building-the-documentation}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id3}}{\hyperref[\detokenize{downloads:download-instructions}]{\sphinxcrossref{Download Instructions}}} (\autopageref*{\detokenize{downloads:download-instructions}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id4}}{\hyperref[\detokenize{downloads:automation-scripts}]{\sphinxcrossref{Automation Scripts}}} (\autopageref*{\detokenize{downloads:automation-scripts}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id5}}{\hyperref[\detokenize{downloads:automated-build-script}]{\sphinxcrossref{Automated Build Script}}} (\autopageref*{\detokenize{downloads:automated-build-script}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id6}}{\hyperref[\detokenize{downloads:continuous-integration-script}]{\sphinxcrossref{Continuous Integration Script}}} (\autopageref*{\detokenize{downloads:continuous-integration-script}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id7}}{\hyperref[\detokenize{downloads:docker-build-environment}]{\sphinxcrossref{Docker Build Environment}}} (\autopageref*{\detokenize{downloads:docker-build-environment}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id8}}{\hyperref[\detokenize{downloads:additional-resources}]{\sphinxcrossref{Additional Resources}}} (\autopageref*{\detokenize{downloads:additional-resources}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id9}}{\hyperref[\detokenize{downloads:official-documentation-links}]{\sphinxcrossref{Official Documentation Links}}} (\autopageref*{\detokenize{downloads:official-documentation-links}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id10}}{\hyperref[\detokenize{downloads:useful-tools-and-utilities}]{\sphinxcrossref{Useful Tools and Utilities}}} (\autopageref*{\detokenize{downloads:useful-tools-and-utilities}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id11}}{\hyperref[\detokenize{downloads:scripts-and-templates}]{\sphinxcrossref{Scripts and Templates}}} (\autopageref*{\detokenize{downloads:scripts-and-templates}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id12}}{\hyperref[\detokenize{downloads:community-resources}]{\sphinxcrossref{Community Resources}}} (\autopageref*{\detokenize{downloads:community-resources}})

\end{itemize}

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id13}}{\hyperref[\detokenize{downloads:getting-help-and-support}]{\sphinxcrossref{Getting Help and Support}}} (\autopageref*{\detokenize{downloads:getting-help-and-support}})
\begin{itemize}
\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id14}}{\hyperref[\detokenize{downloads:issue-reporting}]{\sphinxcrossref{Issue Reporting}}} (\autopageref*{\detokenize{downloads:issue-reporting}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id15}}{\hyperref[\detokenize{downloads:contributing-to-documentation}]{\sphinxcrossref{Contributing to Documentation}}} (\autopageref*{\detokenize{downloads:contributing-to-documentation}})

\item {} 
\sphinxAtStartPar
\phantomsection\label{\detokenize{downloads:id16}}{\hyperref[\detokenize{downloads:contact-information}]{\sphinxcrossref{Contact Information}}} (\autopageref*{\detokenize{downloads:contact-information}})

\end{itemize}

\end{itemize}
\end{sphinxcontents}


\section{Documentation Formats}
\label{\detokenize{downloads:documentation-formats}}

\subsection{Building the Documentation}
\label{\detokenize{downloads:building-the-documentation}}
\sphinxAtStartPar
This documentation is built using Sphinx and can be generated in multiple formats. Follow these steps to build the documentation locally:

\sphinxAtStartPar
\sphinxstylestrong{Prerequisites:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Install Sphinx and required dependencies}
sudo\PYG{+w}{ }apt\PYG{+w}{ }update
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }python3\PYGZhy{}pip
pip3\PYG{+w}{ }install\PYG{+w}{ }sphinx\PYG{+w}{ }sphinx\PYGZhy{}rtd\PYGZhy{}theme

\PYG{c+c1}{\PYGZsh{} Install additional packages for PDF generation}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }texlive\PYGZhy{}latex\PYGZhy{}recommended\PYG{+w}{ }texlive\PYGZhy{}fonts\PYGZhy{}recommended\PYG{+w}{ }texlive\PYGZhy{}latex\PYGZhy{}extra

\PYG{c+c1}{\PYGZsh{} Install packages for EPUB generation}
pip3\PYG{+w}{ }install\PYG{+w}{ }sphinx\PYGZhy{}epub
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Building HTML Documentation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Navigate to the documentation directory}
\PYG{n+nb}{cd}\PYG{+w}{ }/path/to/sphinx/source

\PYG{c+c1}{\PYGZsh{} Build HTML documentation}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }html\PYG{+w}{ }.\PYG{+w}{ }\PYGZus{}build/html

\PYG{c+c1}{\PYGZsh{} Open in browser}
firefox\PYG{+w}{ }\PYGZus{}build/html/index.html
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Building PDF Documentation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Build LaTeX files first}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }latex\PYG{+w}{ }.\PYG{+w}{ }\PYGZus{}build/latex

\PYG{c+c1}{\PYGZsh{} Generate PDF from LaTeX}
\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZus{}build/latex
make

\PYG{c+c1}{\PYGZsh{} The PDF will be available as storage\PYGZhy{}guide.pdf}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Building EPUB Documentation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Build EPUB format}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }epub\PYG{+w}{ }.\PYG{+w}{ }\PYGZus{}build/epub

\PYG{c+c1}{\PYGZsh{} The EPUB file will be in \PYGZus{}build/epub/}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Building All Formats:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} build\PYGZhy{}docs.sh \PYGZhy{} Complete documentation build script}

\PYG{n+nb}{set}\PYG{+w}{ }\PYGZhy{}e

\PYG{n+nv}{SOURCE\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}.\PYGZdq{}}
\PYG{n+nv}{BUILD\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}\PYGZus{}build\PYGZdq{}}
\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZdq{}}

\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building Ubuntu 22.04 Storage Documentation...\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Clean previous builds}
rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Build HTML}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building HTML documentation...\PYGZdq{}}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }html\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/html}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Build PDF}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building PDF documentation...\PYGZdq{}}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }latex\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/latex}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/latex}\PYG{l+s+s2}{\PYGZdq{}}
make
cp\PYG{+w}{ }*.pdf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{../}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.pdf}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null

\PYG{c+c1}{\PYGZsh{} Build EPUB}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building EPUB documentation...\PYGZdq{}}
sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }epub\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/epub}\PYG{l+s+s2}{\PYGZdq{}}
cp\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/epub/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.epub}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} Create downloadable archive}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Creating download archive...\PYGZdq{}}
\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZhy{}docs.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }html/\PYG{+w}{ }*.pdf\PYG{+w}{ }*.epub
\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null

\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Documentation build complete!\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Available formats:\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  HTML: }\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/html/index.html}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  PDF:  }\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.pdf}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  EPUB: }\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.epub}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{  Archive: }\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PROJECT\PYGZus{}NAME}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZhy{}docs.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\subsection{Download Instructions}
\label{\detokenize{downloads:download-instructions}}
\sphinxAtStartPar
\sphinxstylestrong{📥 Available Download Formats:}



\sphinxAtStartPar
\sphinxstylestrong{For End Users:}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{📄 PDF Version:}
\sphinxhyphen{} Complete documentation in a single PDF file
\sphinxhyphen{} Best for offline reading and printing
\sphinxhyphen{} Preserves formatting and includes bookmarks
\sphinxhyphen{} Professional layout with headers and page numbers

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{📱 EPUB Version:}
\sphinxhyphen{} E\sphinxhyphen{}book format compatible with most e\sphinxhyphen{}readers
\sphinxhyphen{} Best for mobile devices and e\sphinxhyphen{}reader applications
\sphinxhyphen{} Supports reflowable text and adjustable font sizes
\sphinxhyphen{} Works with Kindle, Apple Books, Adobe Digital Editions

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{🌐 HTML Version:}
\sphinxhyphen{} Complete website version with navigation and search
\sphinxhyphen{} Best for online reading and reference
\sphinxhyphen{} Includes interactive elements and cross\sphinxhyphen{}references
\sphinxhyphen{} Available as single file or complete website archive

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{📝 Text Version:}
\sphinxhyphen{} Plain text format for maximum compatibility
\sphinxhyphen{} Accessible for screen readers and text processing
\sphinxhyphen{} Lightweight and universally readable

\end{enumerate}

\sphinxAtStartPar
\sphinxstylestrong{Quick Download Commands:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Download specific formats using wget or curl}

\PYG{c+c1}{\PYGZsh{} PDF version}
wget\PYG{+w}{ }/downloads/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide.pdf

\PYG{c+c1}{\PYGZsh{} EPUB version}
wget\PYG{+w}{ }/downloads/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide.epub

\PYG{c+c1}{\PYGZsh{} Complete archive with all formats}
wget\PYG{+w}{ }/downloads/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}All\PYGZhy{}Formats.zip

\PYG{c+c1}{\PYGZsh{} Extract complete archive}
unzip\PYG{+w}{ }Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}All\PYGZhy{}Formats.zip
\end{sphinxVerbatim}


\section{Automation Scripts}
\label{\detokenize{downloads:automation-scripts}}

\subsection{Automated Build Script}
\label{\detokenize{downloads:automated-build-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+ch}{\PYGZsh{}!/bin/bash}
\PYG{c+c1}{\PYGZsh{} auto\PYGZhy{}build\PYGZhy{}docs.sh \PYGZhy{} Automated documentation builder with CI/CD integration}

\PYG{n+nb}{set}\PYG{+w}{ }\PYGZhy{}euo\PYG{+w}{ }pipefail

\PYG{c+c1}{\PYGZsh{} Configuration}
\PYG{n+nv}{PROJECT\PYGZus{}ROOT}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{\PYGZdl{}(}dirname\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BASH\PYGZus{}SOURCE}\PYG{p}{[0]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{SOURCE\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}PROJECT\PYGZus{}ROOT}\PYG{l+s+s2}{/source}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{BUILD\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}PROJECT\PYGZus{}ROOT}\PYG{l+s+s2}{/\PYGZus{}build}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{OUTPUT\PYGZus{}DIR}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}PROJECT\PYGZus{}ROOT}\PYG{l+s+s2}{/dist}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nv}{VERSION}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}date\PYG{+w}{ }+\PYGZpc{}Y.\PYGZpc{}m.\PYGZpc{}d\PYG{k}{)}

\PYG{c+c1}{\PYGZsh{} Colors for output}
\PYG{n+nv}{RED}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;31m\PYGZsq{}}
\PYG{n+nv}{GREEN}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0;32m\PYGZsq{}}
\PYG{n+nv}{YELLOW}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[1;33m\PYGZsq{}}
\PYG{n+nv}{NC}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}\PYGZbs{}033[0m\PYGZsq{}}\PYG{+w}{ }\PYG{c+c1}{\PYGZsh{} No Color}

log\PYGZus{}info\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{GREEN}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{[INFO]}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

log\PYGZus{}warn\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{YELLOW}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{[WARN]}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

log\PYGZus{}error\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{RED}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{[ERROR]}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{NC}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ }\PYG{n+nv}{\PYGZdl{}1}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

check\PYGZus{}dependencies\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Checking dependencies...\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{missing\PYGZus{}deps}\PYG{o}{=}\PYG{o}{(}\PYG{o}{)}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }sphinx\PYGZhy{}build\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nv}{missing\PYGZus{}deps}\PYG{o}{+=}\PYG{o}{(}\PYG{l+s+s2}{\PYGZdq{}sphinx\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }!\PYG{+w}{ }\PYG{n+nb}{command}\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }pdflatex\PYG{+w}{ }\PYG{p}{\PYGZam{}}\PYGZgt{}\PYG{+w}{ }/dev/null\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nv}{missing\PYGZus{}deps}\PYG{o}{+=}\PYG{o}{(}\PYG{l+s+s2}{\PYGZdq{}texlive\PYGZhy{}latex\PYGZhy{}recommended\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}\PYGZsh{}}\PYG{n+nv}{missing\PYGZus{}deps}\PYG{p}{[@]}\PYG{l+s+si}{\PYGZcb{}}\PYG{+w}{ }\PYGZhy{}ne\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}error\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Missing dependencies: }\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{missing\PYGZus{}deps}\PYG{p}{[*]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Install with: sudo apt install python3\PYGZhy{}sphinx texlive\PYGZhy{}latex\PYGZhy{}recommended\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}

\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}All dependencies satisfied\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

clean\PYGZus{}build\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Cleaning previous builds...\PYGZdq{}}
\PYG{+w}{    }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

build\PYGZus{}html\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building HTML documentation...\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }html\PYG{+w}{ }\PYGZhy{}W\PYG{+w}{ }\PYGZhy{}\PYGZhy{}keep\PYGZhy{}going\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/html}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}HTML build successful\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}error\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}HTML build failed\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

build\PYGZus{}pdf\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building PDF documentation...\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Build LaTeX first}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }latex\PYG{+w}{ }\PYGZhy{}W\PYG{+w}{ }\PYGZhy{}\PYGZhy{}keep\PYGZhy{}going\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/latex}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/latex}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }make\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{            }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}PDF build successful\PYGZdq{}}
\PYG{+w}{            }cp\PYG{+w}{ }*.pdf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{VERSION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.pdf}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{        }\PYG{k}{else}
\PYG{+w}{            }log\PYGZus{}error\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}PDF compilation failed\PYGZdq{}}
\PYG{+w}{            }\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null
\PYG{+w}{            }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{        }\PYG{k}{fi}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}error\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}LaTeX build failed\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

build\PYGZus{}epub\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Building EPUB documentation...\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }epub\PYG{+w}{ }\PYGZhy{}W\PYG{+w}{ }\PYGZhy{}\PYGZhy{}keep\PYGZhy{}going\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}SOURCE\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/epub}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }cp\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{/epub}\PYG{l+s+s2}{\PYGZdq{}}/*.epub\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{VERSION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.epub}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}EPUB build successful\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{0}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}error\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}EPUB build failed\PYGZdq{}}
\PYG{+w}{        }\PYG{k}{return}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

create\PYGZus{}archives\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Creating distribution archives...\PYGZdq{}}

\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create HTML archive}
\PYG{+w}{    }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}HTML\PYGZhy{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{VERSION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }html/

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Create complete archive}
\PYG{+w}{    }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{/Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide\PYGZhy{}Complete\PYGZhy{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{VERSION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.tar.gz}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{        }html/\PYG{+w}{ }latex/\PYG{+w}{ }epub/

\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null

\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Archives created successfully\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

generate\PYGZus{}checksums\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Generating checksums...\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }sha256sum\PYG{+w}{ }*\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{checksums\PYGZhy{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{VERSION}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{.sha256}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{cd}\PYG{+w}{ }\PYGZhy{}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }/dev/null
\PYG{o}{\PYGZcb{}}

show\PYGZus{}summary\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Build Summary:\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}======================================\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Version: }\PYG{n+nv}{\PYGZdl{}VERSION}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Build Directory: }\PYG{n+nv}{\PYGZdl{}BUILD\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Output Directory: }\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Generated Files:\PYGZdq{}}
\PYG{+w}{    }ls\PYG{+w}{ }\PYGZhy{}lh\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{    }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Total Size: }\PYG{k}{\PYGZdl{}(}du\PYG{+w}{ }\PYGZhy{}sh\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}OUTPUT\PYGZus{}DIR}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }cut\PYG{+w}{ }\PYGZhy{}f1\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Main execution}
main\PYG{o}{(}\PYG{o}{)}\PYG{+w}{ }\PYG{o}{\PYGZob{}}
\PYG{+w}{    }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Starting automated documentation build (Version: }\PYG{n+nv}{\PYGZdl{}VERSION}\PYG{l+s+s2}{)}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{+w}{    }check\PYGZus{}dependencies
\PYG{+w}{    }clean\PYGZus{}build

\PYG{+w}{    }\PYG{n+nb}{local}\PYG{+w}{ }\PYG{n+nv}{build\PYGZus{}errors}\PYG{o}{=}\PYG{l+m}{0}

\PYG{+w}{    }\PYG{c+c1}{\PYGZsh{} Build all formats}
\PYG{+w}{    }build\PYGZus{}html\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{(}\PYG{o}{(}build\PYGZus{}errors++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{    }build\PYGZus{}pdf\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{(}\PYG{o}{(}build\PYGZus{}errors++\PYG{o}{)}\PYG{o}{)}
\PYG{+w}{    }build\PYGZus{}epub\PYG{+w}{ }\PYG{o}{||}\PYG{+w}{ }\PYG{o}{(}\PYG{o}{(}build\PYGZus{}errors++\PYG{o}{)}\PYG{o}{)}

\PYG{+w}{    }\PYG{k}{if}\PYG{+w}{ }\PYG{o}{[}\PYG{+w}{ }\PYG{n+nv}{\PYGZdl{}build\PYGZus{}errors}\PYG{+w}{ }\PYGZhy{}eq\PYG{+w}{ }\PYG{l+m}{0}\PYG{+w}{ }\PYG{o}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{then}
\PYG{+w}{        }create\PYGZus{}archives
\PYG{+w}{        }generate\PYGZus{}checksums
\PYG{+w}{        }show\PYGZus{}summary
\PYG{+w}{        }log\PYGZus{}info\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}All builds completed successfully!\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{else}
\PYG{+w}{        }log\PYGZus{}warn\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}build\PYGZus{}errors}\PYG{l+s+s2}{ build(s) failed, but continuing with available outputs}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{    }\PYG{k}{fi}
\PYG{o}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Handle command line arguments}
\PYG{k}{case}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{1}\PYG{k}{:\PYGZhy{}}\PYG{n+nv}{all}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{+w}{ }\PYG{k}{in}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}html\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}dependencies
\PYG{+w}{        }clean\PYGZus{}build
\PYG{+w}{        }build\PYGZus{}html
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}pdf\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}dependencies
\PYG{+w}{        }clean\PYGZus{}build
\PYG{+w}{        }build\PYGZus{}pdf
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}epub\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }check\PYGZus{}dependencies
\PYG{+w}{        }clean\PYGZus{}build
\PYG{+w}{        }build\PYGZus{}epub
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }\PYG{l+s+s2}{\PYGZdq{}all\PYGZdq{}}\PYG{p}{|}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}\PYG{o}{)}
\PYG{+w}{        }main
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{+w}{    }*\PYG{o}{)}
\PYG{+w}{        }\PYG{n+nb}{echo}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Usage: }\PYG{n+nv}{\PYGZdl{}0}\PYG{l+s+s2}{ [html|pdf|epub|all]}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{+w}{        }\PYG{n+nb}{exit}\PYG{+w}{ }\PYG{l+m}{1}
\PYG{+w}{        }\PYG{p}{;}\PYG{p}{;}
\PYG{k}{esac}
\end{sphinxVerbatim}


\subsection{Continuous Integration Script}
\label{\detokenize{downloads:continuous-integration-script}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} .github/workflows/build\PYGZhy{}docs.yml \PYGZhy{} GitHub Actions workflow}
\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Build}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{Documentation}

\PYG{n+nt}{on}\PYG{p}{:}
\PYG{+w}{  }\PYG{n+nt}{push}\PYG{p}{:}
\PYG{+w}{    }\PYG{n+nt}{branches}\PYG{p}{:}\PYG{+w}{ }\PYG{p+pIndicator}{[}\PYG{+w}{ }\PYG{n+nv}{main}\PYG{p+pIndicator}{,}\PYG{+w}{ }\PYG{n+nv}{develop}\PYG{+w}{ }\PYG{p+pIndicator}{]}
\PYG{+w}{  }\PYG{n+nt}{pull\PYGZus{}request}\PYG{p}{:}
\PYG{+w}{    }\PYG{n+nt}{branches}\PYG{p}{:}\PYG{+w}{ }\PYG{p+pIndicator}{[}\PYG{+w}{ }\PYG{n+nv}{main}\PYG{+w}{ }\PYG{p+pIndicator}{]}

\PYG{n+nt}{jobs}\PYG{p}{:}
\PYG{+w}{  }\PYG{n+nt}{build}\PYG{p}{:}
\PYG{+w}{    }\PYG{n+nt}{runs\PYGZhy{}on}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{ubuntu\PYGZhy{}22.04}

\PYG{+w}{    }\PYG{n+nt}{steps}\PYG{p}{:}
\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{uses}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{actions/checkout@v3}

\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Set}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{up}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{Python}
\PYG{+w}{      }\PYG{n+nt}{uses}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{actions/setup\PYGZhy{}python@v4}
\PYG{+w}{      }\PYG{n+nt}{with}\PYG{p}{:}
\PYG{+w}{        }\PYG{n+nt}{python\PYGZhy{}version}\PYG{p}{:}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.10}\PYG{l+s}{\PYGZsq{}}

\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Install}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{dependencies}
\PYG{+w}{      }\PYG{n+nt}{run}\PYG{p}{:}\PYG{+w}{ }\PYG{p+pIndicator}{|}
\PYG{+w}{        }\PYG{n+no}{sudo apt\PYGZhy{}get update}
\PYG{+w}{        }\PYG{n+no}{sudo apt\PYGZhy{}get install \PYGZhy{}y texlive\PYGZhy{}latex\PYGZhy{}recommended texlive\PYGZhy{}fonts\PYGZhy{}recommended texlive\PYGZhy{}latex\PYGZhy{}extra}
\PYG{+w}{        }\PYG{n+no}{pip install sphinx sphinx\PYGZhy{}rtd\PYGZhy{}theme}

\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Build}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{documentation}
\PYG{+w}{      }\PYG{n+nt}{run}\PYG{p}{:}\PYG{+w}{ }\PYG{p+pIndicator}{|}
\PYG{+w}{        }\PYG{n+no}{chmod +x auto\PYGZhy{}build\PYGZhy{}docs.sh}
\PYG{+w}{        }\PYG{n+no}{./auto\PYGZhy{}build\PYGZhy{}docs.sh}

\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Upload}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{artifacts}
\PYG{+w}{      }\PYG{n+nt}{uses}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{actions/upload\PYGZhy{}artifact@v3}
\PYG{+w}{      }\PYG{n+nt}{with}\PYG{p}{:}
\PYG{+w}{        }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{documentation}
\PYG{+w}{        }\PYG{n+nt}{path}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{dist/}

\PYG{+w}{    }\PYG{p+pIndicator}{\PYGZhy{}}\PYG{+w}{ }\PYG{n+nt}{name}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{Deploy}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{to}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{GitHub}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{Pages}
\PYG{+w}{      }\PYG{n+nt}{if}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{github.ref}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{==}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{\PYGZsq{}refs/heads/main\PYGZsq{}}
\PYG{+w}{      }\PYG{n+nt}{uses}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{peaceiris/actions\PYGZhy{}gh\PYGZhy{}pages@v3}
\PYG{+w}{      }\PYG{n+nt}{with}\PYG{p}{:}
\PYG{+w}{        }\PYG{n+nt}{github\PYGZus{}token}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{\PYGZdl{}\PYGZob{}\PYGZob{}}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{secrets.GITHUB\PYGZus{}TOKEN}\PYG{l+lScalar+lScalarPlain}{ }\PYG{l+lScalar+lScalarPlain}{\PYGZcb{}\PYGZcb{}}
\PYG{+w}{        }\PYG{n+nt}{publish\PYGZus{}dir}\PYG{p}{:}\PYG{+w}{ }\PYG{l+lScalar+lScalarPlain}{\PYGZus{}build/html}
\end{sphinxVerbatim}


\subsection{Docker Build Environment}
\label{\detokenize{downloads:docker-build-environment}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZsh{} Dockerfile for documentation building}
\PYG{k}{FROM}\PYG{+w}{ }\PYG{l+s}{ubuntu:22.04}

\PYG{k}{ENV}\PYG{+w}{ }\PYG{n+nv}{DEBIAN\PYGZus{}FRONTEND}\PYG{o}{=}noninteractive

\PYG{c}{\PYGZsh{} Install dependencies}
\PYG{k}{RUN}\PYG{+w}{ }apt\PYGZhy{}get\PYG{+w}{ }update\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }apt\PYGZhy{}get\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }python3\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }python3\PYGZhy{}pip\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }texlive\PYGZhy{}latex\PYGZhy{}recommended\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }texlive\PYGZhy{}fonts\PYGZhy{}recommended\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }texlive\PYGZhy{}latex\PYGZhy{}extra\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }make\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }/var/lib/apt/lists/*

\PYG{c}{\PYGZsh{} Install Python packages}
\PYG{k}{RUN}\PYG{+w}{ }pip3\PYG{+w}{ }install\PYG{+w}{ }sphinx\PYG{+w}{ }sphinx\PYGZhy{}rtd\PYGZhy{}theme

\PYG{c}{\PYGZsh{} Set working directory}
\PYG{k}{WORKDIR}\PYG{+w}{ }\PYG{l+s}{/docs}

\PYG{c}{\PYGZsh{} Copy build script}
\PYG{k}{COPY}\PYG{+w}{ }auto\PYGZhy{}build\PYGZhy{}docs.sh\PYG{+w}{ }/usr/local/bin/
\PYG{k}{RUN}\PYG{+w}{ }chmod\PYG{+w}{ }+x\PYG{+w}{ }/usr/local/bin/auto\PYGZhy{}build\PYGZhy{}docs.sh

\PYG{c}{\PYGZsh{} Default command}
\PYG{k}{CMD}\PYG{+w}{ }\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}/usr/local/bin/auto\PYGZhy{}build\PYGZhy{}docs.sh\PYGZdq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Docker build and run commands}

\PYG{c+c1}{\PYGZsh{} Build the Docker image}
docker\PYG{+w}{ }build\PYG{+w}{ }\PYGZhy{}t\PYG{+w}{ }storage\PYGZhy{}docs\PYGZhy{}builder\PYG{+w}{ }.

\PYG{c+c1}{\PYGZsh{} Run documentation build}
docker\PYG{+w}{ }run\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}:/docs\PYG{+w}{ }storage\PYGZhy{}docs\PYGZhy{}builder

\PYG{c+c1}{\PYGZsh{} Extract built documentation}
docker\PYG{+w}{ }run\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}:/docs\PYG{+w}{ }\PYGZhy{}v\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}/output:/output\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }storage\PYGZhy{}docs\PYGZhy{}builder\PYG{+w}{ }cp\PYG{+w}{ }\PYGZhy{}r\PYG{+w}{ }/docs/dist/*\PYG{+w}{ }/output/
\end{sphinxVerbatim}


\section{Additional Resources}
\label{\detokenize{downloads:additional-resources}}

\subsection{Official Documentation Links}
\label{\detokenize{downloads:official-documentation-links}}
\sphinxAtStartPar
\sphinxstylestrong{Ubuntu Documentation:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://ubuntu.com/server/docs}{Ubuntu Server Guide}%
\begin{footnote}[1]\sphinxAtStartFootnote
\sphinxnolinkurl{https://ubuntu.com/server/docs}
%
\end{footnote} \sphinxhyphen{} Official Ubuntu Server documentation

\item {} 
\sphinxAtStartPar
\sphinxhref{https://help.ubuntu.com/community/LinuxFilesystemsExplained}{Ubuntu Storage Guide}%
\begin{footnote}[2]\sphinxAtStartFootnote
\sphinxnolinkurl{https://help.ubuntu.com/community/LinuxFilesystemsExplained}
%
\end{footnote} \sphinxhyphen{} Community filesystem documentation

\item {} 
\sphinxAtStartPar
\sphinxhref{https://help.ubuntu.com/community/LVM}{Ubuntu LVM Guide}%
\begin{footnote}[3]\sphinxAtStartFootnote
\sphinxnolinkurl{https://help.ubuntu.com/community/LVM}
%
\end{footnote} \sphinxhyphen{} Logical Volume Management

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Filesystem Documentation:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.kernel.org/doc/Documentation/filesystems/ext4.txt}{Ext4 Documentation}%
\begin{footnote}[4]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.kernel.org/doc/Documentation/filesystems/ext4.txt}
%
\end{footnote} \sphinxhyphen{} Kernel documentation for ext4

\item {} 
\sphinxAtStartPar
\sphinxhref{https://xfs.wiki.kernel.org/}{XFS Documentation}%
\begin{footnote}[5]\sphinxAtStartFootnote
\sphinxnolinkurl{https://xfs.wiki.kernel.org/}
%
\end{footnote} \sphinxhyphen{} XFS filesystem wiki

\item {} 
\sphinxAtStartPar
\sphinxhref{https://btrfs.wiki.kernel.org/}{Btrfs Documentation}%
\begin{footnote}[6]\sphinxAtStartFootnote
\sphinxnolinkurl{https://btrfs.wiki.kernel.org/}
%
\end{footnote} \sphinxhyphen{} Btrfs filesystem wiki

\item {} 
\sphinxAtStartPar
\sphinxhref{https://openzfs.github.io/openzfs-docs/}{ZFS on Linux}%
\begin{footnote}[7]\sphinxAtStartFootnote
\sphinxnolinkurl{https://openzfs.github.io/openzfs-docs/}
%
\end{footnote} \sphinxhyphen{} OpenZFS documentation

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{RAID and Storage:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://raid.wiki.kernel.org/}{Linux RAID Wiki}%
\begin{footnote}[8]\sphinxAtStartFootnote
\sphinxnolinkurl{https://raid.wiki.kernel.org/}
%
\end{footnote} \sphinxhyphen{} Comprehensive RAID documentation

\item {} 
\sphinxAtStartPar
\sphinxhref{https://tldp.org/HOWTO/LVM-HOWTO/}{LVM HOWTO}%
\begin{footnote}[9]\sphinxAtStartFootnote
\sphinxnolinkurl{https://tldp.org/HOWTO/LVM-HOWTO/}
%
\end{footnote} \sphinxhyphen{} Linux Documentation Project LVM guide

\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.kernel.org/doc/Documentation/block/}{Storage Performance}%
\begin{footnote}[10]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.kernel.org/doc/Documentation/block/}
%
\end{footnote} \sphinxhyphen{} Kernel block layer documentation

\end{itemize}


\subsection{Useful Tools and Utilities}
\label{\detokenize{downloads:useful-tools-and-utilities}}
\sphinxAtStartPar
\sphinxstylestrong{System Information:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Essential storage tools installation}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }lvm2\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }mdadm\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }smartmontools\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }parted\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }gparted\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }hdparm\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }iotop\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }sysstat\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }tree\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }ncdu\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }htop
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Monitoring Tools:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Advanced monitoring tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }nagios\PYGZhy{}plugins\PYGZhy{}basic\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }zabbix\PYGZhy{}agent\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }collectd\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }grafana\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }prometheus\PYGZhy{}node\PYGZhy{}exporter
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Backup Tools:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Backup and recovery tools}
sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }rsync\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }rdiff\PYGZhy{}backup\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }duplicity\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }borgbackup\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }testdisk\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }photorec\PYG{+w}{ }\PYG{l+s+se}{\PYGZbs{}}
\PYG{+w}{    }ddrescue
\end{sphinxVerbatim}


\subsection{Scripts and Templates}
\label{\detokenize{downloads:scripts-and-templates}}
\sphinxAtStartPar
\sphinxstylestrong{Makefile for Documentation:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZsh{} Makefile for Ubuntu Storage Documentation}

\PYG{n+nv}{SOURCEDIR}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n+nb}{source}
\PYG{n+nv}{BUILDDIR}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYGZus{}build
\PYG{n+nv}{OUTPUTDIR}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }dist
\PYG{n+nv}{VERSION}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}shell\PYG{+w}{ }date\PYG{+w}{ }+\PYGZpc{}Y.\PYGZpc{}m.\PYGZpc{}d\PYG{k}{)}
\PYG{n+nv}{PROJECT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }Ubuntu\PYGZhy{}Storage\PYGZhy{}Guide

\PYG{n+nf}{.PHONY}\PYG{o}{:}\PYG{+w}{ }\PYG{n}{help} \PYG{n}{clean} \PYG{n}{html} \PYG{n}{pdf} \PYG{n}{epub} \PYG{n}{all} \PYG{n}{archive}

\PYG{n+nf}{help}\PYG{o}{:}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Ubuntu Storage Documentation Build System\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Available targets:\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  html     Build HTML documentation\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  pdf      Build PDF documentation\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  epub     Build EPUB documentation\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  all      Build all formats\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  archive  Create distribution archives\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  clean    Remove build artifacts\PYGZdq{}}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}  install  Install dependencies\PYGZdq{}}

\PYG{n+nf}{clean}\PYG{o}{:}
\PYG{+w}{     }rm\PYG{+w}{ }\PYGZhy{}rf\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Build artifacts cleaned\PYGZdq{}}

\PYG{n+nf}{install}\PYG{o}{:}
\PYG{+w}{     }sudo\PYG{+w}{ }apt\PYG{+w}{ }update
\PYG{+w}{     }sudo\PYG{+w}{ }apt\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}y\PYG{+w}{ }python3\PYGZhy{}sphinx\PYG{+w}{ }texlive\PYGZhy{}latex\PYGZhy{}recommended
\PYG{+w}{     }pip3\PYG{+w}{ }install\PYG{+w}{ }sphinx\PYGZhy{}rtd\PYGZhy{}theme
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Dependencies installed\PYGZdq{}}

\PYG{n+nf}{html}\PYG{o}{:}
\PYG{+w}{     }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}
\PYG{+w}{     }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }html\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}SOURCEDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/html
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HTML documentation built in }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}\PYG{l+s+s2}{/html}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nf}{pdf}\PYG{o}{:}
\PYG{+w}{     }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}
\PYG{+w}{     }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }latex\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}SOURCEDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/latex
\PYG{+w}{     }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/latex\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }make
\PYG{+w}{     }cp\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/latex/*.pdf\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}/\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYGZhy{}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}.pdf
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PDF documentation built: }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}\PYG{l+s+s2}{/}\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYG{l+s+s2}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}\PYG{l+s+s2}{.pdf}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nf}{epub}\PYG{o}{:}
\PYG{+w}{     }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}
\PYG{+w}{     }sphinx\PYGZhy{}build\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }epub\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}SOURCEDIR\PYG{k}{)}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/epub
\PYG{+w}{     }cp\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}/epub/*.epub\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}/\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYGZhy{}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}.epub
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{EPUB documentation built: }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}\PYG{l+s+s2}{/}\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYG{l+s+s2}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}\PYG{l+s+s2}{.epub}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nf}{all}\PYG{o}{:}\PYG{+w}{ }\PYG{n}{html} \PYG{n}{pdf} \PYG{n}{epub}
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}All documentation formats built successfully\PYGZdq{}}

\PYG{n+nf}{archive}\PYG{o}{:}\PYG{+w}{ }\PYG{n}{all}
\PYG{+w}{     }mkdir\PYG{+w}{ }\PYGZhy{}p\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}
\PYG{+w}{     }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}BUILDDIR\PYG{k}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }../\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}/\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYGZhy{}HTML\PYGZhy{}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}.tar.gz\PYG{+w}{ }html/
\PYG{+w}{     }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }tar\PYG{+w}{ }\PYGZhy{}czf\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}PROJECT\PYG{k}{)}\PYGZhy{}Complete\PYGZhy{}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}.tar.gz\PYG{+w}{ }*.pdf\PYG{+w}{ }*.epub\PYG{+w}{ }*.tar.gz
\PYG{+w}{     }\PYG{n+nb}{cd}\PYG{+w}{ }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }sha256sum\PYG{+w}{ }*\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }checksums\PYGZhy{}\PYG{k}{\PYGZdl{}(}VERSION\PYG{k}{)}.sha256
\PYG{+w}{     }@echo\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Distribution archives created in }\PYG{k}{\PYGZdl{}(}OUTPUTDIR\PYG{k}{)}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}


\subsection{Community Resources}
\label{\detokenize{downloads:community-resources}}
\sphinxAtStartPar
\sphinxstylestrong{Forums and Communities:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://ubuntuforums.org/forumdisplay.php?f=35}{Ubuntu Forums \sphinxhyphen{} Storage Section}%
\begin{footnote}[11]\sphinxAtStartFootnote
\sphinxnolinkurl{https://ubuntuforums.org/forumdisplay.php?f=35}
%
\end{footnote}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://askubuntu.com/questions/tagged/storage}{Ask Ubuntu \sphinxhyphen{} Storage Questions}%
\begin{footnote}[12]\sphinxAtStartFootnote
\sphinxnolinkurl{https://askubuntu.com/questions/tagged/storage}
%
\end{footnote}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://reddit.com/r/Ubuntu}{Reddit r/Ubuntu}%
\begin{footnote}[13]\sphinxAtStartFootnote
\sphinxnolinkurl{https://reddit.com/r/Ubuntu}
%
\end{footnote}

\item {} 
\sphinxAtStartPar
\sphinxhref{https://discourse.ubuntu.com/}{Ubuntu Discourse}%
\begin{footnote}[14]\sphinxAtStartFootnote
\sphinxnolinkurl{https://discourse.ubuntu.com/}
%
\end{footnote}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Professional Resources:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.lpi.org/}{Linux Professional Institute (LPI)}%
\begin{footnote}[15]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.lpi.org/}
%
\end{footnote} \sphinxhyphen{} Linux certification

\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.redhat.com/en/services/training}{Red Hat Training}%
\begin{footnote}[16]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.redhat.com/en/services/training}
%
\end{footnote} \sphinxhyphen{} Enterprise Linux training

\item {} 
\sphinxAtStartPar
\sphinxhref{https://www.suse.com/training/}{SUSE Training}%
\begin{footnote}[17]\sphinxAtStartFootnote
\sphinxnolinkurl{https://www.suse.com/training/}
%
\end{footnote} \sphinxhyphen{} SUSE Linux Enterprise training

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Books and Publications:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
“Linux System Administration” by Tom Adelstein

\item {} 
\sphinxAtStartPar
“UNIX and Linux System Administration Handbook” by Evi Nemeth

\item {} 
\sphinxAtStartPar
“Linux Storage Best Practices” by various authors

\item {} 
\sphinxAtStartPar
“ZFS Administration Guide” by Oracle

\end{itemize}


\section{Getting Help and Support}
\label{\detokenize{downloads:getting-help-and-support}}

\subsection{Issue Reporting}
\label{\detokenize{downloads:issue-reporting}}
\sphinxAtStartPar
If you find errors in this documentation or have suggestions for improvement:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Documentation Issues:}
\sphinxhyphen{} Create an issue on the project repository
\sphinxhyphen{} Include specific page/section references
\sphinxhyphen{} Provide detailed description of the problem

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Technical Issues:}
\sphinxhyphen{} Check the troubleshooting section first
\sphinxhyphen{} Search existing forums and documentation
\sphinxhyphen{} Provide system information and error messages

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Feature Requests:}
\sphinxhyphen{} Suggest new topics or sections
\sphinxhyphen{} Provide use cases and justification
\sphinxhyphen{} Consider contributing content yourself

\end{enumerate}


\subsection{Contributing to Documentation}
\label{\detokenize{downloads:contributing-to-documentation}}
\sphinxAtStartPar
This documentation is open source and welcomes contributions:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Fork the repository}
git\PYG{+w}{ }clone\PYG{+w}{ }https://github.com/username/ubuntu\PYGZhy{}storage\PYGZhy{}docs.git
\PYG{n+nb}{cd}\PYG{+w}{ }ubuntu\PYGZhy{}storage\PYGZhy{}docs

\PYG{c+c1}{\PYGZsh{} Create a new branch}
git\PYG{+w}{ }checkout\PYG{+w}{ }\PYGZhy{}b\PYG{+w}{ }feature/new\PYGZhy{}content

\PYG{c+c1}{\PYGZsh{} Make your changes}
\PYG{c+c1}{\PYGZsh{} Edit .rst files in the source/ directory}

\PYG{c+c1}{\PYGZsh{} Build and test}
make\PYG{+w}{ }html

\PYG{c+c1}{\PYGZsh{} Commit and push}
git\PYG{+w}{ }add\PYG{+w}{ }.
git\PYG{+w}{ }commit\PYG{+w}{ }\PYGZhy{}m\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}Add new storage topic: XYZ\PYGZdq{}}
git\PYG{+w}{ }push\PYG{+w}{ }origin\PYG{+w}{ }feature/new\PYGZhy{}content

\PYG{c+c1}{\PYGZsh{} Create a pull request}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Contribution Guidelines:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Follow the existing documentation style

\item {} 
\sphinxAtStartPar
Include practical examples and code snippets

\item {} 
\sphinxAtStartPar
Test all commands on Ubuntu 22.04

\item {} 
\sphinxAtStartPar
Update the table of contents if adding new sections

\item {} 
\sphinxAtStartPar
Include relevant cross\sphinxhyphen{}references

\end{itemize}


\subsection{Contact Information}
\label{\detokenize{downloads:contact-information}}
\sphinxAtStartPar
For questions, suggestions, or support:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Email:} \sphinxhref{mailto:docs@storage-guide.org}{docs@storage\sphinxhyphen{}guide.org}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{IRC:} \#ubuntu\sphinxhyphen{}storage on Libera.Chat

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Matrix:} \#ubuntu\sphinxhyphen{}storage:matrix.org

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{GitHub:} \sphinxurl{https://github.com/ubuntu-storage-docs}

\end{itemize}

\sphinxAtStartPar
This comprehensive documentation package provides everything needed to understand and manage storage systems on Ubuntu 22.04, available in multiple formats for different use cases and preferences.


\chapter{Quick Start Guide}
\label{\detokenize{index:quick-start-guide}}
\sphinxAtStartPar
This documentation is designed for:
\begin{itemize}
\item {} 
\sphinxAtStartPar
System administrators managing storage on Ubuntu 22.04 LTS

\item {} 
\sphinxAtStartPar
Developers working with storage APIs and file systems

\item {} 
\sphinxAtStartPar
Students learning about storage technologies

\item {} 
\sphinxAtStartPar
IT professionals preparing for storage\sphinxhyphen{}related certifications

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Download Options:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
HTML Documentation (browsable online)

\item {} 
\sphinxAtStartPar
PDF Version (for offline reading)

\item {} 
\sphinxAtStartPar
EPUB Format (for e\sphinxhyphen{}readers)

\end{itemize}


\chapter{Navigation Tips}
\label{\detokenize{index:navigation-tips}}
\sphinxAtStartPar
Use the sidebar to navigate through different sections. Each chapter includes:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Theoretical concepts and explanations

\item {} 
\sphinxAtStartPar
Practical examples with Ubuntu 22.04 commands

\item {} 
\sphinxAtStartPar
Code samples and scripts

\item {} 
\sphinxAtStartPar
Common questions and answers

\item {} 
\sphinxAtStartPar
Troubleshooting guides

\end{itemize}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{genindex}}}

\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{modindex}}}

\item {} 
\sphinxAtStartPar
\DUrole{xref}{\DUrole{std}{\DUrole{std-ref}{search}}}

\end{itemize}



\renewcommand{\indexname}{Index}
\footnotesize\raggedright\printindex
\end{document}